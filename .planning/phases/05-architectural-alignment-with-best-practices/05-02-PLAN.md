---
phase: 05-architectural-alignment
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - app/org/[orgId]/team/[teamId]/page.tsx
  - app/org/[orgId]/team/[teamId]/performance/page.tsx
  - app/org/[orgId]/team/[teamId]/design/page.tsx
  - app/org/[orgId]/team/[teamId]/skillgraph/page.tsx
  - app/org/[orgId]/team/[teamId]/spof/page.tsx
  - components/dashboard/pages/TeamOverviewPageClient.tsx
  - components/dashboard/pages/TeamPerformancePageClient.tsx
  - components/dashboard/pages/TeamDesignPageClient.tsx
  - components/dashboard/pages/TeamSkillGraphPageClient.tsx
  - components/dashboard/pages/TeamSpofPageClient.tsx
autonomous: true

must_haves:
  truths:
    - "Team page files are thin Server Component wrappers that render a single Client Component"
    - "All business logic (useState, useMemo, data processing) lives in Client Components"
    - "No team page uses useParams() directly - all use useRouteParams() from RouteParamsProvider"
    - "All 5 team dashboard tabs render identically to before the refactor"
    - "Tab navigation between team dashboard tabs works correctly"
  artifacts:
    - path: "components/dashboard/pages/TeamOverviewPageClient.tsx"
      provides: "Client component for team overview tab"
      contains: "useRouteParams"
    - path: "components/dashboard/pages/TeamPerformancePageClient.tsx"
      provides: "Client component for team performance tab"
      contains: "useRouteParams"
    - path: "components/dashboard/pages/TeamDesignPageClient.tsx"
      provides: "Client component for team design tab"
      contains: "useRouteParams"
    - path: "components/dashboard/pages/TeamSkillGraphPageClient.tsx"
      provides: "Client component for team skillgraph tab"
      contains: "useRouteParams"
    - path: "components/dashboard/pages/TeamSpofPageClient.tsx"
      provides: "Client component for team SPOF tab"
      contains: "useRouteParams"
    - path: "app/org/[orgId]/team/[teamId]/page.tsx"
      provides: "Server Component wrapper for team overview"
      contains: "TeamOverviewPageClient"
    - path: "app/org/[orgId]/team/[teamId]/performance/page.tsx"
      provides: "Server Component wrapper for team performance"
      contains: "TeamPerformancePageClient"
    - path: "app/org/[orgId]/team/[teamId]/design/page.tsx"
      provides: "Server Component wrapper for team design"
      contains: "TeamDesignPageClient"
    - path: "app/org/[orgId]/team/[teamId]/skillgraph/page.tsx"
      provides: "Server Component wrapper for team skillgraph"
      contains: "TeamSkillGraphPageClient"
    - path: "app/org/[orgId]/team/[teamId]/spof/page.tsx"
      provides: "Server Component wrapper for team SPOF"
      contains: "TeamSpofPageClient"
  key_links:
    - from: "app/org/[orgId]/team/[teamId]/page.tsx"
      to: "components/dashboard/pages/TeamOverviewPageClient.tsx"
      via: "import and render"
      pattern: "TeamOverviewPageClient"
    - from: "components/dashboard/pages/TeamOverviewPageClient.tsx"
      to: "lib/RouteParamsProvider.tsx"
      via: "useRouteParams hook"
      pattern: "useRouteParams"
---

<objective>
Extract all 5 team dashboard pages into the Server Component wrapper + Client Component pattern, replacing direct `useParams()` with `useRouteParams()`.

Purpose: Team pages are the highest-value migration targets - they all use `useParams()` directly and have the most business logic. This eliminates all direct `useParams()` usage in the codebase and establishes the Client Component extraction pattern.

Output: 5 thin Server Component page wrappers and 5 Client Component files in `components/dashboard/pages/`.
</objective>

<execution_context>
@/Users/kartikmistry/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kartikmistry/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-architectural-alignment-with-best-practices/05-RESEARCH.md
@.planning/phases/05-architectural-alignment-with-best-practices/05-01-SUMMARY.md

@app/org/[orgId]/team/[teamId]/page.tsx
@app/org/[orgId]/team/[teamId]/performance/page.tsx
@app/org/[orgId]/team/[teamId]/design/page.tsx
@app/org/[orgId]/team/[teamId]/skillgraph/page.tsx
@app/org/[orgId]/team/[teamId]/spof/page.tsx
@lib/RouteParamsProvider.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract TeamOverview and TeamPerformance Client Components</name>
  <files>
    app/org/[orgId]/team/[teamId]/page.tsx,
    components/dashboard/pages/TeamOverviewPageClient.tsx,
    app/org/[orgId]/team/[teamId]/performance/page.tsx,
    components/dashboard/pages/TeamPerformancePageClient.tsx
  </files>
  <action>
Create the `components/dashboard/pages/` directory.

For each of the two pages, apply the extraction pattern:

**A. Team Overview (`page.tsx` -> `TeamOverviewPageClient.tsx`)**

1. Create `components/dashboard/pages/TeamOverviewPageClient.tsx`:
   - Add `"use client";` directive
   - Copy ALL content from the current `app/org/[orgId]/team/[teamId]/page.tsx`
   - Replace `import { useParams } from "next/navigation";` with `import { useRouteParams } from "@/lib/RouteParamsProvider";`
   - Replace `const params = useParams(); const teamId = params.teamId as string;` with `const { teamId } = useRouteParams();`
   - Change `export default function TeamPage()` to `export function TeamOverviewPageClient()`
   - Update `teamId` usage: since `teamId` is now `string | null`, use `teamId!` in the `getMemberPerformanceRowsForTeam(52, teamId!, 6)` call (it's guaranteed non-null on team routes since RouteParamsProvider wraps them)

2. Replace `app/org/[orgId]/team/[teamId]/page.tsx` with thin Server Component wrapper:
```tsx
import { TeamOverviewPageClient } from '@/components/dashboard/pages/TeamOverviewPageClient';

// Future: Fetch data server-side
// export default async function TeamOverviewPage({ params }: { params: Promise<{ orgId: string; teamId: string }> }) {
//   const { teamId } = await params;
//   const data = await fetchTeamData(teamId);
//   return <TeamOverviewPageClient data={data} />;
// }

export default function TeamOverviewPage() {
  return <TeamOverviewPageClient />;
}
```

**B. Team Performance (`page.tsx` -> `TeamPerformancePageClient.tsx`)**

Same pattern:
1. Create `components/dashboard/pages/TeamPerformancePageClient.tsx`:
   - `"use client";` directive
   - Copy ALL content from current performance `page.tsx`
   - Replace `useParams` import with `useRouteParams` import from `@/lib/RouteParamsProvider`
   - Replace param extraction: `const { teamId } = useRouteParams();`
   - Rename function to `export function TeamPerformancePageClient()`
   - Use `teamId!` where teamId is used as string (in `getMemberPerformanceRowsForTeam` call)

2. Replace `app/org/[orgId]/team/[teamId]/performance/page.tsx`:
```tsx
import { TeamPerformancePageClient } from '@/components/dashboard/pages/TeamPerformancePageClient';

export default function TeamPerformancePage() {
  return <TeamPerformancePageClient />;
}
```

Important: Do NOT change any business logic, styling, or component usage. The only changes are:
- Moving code to new file location
- Swapping `useParams()` for `useRouteParams()`
- Removing `"use client"` from page file (it becomes a Server Component)
  </action>
  <verify>
1. Run `npx tsc --noEmit` - zero TypeScript errors
2. Verify `components/dashboard/pages/` directory exists with both Client Component files
3. Verify neither team page file contains `"use client"` or `useParams`
4. Verify both Client Component files contain `"use client"` and `useRouteParams`
5. Run `npm run build` to confirm build succeeds
  </verify>
  <done>
Team Overview and Performance pages are thin Server Component wrappers. Business logic lives in `TeamOverviewPageClient.tsx` and `TeamPerformancePageClient.tsx`. Both use `useRouteParams()` instead of `useParams()`. Build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Extract TeamDesign, TeamSkillGraph, and TeamSpof Client Components</name>
  <files>
    app/org/[orgId]/team/[teamId]/design/page.tsx,
    components/dashboard/pages/TeamDesignPageClient.tsx,
    app/org/[orgId]/team/[teamId]/skillgraph/page.tsx,
    components/dashboard/pages/TeamSkillGraphPageClient.tsx,
    app/org/[orgId]/team/[teamId]/spof/page.tsx,
    components/dashboard/pages/TeamSpofPageClient.tsx
  </files>
  <action>
Apply the same extraction pattern to the remaining 3 team pages:

**A. Team Design (`page.tsx` -> `TeamDesignPageClient.tsx`)**

1. Create `components/dashboard/pages/TeamDesignPageClient.tsx`:
   - `"use client";` directive
   - Copy ALL content from current design `page.tsx`
   - Replace `import { useParams } from "next/navigation";` with `import { useRouteParams } from "@/lib/RouteParamsProvider";`
   - Replace `const params = useParams(); const teamId = params.teamId as string;` with `const { teamId } = useRouteParams();`
   - Rename: `export function TeamDesignPageClient()`
   - Use `teamId!` where teamId is used as string (in `getMemberDesignData(teamId!, 6)` and `getTeamCollaborationData(teamId!, ...)`)

2. Replace `app/org/[orgId]/team/[teamId]/design/page.tsx`:
```tsx
import { TeamDesignPageClient } from '@/components/dashboard/pages/TeamDesignPageClient';

export default function TeamDesignPage() {
  return <TeamDesignPageClient />;
}
```

**B. Team SkillGraph (`page.tsx` -> `TeamSkillGraphPageClient.tsx`)**

1. Create `components/dashboard/pages/TeamSkillGraphPageClient.tsx`:
   - `"use client";` directive
   - Copy ALL content from current skillgraph `page.tsx` (including the `mapMemberRowsToSkillgraphTeams` helper function)
   - Replace `useParams` with `useRouteParams` from `@/lib/RouteParamsProvider`
   - Replace `const params = useParams(); const teamId = params.teamId as string;` with `const { teamId } = useRouteParams();`
   - Rename: `export function TeamSkillGraphPageClient()`
   - Use `teamId!` where teamId is used as string (in `getMemberSkillsData(teamId!, 6)`)

2. Replace `app/org/[orgId]/team/[teamId]/skillgraph/page.tsx`:
```tsx
import { TeamSkillGraphPageClient } from '@/components/dashboard/pages/TeamSkillGraphPageClient';

export default function TeamSkillGraphPage() {
  return <TeamSkillGraphPageClient />;
}
```

**C. Team SPOF (`page.tsx` -> `TeamSpofPageClient.tsx`)**

1. Create `components/dashboard/pages/TeamSpofPageClient.tsx`:
   - `"use client";` directive
   - Copy ALL content from current spof `page.tsx` (including the `SPOF_MEMBER_COLUMNS` constant)
   - Replace `useParams` with `useRouteParams` from `@/lib/RouteParamsProvider`
   - Replace `const params = useParams(); const teamId = params.teamId as string;` with `const { teamId } = useRouteParams();`
   - Rename: `export function TeamSpofPageClient()`
   - Use `teamId!` where teamId is used as string (in `getMemberSpofData(teamId!, 6)`)

2. Replace `app/org/[orgId]/team/[teamId]/spof/page.tsx`:
```tsx
import { TeamSpofPageClient } from '@/components/dashboard/pages/TeamSpofPageClient';

export default function TeamSpofPage() {
  return <TeamSpofPageClient />;
}
```

Important: For ALL three pages:
- Do NOT change any business logic, JSX, styling, or component usage
- Only changes: file location, function name, `useParams` -> `useRouteParams`, remove `"use client"` from page files
- Include ALL helper functions and constants defined in the original page files (like `mapMemberRowsToSkillgraphTeams` in skillgraph and `SPOF_MEMBER_COLUMNS` in spof)
  </action>
  <verify>
1. Run `npx tsc --noEmit` - zero TypeScript errors
2. Run `npm run build` - build succeeds
3. Verify NO file under `app/org/[orgId]/team/[teamId]/` contains `"use client"` (grep check)
4. Verify NO file under `app/org/[orgId]/team/[teamId]/` contains `useParams` (grep check)
5. Verify all 5 Client Component files exist in `components/dashboard/pages/` and contain `useRouteParams`
6. Verify all 5 Client Component files contain `"use client"` directive
  </verify>
  <done>
All 5 team dashboard pages are thin Server Component wrappers. All business logic lives in the corresponding `*PageClient.tsx` files. Zero direct `useParams()` usage remains in team pages. All pages use `useRouteParams()` from RouteParamsProvider. Build passes with no errors.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. `npm run build` succeeds
3. `grep -r "useParams" app/org/\[orgId\]/team/` returns zero matches
4. `grep -r '"use client"' app/org/\[orgId\]/team/` returns zero matches
5. `ls components/dashboard/pages/Team*` shows 5 files
6. All 5 Client Component files import from `@/lib/RouteParamsProvider`
</verification>

<success_criteria>
- 5 thin Server Component page wrappers exist (no `"use client"`, no business logic)
- 5 Client Component files exist in `components/dashboard/pages/`
- All Client Components use `useRouteParams()` instead of `useParams()`
- Zero direct `useParams()` usage in the codebase (the 5 team pages were the only users)
- App builds and all team tabs render correctly
</success_criteria>

<output>
After completion, create `.planning/phases/05-architectural-alignment-with-best-practices/05-02-SUMMARY.md`
</output>
