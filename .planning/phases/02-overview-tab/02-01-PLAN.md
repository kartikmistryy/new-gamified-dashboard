---
phase: 02-overview-tab
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - lib/teamDashboard/overviewHelpers.ts
  - app/org/[orgId]/team/[teamId]/page.tsx
autonomous: true

must_haves:
  truths:
    - "D3Gauge displays team performance as average of member performanceValues"
    - "Six metric cards show counts matching org dashboard order (Star, Time Bomb, Key Role, Bottleneck, Risky, Legacy)"
    - "ChartInsights panel shows 3-4 insights mentioning specific member names"
    - "MemberTable from Phase 1 remains functional with filter tabs and sorting"
    - "Page layout matches org dashboard exactly (gap-8, gap-5, grid-cols-3/6, space-y-8)"
  artifacts:
    - path: "lib/teamDashboard/overviewHelpers.ts"
      provides: "calculateTeamGaugeValue, getMemberMetricCards, getMemberInsights"
      exports: ["calculateTeamGaugeValue", "getMemberMetricCards", "getMemberInsights"]
    - path: "app/org/[orgId]/team/[teamId]/page.tsx"
      provides: "Complete team overview page with gauge, insights, metric cards, and member table"
      min_lines: 50
  key_links:
    - from: "app/org/[orgId]/team/[teamId]/page.tsx"
      to: "lib/teamDashboard/overviewHelpers.ts"
      via: "import { calculateTeamGaugeValue, getMemberMetricCards, getMemberInsights }"
      pattern: "import.*overviewHelpers"
    - from: "app/org/[orgId]/team/[teamId]/page.tsx"
      to: "components/dashboard/GaugeSection.tsx"
      via: "GaugeSection component with gaugeValue prop"
      pattern: "<GaugeSection.*gaugeValue"
    - from: "app/org/[orgId]/team/[teamId]/page.tsx"
      to: "components/dashboard/ChartInsights.tsx"
      via: "ChartInsights component with insights prop"
      pattern: "<ChartInsights.*insights"
    - from: "app/org/[orgId]/team/[teamId]/page.tsx"
      to: "components/dashboard/OverviewSummaryCard.tsx"
      via: "OverviewSummaryCard mapped over metric cards"
      pattern: "metricCards\\.map.*OverviewSummaryCard"
    - from: "lib/teamDashboard/overviewHelpers.ts"
      to: "lib/teamDashboard/types.ts"
      via: "MemberPerformanceRow type import"
      pattern: "import.*MemberPerformanceRow.*types"
---

<objective>
Complete the team overview page by adding D3Gauge, six metric cards, and ChartInsights panel around the existing MemberTable from Phase 1.

Purpose: This creates the first fully-functional dashboard tab, validating that existing org dashboard components work correctly with member-level data. The gauge value calculated from member averages proves Phase 1's mock data aggregation works.

Output: A team overview page that visually mirrors the org dashboard layout, displaying team performance gauge, personalized insights, metric card counts, and the member table.
</objective>

<execution_context>
@/Users/kartikmistry/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kartikmistry/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-overview-tab/02-RESEARCH.md

@app/org/[orgId]/page.tsx
@app/org/[orgId]/team/[teamId]/page.tsx
@lib/teamDashboard/types.ts
@lib/teamDashboard/overviewMockData.ts
@lib/orgDashboard/overviewMockData.ts
@lib/orgDashboard/types.ts
@components/dashboard/GaugeSection.tsx
@components/dashboard/ChartInsights.tsx
@components/dashboard/OverviewSummaryCard.tsx
@components/dashboard/MemberTable.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create overview helper functions</name>
  <files>lib/teamDashboard/overviewHelpers.ts</files>
  <action>
Create `lib/teamDashboard/overviewHelpers.ts` with three exported functions. This file consolidates all overview-specific logic (per user decision to keep overview helpers together, not split across files).

**1. calculateTeamGaugeValue(members: MemberPerformanceRow[]): number**
- Returns 0 if members array is empty
- Calculates simple average: `sum of all member performanceValues / member count`
- Rounds result with Math.round()
- Per user decision: "Use simple average: sum all member performanceValues / count"

**2. getMemberMetricCards(members: MemberPerformanceRow[]): OverviewSummaryCardConfig[]**
- Copy BASE_CARD_CONFIG array exactly from `lib/orgDashboard/overviewMockData.ts` (lines 91-98) — same keys, titles, priorities, descriptions, colors, badge colors
- Copy CARD_KEY_TO_DIST_KEY mapping: ["star", "timeBomb", "keyRole", "bottleneck", "risky", "legacy"]
- Sum each typeDistribution field across all members (same pattern as org dashboard's getOverviewSummaryCardsForGauge)
- Return array of OverviewSummaryCardConfig with computed counts
- Per user decision: "Cards show count only, no percentages or trends" and "Card order matches org dashboard order exactly"

**3. getMemberInsights(members: MemberPerformanceRow[]): ChartInsight[]**
- Returns empty array if no members
- For each member, find primary category (highest typeDistribution value)
- Count members by primary category and track member names per category
- Generate 3-4 ChartInsight objects with specific member names:
  - "stars" insight: "{N} star performer(s) ({name1} and {name2}) are driving high performance with low SPOF risk."
  - "timebombs" insight: "{N} time bomb(s) detected including {name} — high SPOF risk with low skill level."
  - "risky" insight: "{N} risky member(s) require upskilling to reduce vibe coding patterns."
  - "topperformers" insight: "{N} member(s) achieving 'Extreme Outperforming' status (75+) this period." (for members with performanceValue >= 75)
- Slice to max 4 insights
- Per user decision: "Focus on team composition insights", "Use static mocked insights", "Display 3-4 insight items", "Insights mention specific member names"

Import types:
- `MemberPerformanceRow` from `./types`
- `OverviewSummaryCardConfig`, `ChartInsight` from `@/lib/orgDashboard/types`

Reference the research code examples in `02-RESEARCH.md` Pattern 2 and Pattern 3 for exact implementation. The research provides complete, verified code for all three functions.
  </action>
  <verify>
Run `npx tsc --noEmit` — no type errors in the new file. Verify the file exports all three functions by checking the import resolves.
  </verify>
  <done>
overviewHelpers.ts exists with three exported functions (calculateTeamGaugeValue, getMemberMetricCards, getMemberInsights) that compile without errors and follow the exact patterns from org dashboard.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire overview page with gauge, cards, and insights</name>
  <files>app/org/[orgId]/team/[teamId]/page.tsx</files>
  <action>
Update the existing team page to match the org dashboard layout exactly. The current page has only a heading and MemberTable. Add GaugeSection, ChartInsights, and OverviewSummaryCards.

**Layout structure (copy from `app/org/[orgId]/page.tsx` lines 28-62):**

```
TooltipProvider
  div.flex.flex-col.gap-8.px-6.pb-8.min-h-screen.bg-white.text-gray-900
    Card (border-none bg-white p-0 shadow-none)
      CardContent (flex w-full flex-col items-stretch space-y-8 px-0)
        h2 "Overview"                          ← Changed from "Team Members"
        div.flex.flex-row.gap-5               ← NEW: Gauge + Insights row
          GaugeSection (gaugeValue, labelVariant="performance")
          ChartInsights (insights)
        div.@container.w-full                 ← NEW: Metric cards
          div.grid.grid-cols-3.gap-4.@[1050px]:grid-cols-6
            OverviewSummaryCard (mapped over metricCards)
        section (w-full, aria-labelledby)     ← EXISTING: Member table
          h2 "Team Members" (mb-4 text-2xl font-semibold)
          MemberTable (rows=memberRows)
```

**Data flow (all in useMemo hooks):**
1. `memberRows` = getMemberPerformanceRowsForTeam(52, teamId, 6) — EXISTING, keep as-is
2. `teamGaugeValue` = calculateTeamGaugeValue(memberRows) — NEW
3. `metricCards` = getMemberMetricCards(memberRows) — NEW
4. `insights` = getMemberInsights(memberRows) — NEW

**New imports to add:**
- `TooltipProvider` from `@/components/ui/tooltip`
- `GaugeSection` from `@/components/dashboard/GaugeSection`
- `ChartInsights` from `@/components/dashboard/ChartInsights`
- `OverviewSummaryCard` from `@/components/dashboard/OverviewSummaryCard`
- `calculateTeamGaugeValue`, `getMemberMetricCards`, `getMemberInsights` from `@/lib/teamDashboard/overviewHelpers`

**Critical details per user decisions:**
- Page heading is "Overview" (not "Team Members") — per user decision "Page heading changes from 'Team Members' to 'Overview'"
- Table section heading remains "Team Members"
- Cards are NOT interactive (no onClick handlers) — per user decision "Cards are informational only, do not filter the table on click"
- GaugeSection uses `labelVariant="performance"` — matches org dashboard usage
- CSS classes must be IDENTICAL to org dashboard (gap-8, gap-5, gap-4, space-y-8, grid-cols-3, @[1050px]:grid-cols-6) — per user decision "Match org dashboard layout exactly"
- Wrap in TooltipProvider (D3Gauge uses tooltips internally) — same as org dashboard

The file must remain "use client" (already is). Keep the existing useParams() and memberRows useMemo.
  </action>
  <verify>
Run `npx tsc --noEmit` — no type errors. Run `npm run build` or `npx next build` — page compiles without errors. Open in browser at `/org/test-org/team/frontend-development` and verify: gauge renders with a value, 6 metric cards display in a row, insights panel shows text with member names, member table remains functional with filter tabs.
  </verify>
  <done>
Team overview page renders with D3Gauge showing team average, 6 metric cards in correct order with counts, ChartInsights panel with 3-4 personalized insights, and existing MemberTable with working filter tabs. Layout matches org dashboard visually.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with no errors
2. `npm run build` completes successfully
3. Team overview page at `/org/[orgId]/team/[teamId]` renders all four sections (gauge, insights, cards, table)
4. Gauge value reflects average of member performance values (not hardcoded)
5. Six metric cards display in org dashboard order: Star, Time Bomb, Key Role, Bottleneck, Risky, Legacy
6. ChartInsights panel shows 3-4 insights mentioning member names (e.g., "Alice Chen")
7. MemberTable filter tabs (Most Productive, Least Productive, Most Optimal, Most Risky) still work
8. Layout spacing matches org dashboard (visually compare side-by-side)
</verification>

<success_criteria>
- OVER-01: Member table showing rank, name, avatar, effective performance, developer type — SATISFIED (Phase 1 MemberTable retained)
- OVER-02: D3Gauge displaying team performance aggregated from member data — SATISFIED (calculateTeamGaugeValue computes average, GaugeSection renders it)
- OVER-03: Six metric cards counting members per category — SATISFIED (getMemberMetricCards sums typeDistribution fields)
- OVER-04: ChartInsights panel with member-level trend insights — SATISFIED (getMemberInsights generates personalized insights)
- OVER-05: Filter tabs working on member data — SATISFIED (Phase 1 MemberTable filter tabs retained)
</success_criteria>

<output>
After completion, create `.planning/phases/02-overview-tab/02-01-SUMMARY.md`
</output>
