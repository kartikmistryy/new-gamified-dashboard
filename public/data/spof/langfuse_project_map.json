{
  "Infrastructure": {
    "description": "",
    "functions": {
      "Build & Configuration": {
        "files": [
          {
            "path": "web/src/constants/index.ts",
            "description": "This file serves as an index for constants, specifically re-exporting the application's version number from a separate module.",
            "spof": true
          },
          {
            "path": "web/src/constants/VERSION.ts",
            "description": "This file defines the current version string for the application or a specific component, used for release management and identification.",
            "spof": false
          },
          {
            "path": "web/src/components/EnvLabel.tsx",
            "description": "This component displays an environment label (e.g., STAGING, DEV, PROD-US) for internal Langfuse users in Langfuse Cloud environments. It indicates the current deployment region and can be dismissed by clicking on it.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/after-teardown.ts",
            "description": "This file sets up and tears down a testing environment. It ensures a test database exists before all tests run and performs cleanup after all tests are completed.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/teardown.ts",
            "description": "This file contains a teardown function responsible for cleaning up resources, specifically disconnecting the Redis client, after test execution.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/test-utils.ts",
            "description": "This file provides utility functions for testing, including setting up and tearing down test databases (PostgreSQL and ClickHouse), managing queues, and making authenticated API calls with Zod schema validation.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/fixtures",
            "description": "This directory is intended to store static test data, mock objects, or pre-configured scenarios ('fixtures') used by the web application's unit or integration tests. These fixtures provide consistent and isolated data for testing various components and functionalities.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/static",
            "description": "This directory is intended to store static assets or fixtures specifically used by tests. It provides consistent, non-changing resources to support repeatable test scenarios within the `__tests__` directory.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/trpc/[trpc].ts",
            "description": "This file sets up and exports the main tRPC API handler for Next.js, integrating the application's root router, context creation, and custom error handling with Sentry reporting.",
            "spof": false
          },
          {
            "path": "web/src/utils/shutdown.ts",
            "description": "Implements a graceful shutdown mechanism for a Next.js application, handling SIGTERM/SIGINT signals by disconnecting various services (Redis, Prisma, ClickHouse) and allowing a timeout for pending requests to complete.",
            "spof": false
          },
          {
            "path": "web/src/styles",
            "description": "This directory is intended to house CSS, SASS, or other styling-related files for the web application. It centralizes the styling definitions used across the frontend UI.",
            "spof": false
          },
          {
            "path": "web/src/server/db.ts",
            "description": "This file initializes and exports a Kysely instance for database interaction, specifically configured for PostgreSQL, to be used in the server-side application. It sets up the necessary dialect components for database operations.",
            "spof": true
          },
          {
            "path": "web/src/server/api/root.ts",
            "description": "This file serves as the root T RPC router for the application's API, consolidating various feature-specific routers into a single, comprehensive API endpoint. It acts as the central entry point for all server-side API calls.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/hooks/useLangfuseEnvCode.ts",
            "description": "This file defines a React hook `useLangfuseEnvCode` that generates a string representation of Langfuse environment variables, including the base URL and optionally provided secret/public keys.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/server/cors.ts",
            "description": "This file defines and exports a CORS middleware for Next.js API routes, configured to allow requests from any origin (origin: true) for the public API endpoints.",
            "spof": true
          },
          {
            "path": "web/src/features/media/server/getMediaStorageClient.ts",
            "description": "This file provides a utility function to obtain a singleton S3-compatible storage client for media uploads, configured using environment variables. It ensures a single instance of the storage client is used across the server.",
            "spof": false
          },
          {
            "path": "web/src/features/background-migrations/server",
            "description": "This directory is intended to house server-side logic for managing and executing background migrations within the Langfuse web application. It would contain the backend components responsible for processing data schema updates or other long-running tasks asynchronously.",
            "spof": false
          },
          {
            "path": "web/playwright.config.ts",
            "description": "This file configures Playwright for end-to-end testing, defining settings such as timeouts, base URL, and how to launch the web server for tests.",
            "spof": true
          },
          {
            "path": "web/instrumentation-client.ts",
            "description": "This file initializes and configures the Sentry SDK for client-side error tracking, performance monitoring, session replay, and profiling. It includes specific error filtering, regional privacy settings, and browser extension error exclusion.",
            "spof": false
          },
          {
            "path": "web/tailwind.config.ts",
            "description": "This file is the Tailwind CSS configuration for the project, defining custom themes, colors (including Tremor UI and custom HSL variables), spacing, font sizes, and including various Tailwind plugins. It also specifies file paths for Tailwind to scan and classes to safelist.",
            "spof": false
          },
          {
            "path": "web/public/assets",
            "description": "This directory is designated for hosting static assets that are publicly accessible through the web application. While currently empty, its intended purpose is to serve files like images, fonts, or other media directly to client browsers.",
            "spof": false
          },
          {
            "path": ".claude/skills/backend-dev-guidelines/SKILL.md",
            "description": "This document outlines comprehensive backend development guidelines and best practices for Langfuse's Next.js 14/tRPC/Express/TypeScript monorepo. It details architecture, directory structure, and checklists for creating new features, API endpoints, and queue processors, ensuring consistency across web, worker, and shared packages.",
            "spof": true
          },
          {
            "path": ".claude/skills/backend-dev-guidelines/resources/database-patterns.md",
            "description": "This document is a comprehensive guide to database access patterns in Langfuse, detailing how to interact with PostgreSQL using Prisma ORM and ClickHouse via a direct client.",
            "spof": true
          },
          {
            "path": ".claude/skills/backend-dev-guidelines/resources/architecture-overview.md",
            "description": "This document provides a comprehensive overview of the Langfuse backend architecture, detailing its layered design, request lifecycles for tRPC, Public API, and Worker processes, and the directory structure across its web, worker, and shared packages.",
            "spof": true
          },
          {
            "path": ".claude/skills/backend-dev-guidelines/resources/services-and-repositories.md",
            "description": "This document provides a comprehensive guide to organizing business logic using service and repository patterns. It details their purpose, design principles, and includes practical examples for implementing Dependency Injection and Singleton patterns.",
            "spof": true
          },
          {
            "path": ".claude/skills/backend-dev-guidelines/resources/testing-guide.md",
            "description": "This document serves as a comprehensive guide to backend testing strategies for Langfuse services. It details various test types, including integration, service-level, tRPC, and worker tests, providing code examples and best practices for each.",
            "spof": true
          },
          {
            "path": ".claude/skills/backend-dev-guidelines/resources/configuration.md",
            "description": "This document provides a comprehensive guide to managing environment variables across Langfuse's monorepo packages, detailing the use of Zod for type-safe validation. It outlines package-specific configurations and explains the purpose of special environment variables for cloud and Enterprise Edition features.",
            "spof": true
          },
          {
            "path": "worker/src/database.ts",
            "description": "Establishes and exports a Kysely database client, configured for PostgreSQL, to manage database interactions within the worker service.",
            "spof": true
          },
          {
            "path": "worker/src/index.ts",
            "description": "This file serves as the main entry point for the worker application, initializing instrumentation, configuring the environment, and starting the server to listen for incoming requests.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/network.ts",
            "description": "This file sets up a mock server using MSW (Mock Service Worker) to intercept and handle network requests, primarily for OpenAI API calls, but also for Minio, ClickHouse, and Azurite, for testing purposes. It provides a utility class, `OpenAIServer`, to manage these mock responses.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/storageservice.test.ts",
            "description": "This file contains unit tests for the `StorageService` component, verifying its functionality for file uploads, downloads, listing, deletion, and generating signed URLs, including scenarios with internal and external S3 endpoints.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/redisConsumer.test.ts",
            "description": "This file contains integration tests for the Redis-based job queue system, specifically verifying the behavior of `TraceUpsertQueue` and `WorkerManager`. It tests scenarios such as successful job processing, jobs remaining pending due to a lack of matching workers, and overall Redis event handling for job state changes.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/README.md",
            "description": "This README documents the background migration system, outlining their purpose, execution methods, requirements, and implementation details within the application's worker component.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/backgroundMigrationManager.ts",
            "description": "Manages and executes background database migrations. It acquires locks on migrations, runs them, handles their status (success, failure, validation), and ensures fault tolerance and concurrency control using a database table.",
            "spof": true
          },
          {
            "path": "worker/src/constants/VERSION.ts",
            "description": "This file defines the current version number for the application or project, exported as a constant.",
            "spof": false
          },
          {
            "path": "worker/src/api/index.ts",
            "description": "This file defines the API routes for health and readiness checks of the worker service using Express. It exposes '/health' and '/ready' endpoints to report the container's operational status.",
            "spof": false
          },
          {
            "path": "worker/src/utils/shutdown.ts",
            "description": "This file defines the `onShutdown` function, which orchestrates the graceful termination of the server and its associated services. It ensures proper shutdown of various cleaners, workers, database connections, and tokenization processes to prevent data loss and resource leaks.",
            "spof": false
          },
          {
            "path": "packages/shared/src/db.ts",
            "description": "This file initializes and exports singleton instances of Prisma and Kysely for database connection management and query building, specifically for PostgreSQL. It also re-exports Prisma types and includes logging for database operations, ensuring these backend-specific utilities are not imported into frontend code.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/clickhouse/client.ts",
            "description": "This file implements a singleton manager for ClickHouse clients, reusing connections based on configuration, and provides utility functions for connecting to different ClickHouse services and formatting dates.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/clickhouse/clickhouse-logger.ts",
            "description": "This file integrates ClickHouse client logging with the application's Winston logger, ensuring consistent log formatting and providing a mapping between Winston and ClickHouse log levels.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/clickhouse/queryTracking.ts",
            "description": "This file provides utilities for tracking the status and errors of ClickHouse queries. It includes functions to poll a query's status (running, completed, failed, not found) and retrieve its error message using ClickHouse system tables.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/clickhouse/schema.ts",
            "description": "This file defines and exports the canonical ClickHouse table names used throughout the application, providing a centralized and type-safe reference for data storage schemas.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/batchActionQueue.ts",
            "description": "This file defines a singleton class, `BatchActionQueue`, which provides a configured BullMQ queue instance for processing batch actions. It ensures consistent setup and access to the Redis-backed queue for asynchronous tasks.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/getQueue.ts",
            "description": "This file provides a centralized function (`getQueue`) to retrieve instances of various BullMQ queues based on their names, acting as a factory for different queue types. It facilitates the management and access of application-specific queues for background processing.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/redis.ts",
            "description": "This file initializes and manages Redis client connections, supporting single-node, cluster, and sentinel configurations based on environment variables. It provides utilities for Redis operations, including TLS setup, retry strategies, and cluster-aware key management.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/sharding.ts",
            "description": "Provides a utility function for consistent hashing to determine a shard index for a given key across a specified number of shards, likely for Redis data distribution.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/s3/index.ts",
            "description": "This file provides functions to get singleton S3 client instances for media storage and event storage, configured with environment variables.",
            "spof": true
          },
          {
            "path": "packages/shared/clickhouse/scripts",
            "description": "This directory is intended to house scripts specifically for ClickHouse-related operations within the shared Langfuse package. It would contain automation, setup, or utility scripts for managing ClickHouse components.",
            "spof": false
          },
          {
            "path": "packages/shared/clickhouse/migrations/clustered",
            "description": "This directory is designated to hold database migration scripts specifically for clustered ClickHouse environments. Its purpose is to manage schema changes and updates that are necessary when ClickHouse is deployed in a distributed, clustered configuration. Although currently empty, it serves as the intended location for these specialized migration files.",
            "spof": false
          },
          {
            "path": "packages/shared/clickhouse/migrations/unclustered",
            "description": "This directory is designated for ClickHouse database migration scripts that apply to unclustered ClickHouse instances or tables. It would manage schema changes for shared ClickHouse databases not part of a distributed cluster. Currently, no such migrations are defined here.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230518191501_init",
            "description": "This directory represents a specific database migration, likely the initial schema setup, generated by Prisma. It would typically contain the migration SQL script and metadata for version '20230518191501_init' for the shared package.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230705160335_add_created_updated_timestamps",
            "description": "This directory contains a specific Prisma migration script. Its role is to apply a database schema change that adds 'created' and 'updated' timestamp fields to tables within the shared package.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230620181114_restructure",
            "description": "This directory is dedicated to a specific Prisma database migration named '20230620181114_restructure'. It would typically contain the migration script(s) necessary to apply schema changes for a database restructuring operation within the shared package.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230711112235_fix_indices",
            "description": "This directory contains a specific Prisma migration script from July 11, 2023, focused on fixing database indices. It is part of the shared package's database schema evolution, ensuring optimal performance and integrity.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230518193521_changes",
            "description": "This directory contains a specific Prisma database migration named \"20230518193521_changes\". It defines schema changes applied to the shared database as part of the `langfuse` application's evolution, ensuring version control for the database structure.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230809093636_remove_foreign_keys",
            "description": "This directory contains a specific Prisma migration script, dated 2023-08-09, responsible for removing foreign keys from the database schema. It represents a single, versioned database schema change within the shared Prisma package.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230918180320_add_indices",
            "description": "This directory contains a specific Prisma database migration script. Its role is to define the changes required to add new indices to the database schema, as indicated by its timestamped name.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230522131516_default_timestamp",
            "description": "This directory contains a specific Prisma database migration script, dated 20230522131516. It is responsible for applying schema changes, likely related to setting default timestamps, to the shared database used by the `langfuse` package.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230907225603_projects_updated_at",
            "description": "This directory represents a specific database migration file for the Prisma schema within the shared package. It contains the changes applied to the database on September 7, 2023, likely related to updating project timestamps.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230721111651_drop_usage_json",
            "description": "This directory represents a specific database migration file within the Prisma schema for the Langfuse project. It contains the schema changes applied on 2023-07-21, likely for dropping or modifying 'usage_json' related database elements. Its role is to track and apply a particular database schema evolution.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230710105741_added_indices",
            "description": "This directory represents a specific Prisma migration script within the shared package of the Langfuse project. Its purpose is to record and apply database schema changes, specifically those related to adding indices as indicated by its name. It ensures the database schema evolves consistently across environments.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231009095917_add_ondelete_cascade",
            "description": "This directory contains a specific Prisma migration script, dated 20231009095917, responsible for adding `ON DELETE CASCADE` rules to the database schema. It ensures referential integrity for specific foreign key relationships.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231119171940_bookmarked",
            "description": "This directory contains a specific Prisma database migration script, identified by its timestamp and purpose, `bookmarked`. It is part of the `shared` package's database schema evolution, managing changes to the database structure over time.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240118204936_add_internal_model",
            "description": "This directory represents a specific database migration within the Prisma schema for the `langfuse` shared package. It was created on 2024-01-18 and is responsible for adding an 'internal model' to the database structure. Its purpose is to define and apply the schema changes required for this model.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231104005403_fkey_indicies",
            "description": "This directory contains a specific Prisma database migration. It is responsible for applying changes related to foreign key indices to the database schema. This migration enhances database performance and data integrity for the `langfuse` project.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240118235424_add_index_to_models",
            "description": "This directory contains a specific Prisma database migration script. It is responsible for defining a database schema change, specifically adding an index to certain models, applied at the timestamp indicated in its name.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240119164147_make_model_params_nullable",
            "description": "This directory contains a specific Prisma database migration. Its purpose is to modify the database schema by making certain model parameters nullable, as indicated by its timestamped name.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231223230007_cloud_config",
            "description": "This directory contains a specific Prisma database migration named '20231223230007_cloud_config'. Its role is to define the necessary database schema changes related to cloud configuration for the shared components of the Langfuse project.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240104210051_add_model_indices",
            "description": "This directory contains a specific Prisma database migration script. Its role is to apply schema changes to the database, specifically adding indices to models, as indicated by the timestamp and name. It contributes to the evolution of the shared package's database schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240124164148_correct_models",
            "description": "This directory contains a specific Prisma database migration for the 'shared' package of the Langfuse project. Named '20240124164148_correct_models', it defines schema changes to correct or refine existing database models.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240119164148_add_models",
            "description": "This directory represents a specific Prisma database migration within the shared package of the `langfuse` project. It defines the database schema changes necessary to add new models, timestamped January 19, 2024. This ensures controlled evolution of the database schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240307090110_claude_model_three",
            "description": "This directory contains a specific Prisma database migration identified by its timestamp and purpose, which is to update the database schema, likely for the 'Claude model three' feature. It holds the SQL or schema definition changes for this particular migration.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240126184148_new_models copy",
            "description": "This directory appears to be a copied or temporary placeholder for a specific Prisma database migration. It would typically contain the SQL or Prisma schema changes to introduce 'new models' to the database, identified by its timestamp.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240325211959_remove_example_table",
            "description": "This directory contains a specific Prisma database migration script. Its role is to implement the removal of an 'example_table' from the database schema, as indicated by its name and timestamp. This forms part of the version-controlled database evolution for the shared Langfuse package.",
            "spof": false
          },
          {
            "path": "packages/config-eslint/next.js",
            "description": "This file defines the ESLint configuration for a Next.js project, integrating TypeScript, Prettier, and Turbo configurations with specific overrides and rules.",
            "spof": true
          },
          {
            "path": "packages/config-eslint/index.js",
            "description": "This file serves as the main entry point for the ESLint configuration package, re-exporting the default configuration defined in 'base.js'.",
            "spof": true
          },
          {
            "path": "packages/config-eslint/base.js",
            "description": "This file defines the base ESLint configuration for the monorepo, including common JavaScript, TypeScript, and Prettier rules, integrated with `eslint-config-turbo`.",
            "spof": true
          },
          {
            "path": "packages/config-typescript",
            "description": "This directory is responsible for centralizing and defining common TypeScript configurations for the packages within the Langfuse repository. Its purpose is to ensure consistent TypeScript settings and best practices across the project's codebase, simplifying maintenance and development.",
            "spof": false
          },
          {
            "path": ".cursor/commands/review.md",
            "description": "This file contains a comprehensive checklist for conducting code reviews, covering aspects such as functionality, code quality, and security.",
            "spof": true
          },
          {
            "path": ".cursor/rules",
            "description": "This directory, part of the `.cursor` configuration, is likely designated for storing custom rules. These rules would typically govern aspects like code formatting, linting, or other development environment specific settings for the Cursor IDE.",
            "spof": false
          },
          {
            "path": "fern/apis/client/definition",
            "description": "This directory is intended to house the API definition files for the client-side API, likely consumed by the Fern SDK generator. It defines the contract for client interactions within the Langfuse project.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Max Deichmann",
            "percent": 67
          },
          {
            "name": "Steffen Schmitz",
            "percent": 9
          },
          {
            "name": "Nimar",
            "percent": 8
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 81,
      "spofCount": 26
    },
    "busFactor": 2,
    "authorCount": 8
  },
  "Observability & Analytics": {
    "description": "Provides detailed end-to-end tracing for LLM applications. Users can debug issues, monitor performance, and analyze user interactions through comprehensive trace, session, and event views.",
    "functions": {
      "Event Ingestion & Processing": {
        "files": [
          {
            "path": "web/src/observability.config.ts",
            "description": "This file configures and initializes the OpenTelemetry SDK and DataDog tracing for the application, setting up various instrumentations (e.g., HTTP, Prisma, AWS, Redis) and resource detectors for observability and distributed tracing.",
            "spof": true
          },
          {
            "path": "web/src/__e2e__/api.servertest.ts",
            "description": "This file contains end-to-end (e2e) tests for the Langfuse application's public API endpoints. It covers health checks, data ingestion for traces and spans, rate limiting, and prompt management, verifying API functionality and data persistence in the database and Redis.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/sessions.servertest.ts",
            "description": "This file contains server-side integration tests for session management in the Langfuse application. It specifically tests the creation of sessions through the submission of traces via the public API.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/ingestion-unit.servertest.ts",
            "description": "This file is a unit test for the `/api/public/ingestion` endpoint, specifically verifying that it returns a 500 status code when a Prisma database error occurs during API key verification.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/async/otel-api.servertest.ts",
            "description": "This file contains asynchronous server tests for the `/api/public/otel/v1/traces` endpoint, verifying that OpenTelemetry trace payloads are correctly processed and stored in the Langfuse system, including handling usage details.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/mcp-helpers.ts",
            "description": "Provides shared utility functions and test helpers for testing MCP (Multi-Channel Protocol) server tools within the Langfuse project, including setup, mocking, response validation, and database interactions for tests.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/mcp-error-formatting.servertest.ts",
            "description": "This test file validates the error formatting logic for the Model Context Protocol (MCP) feature. It ensures that various types of errors are correctly transformed into user-friendly `McpError` objects with appropriate error codes and messages, often sanitizing internal details.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/ingestion-api.servertest.ts",
            "description": "This file contains integration tests for the /api/public/ingestion API endpoint, verifying that various types of Langfuse entities (traces, generations, spans, agents, tools, chains, retrievers, evaluators, embeddings, and guardrails) can be successfully ingested and retrieved.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/server/api/otel/otelMapping.servertest.ts",
            "description": "This file contains unit tests for the OpenTelemetry (OTel) resource span mapping, specifically verifying the conversion of Langfuse OTel SDK spans into Langfuse ingestion events.",
            "spof": false
          },
          {
            "path": "web/src/instrumentation.ts",
            "description": "This file registers initialization scripts for observability and other functionalities within a Next.js application, specifically when running in a Node.js environment and if initialization is enabled.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/events.ts",
            "description": "This file defines an authenticated public API endpoint for creating a new observation event. It processes the event within a project context and returns its ID upon successful creation.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/ingestion.ts",
            "description": "This Next.js API route handles the public ingestion of event data, performing authentication, rate-limiting, request validation, and processing event batches from external sources.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/spans.ts",
            "description": "This file defines a public API route for creating and updating spans within the Langfuse system. It processes incoming POST and PATCH requests as observation events, handling span creation and updates respectively.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/ready.ts",
            "description": "This file defines a public API endpoint for checking the application's readiness, performing CORS handling, initiating telemetry, and responding with the application status and version, including graceful shutdown signals.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/media/index.ts",
            "description": "This file defines a public API endpoint for authenticated projects to obtain pre-signed URLs for uploading media files to object storage (e.g., S3). It manages media metadata in the database and associates uploaded media with traces or observations.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/otel/otlp-proto/README.md",
            "description": "This README describes the 'otlp-proto' directory, which contains compiled and modified OpenTelemetry protobuf files. These files are derived from the OpenTelemetry specification (v1.5.0) and adapted for Next.js compatibility.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/otel/v1/metrics/index.ts",
            "description": "This file defines an authenticated public API endpoint for ingesting OpenTelemetry (OTel) metrics. It handles POST requests to receive and process OTel metric data.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/otel/v1/traces/index.ts",
            "description": "This file defines a public API endpoint for ingesting OpenTelemetry trace data, handling various content types (JSON, Protobuf) and compression (gzip), and then queuing it for asynchronous processing within the Langfuse platform.",
            "spof": true
          },
          {
            "path": "web/src/utils/chatml/types.ts",
            "description": "This file re-exports several core types (`NormalizerContext`, `ProviderAdapter`, `ToolEvent`) from the `@langfuse/shared` package. It serves to make these types accessible within the chatml utility or other parts of the web application.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/types/events.ts",
            "description": "This file defines the Zod schemas for the request body and response of the `POST /events` endpoint within the public API. It specifies the data structure for creating events and the expected response containing an event ID.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/types/spans.ts",
            "description": "This file defines the Zod schemas for the request bodies and response types for creating and updating 'span' data via the public API. It re-exports legacy schemas from a shared library for these operations.",
            "spof": false
          },
          {
            "path": "web/src/features/mcp/server/transport.ts",
            "description": "This file implements the streamable HTTP transport for the Model Context Protocol (MCP) in a Next.js API route, handling MCP communication and request routing.",
            "spof": false
          },
          {
            "path": ".claude/skills/skill-developer/TROUBLESHOOTING.md",
            "description": "This document serves as a comprehensive troubleshooting guide for skill activation issues within the Claude development environment. It details common problems like skills not triggering, false positives, hook execution failures, and performance bottlenecks, offering specific checks and fixes for each.",
            "spof": true
          },
          {
            "path": "worker/src/middlewares.ts",
            "description": "This file defines Express.js middleware functions for handling errors. It includes a 'notFound' middleware for 404 routes and a general 'errorHandler' for processing and responding to application errors.",
            "spof": false
          },
          {
            "path": "worker/src/app.ts",
            "description": "This file serves as the main entry point for the Langfuse worker application, setting up an Express server for a worker API and registering numerous queue processors to handle various background tasks such as data ingestion, evaluation job execution, data export, and data deletion.",
            "spof": false
          },
          {
            "path": "worker/src/instrumentation.ts",
            "description": "This file initializes and configures OpenTelemetry for a Node.js application, setting up tracing for various libraries and services (e.g., HTTP, Express, Prisma, Redis, AWS SDK, BullMQ) and integrating with Datadog.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/extractToolsBackend.test.ts",
            "description": "This file contains unit tests for the `extractToolsFromObservation` function, verifying its ability to extract tool definitions and tool calls from various AI model input/output formats (e.g., OpenAI, Anthropic, LangChain, Vercel AI SDK) and handle edge cases.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/observation-retry.test.ts",
            "description": "This test file verifies the retry logic for 'ObservationNotFoundError' in the Langfuse worker, including exponential backoff calculations and the queuing mechanism for retrying failed observation upserts.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/applyFieldMapping.test.ts",
            "description": "This file contains unit tests for utilities that handle JSON path evaluation and apply field mapping configurations to extract and transform data from observations.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/processEventBatch.test.ts",
            "description": "This file contains unit tests for the `processEventBatch` function, specifically verifying its behavior when processing an empty batch of events.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/chatml/integration.test.ts",
            "description": "This file contains integration tests for the ChatML utility functions within the `@langfuse/shared` library. It verifies the correct normalization and combination of various LLM message formats, such as OpenAI, Google Gemini, and legacy structures, into a consistent internal representation.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/chatml/adapters/aisdk.test.ts",
            "description": "This file contains unit tests for the AI SDK adapter, verifying its ability to detect AI SDK input formats and normalize various message structures, including tool calls and results, across different AI SDK providers.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/chatml/adapters/langgraph.test.ts",
            "description": "This file contains unit tests for the LangGraph adapter, verifying its ability to detect LangGraph traces and correctly normalize their message structures, including handling tool definitions, tool calls, and message type conversions.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/chatml/adapters/gemini.test.ts",
            "description": "Tests the `geminiAdapter` for detecting and normalizing Gemini-specific chat message formats into a standardized ChatML structure, including tool calls and responses from Google ADK.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/chatml/adapters/semantic-kernel.test.ts",
            "description": "This file contains unit tests for the `semanticKernelAdapter`, verifying its ability to detect and normalize data originating from Microsoft's Semantic Kernel framework into a standardized chat message format. It specifically checks the parsing of `gen_ai.event.content` fields used by Semantic Kernel for OpenTelemetry tracing.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/chatml/adapters/openai.test.ts",
            "description": "This file contains unit tests for the OpenAI adapter, verifying its ability to detect OpenAI API formats and correctly normalize OpenAI-specific input and output data structures, including tool calls and multimodal content.",
            "spof": false
          },
          {
            "path": "worker/src/queues/eventPropagationQueue.ts",
            "description": "This file defines a BullMQ processor responsible for handling event propagation jobs. It processes events and performs experiment backfilling within the `EventPropagationJob` context.",
            "spof": true
          },
          {
            "path": "worker/src/queues/otelIngestionQueue.ts",
            "description": "This file defines a BullMQ processor for the 'OtelIngestionQueue'. It processes incoming OpenTelemetry (OTEL) data, converting it into Langfuse ingestion events (traces and observations), and routes them for storage and further evaluation based on SDK versions and project configurations.",
            "spof": false
          },
          {
            "path": "worker/src/queues/ingestionQueue.ts",
            "description": "This file defines the processor for the ingestion queue, responsible for handling incoming event data by downloading it from S3, logging metadata to ClickHouse, managing a Redis cache, and orchestrating its ingestion into the system.",
            "spof": false
          },
          {
            "path": "worker/src/scripts/replayIngestionEvents/README.md",
            "description": "This document describes the process for replaying failed ingestion events from S3, including how to retrieve event data, configure necessary connections, and execute the replay script.",
            "spof": true
          },
          {
            "path": "worker/src/scripts/replayIngestionEvents/s3-ingestion-event-replay.ts",
            "description": "This script processes a CSV file of S3 ingestion events, filters them for 'REST.PUT.OBJECT' operations, and converts the data into separate JSONL files for regular and OTEL-style events, preparing them for re-ingestion via a BullMQ queue.",
            "spof": false
          },
          {
            "path": "worker/src/utils/clickhouseReadSkipCache.ts",
            "description": "This utility class manages a cache to determine whether ClickHouse reads should be skipped for specific projects, based on project creation dates or explicit project ID configurations. It efficiently checks project eligibility for skipping ClickHouse ingestion by pre-populating and consulting an in-memory map.",
            "spof": true
          },
          {
            "path": "worker/src/features/tokenisation/types.ts",
            "description": "This file defines types and utility functions for validating and categorizing AI model names, specifically for models supported by Tiktoken tokenization and those considered chat models.",
            "spof": true
          },
          {
            "path": "worker/src/features/tokenisation/usage.ts",
            "description": "This file provides functions to calculate token counts for different AI models (OpenAI, Anthropic Claude) using their respective tokenization methods, supporting both plain text and chat message formats.",
            "spof": false
          },
          {
            "path": "worker/src/services/IngestionService/index.ts",
            "description": "This file defines the IngestionService, which is responsible for processing, enriching, and writing various event types (traces, observations, scores, and dataset run items) into the Langfuse system, handling data transformation and persistence.",
            "spof": true
          },
          {
            "path": "worker/src/services/IngestionService/utils.ts",
            "description": "This file provides utility functions for converting various JSON and record types into string-based records, primarily for metadata handling, and includes a specialized object merging function with custom overwrite logic.",
            "spof": false
          },
          {
            "path": "worker/src/services/IngestionService/tests/IngestionService.unit.test.ts",
            "description": "This file contains unit tests for the IngestionService, verifying its functionality including event sorting by timestamp and date conversion for ClickHouse.",
            "spof": false
          },
          {
            "path": "worker/src/services/IngestionService/tests/calculateTokenCost.unit.test.ts",
            "description": "This file contains unit tests for the `calculateUsageCosts` method within the `IngestionService`. It verifies the correct calculation of token costs under various conditions, including provided model prices, user-specified costs, and different token usage scenarios.",
            "spof": true
          },
          {
            "path": "worker/src/services/IngestionService/tests/IngestionService.integration.test.ts",
            "description": "Integration tests for the IngestionService, verifying its end-to-end functionality, including processing trace and event data and writing it to Clickhouse.",
            "spof": false
          },
          {
            "path": "packages/shared/src/domain/index.ts",
            "description": "This file serves as a central export point for various domain-specific modules, aggregating and re-exporting entities such as observations, traces, scores, and automations from their respective subdirectories.",
            "spof": false
          },
          {
            "path": "packages/shared/src/domain/traces.ts",
            "description": "This file defines Zod schemas for `Metadata` and `Trace` objects, which are used for data validation and typing of trace-related entities across the application's frontend and backend.",
            "spof": true
          },
          {
            "path": "packages/shared/src/domain/observations.ts",
            "description": "This file defines Zod schemas and TypeScript types for various observation entities, their types, and levels within an observability system. It includes detailed schemas for tracking different types of events, generations, and tools with associated metadata, costs, and usage.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/headerPropagation.ts",
            "description": "This file defines a utility function to propagate Langfuse-specific context properties (user ID, project ID, and certain HTTP headers) using OpenTelemetry baggage, facilitating distributed tracing and contextual logging.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/logger.ts",
            "description": "This file configures and exports a Winston logger for the application. It integrates OpenTelemetry tracing details (trace and span IDs) and baggage information into log messages, supporting both text and JSON output formats.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/queues.ts",
            "description": "This file defines Zod schemas for various event payloads and job structures that are processed through different queues within the system. It also enumerates the available queue names, facilitating inter-service communication and background processing.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/clickhouse/measureAndReturn.ts",
            "description": "This file provides a utility function `measureAndReturn` to measure the execution time of an asynchronous operation, integrating with OpenTelemetry for tracing. It is designed to be extensible for future A/B testing or canary release experiments.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/analytics-integrations/types.ts",
            "description": "Defines standard TypeScript types for various analytics events (trace, generation, score) used across different analytics integrations like PostHog and Mixpanel. These types represent the raw data structures derived from ClickHouse queries.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/otel/index.ts",
            "description": "This file serves as an entry point for OpenTelemetry (Otel) related server-side modules, specifically re-exporting the OtelIngestionProcessor.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/otel/attributes.ts",
            "description": "This file defines an enum `LangfuseOtelSpanAttributes` containing standardized OpenTelemetry span attribute names used within the Langfuse ecosystem. It categorizes attributes for traces, observations, generations, and experiments to ensure consistent telemetry data.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/otel/OtelIngestionProcessor.ts",
            "description": "This file defines a processor class responsible for converting OpenTelemetry (OTEL) resource spans into Langfuse ingestion events. It extracts relevant data from OTEL spans, prepares them, and publishes them to an ingestion queue for further processing.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/otel/ObservationTypeMapper.ts",
            "description": "This file defines a registry and mappers for converting OpenTelemetry span attributes into Langfuse observation types. It uses a prioritized system of simple and custom attribute mappers to identify the correct observation type based on various attribute sets.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/instrumentation/README.md",
            "description": "This README details Langfuse's approach to observability using OpenTelemetry (Otel), explaining how to instrument functions, record metrics, and configure instrumentation within their applications. It serves as a guide for integrating Otel for distributed tracing and metrics collection.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/instrumentation/index.ts",
            "description": "This file provides comprehensive instrumentation utilities, integrating OpenTelemetry for distributed tracing and Datadog/AWS CloudWatch for metrics collection. It includes functions for span management, exception tracking, user context propagation, and various metric recording.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/llm/errors.ts",
            "description": "This file defines a custom `LLMCompletionError` class for handling errors specifically related to LLM completions, including properties for response status code and retryability. It also provides a type guard function to check for instances of this error.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/llm/utils.ts",
            "description": "This file provides utility functions for decrypting and parsing extra headers, specifically handling encrypted JSON strings into a validated record of string key-value pairs. It leverages Zod for schema validation and a custom decryption utility.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/llm/fetchLLMCompletion.ts",
            "description": "This file provides a unified function (`fetchLLMCompletion`) for interacting with various Large Language Models (LLMs) from different providers (e.g., OpenAI, Anthropic, Google, AWS Bedrock). It handles model configuration, message formatting, streaming, structured output, and integrates with Langfuse's internal tracing system.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/llm/getInternalTracingHandler.ts",
            "description": "This file provides a utility function to create and manage a Langfuse tracing handler for internal use. It captures, filters, and processes LLM-related events (potentially from LangChain) before ingesting them into the Langfuse platform.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/ingestionQueue.ts",
            "description": "This file defines classes for managing BullMQ queues used for data ingestion, including a sharded primary ingestion queue and a secondary ingestion queue, ensuring singleton access and proper Redis connections.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/otelIngestionQueue.ts",
            "description": "This file defines the `OtelIngestionQueue` class, which manages sharded BullMQ queues for OpenTelemetry (OTel) ingestion, handling the creation and retrieval of queue instances for different shards.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/otelProjectTracking.ts",
            "description": "This file provides utility functions to track and identify projects that are using OpenTelemetry (OTEL) API ingestion, storing this state in Redis with a time-to-live. This tracking is primarily used to conditionally bypass final processing steps for such projects.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/traceUpsert.ts",
            "description": "This file defines a sharded BullMQ queue (`TraceUpsertQueue`) for processing trace upsert operations. It provides methods to retrieve queue instances based on sharding keys or names, managing their lifecycle and configuration with Redis connections and job options.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/ingestion/modelMatch.ts",
            "description": "This file is responsible for finding and matching models with their associated pricing information, utilizing a Redis cache for performance and falling back to PostgreSQL for the primary data source. It includes logic for caching, retrieving, and invalidating model data.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/ingestion/extractToolsBackend.ts",
            "description": "This file provides utilities to extract and normalize tool definitions and tool calls from various LLM prompt and response formats (e.g., OpenAI, Anthropic, LangChain) for storage in ClickHouse.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/ingestion/processEventBatch.ts",
            "description": "This file contains the core logic for processing batches of ingestion events. It validates incoming events, uploads them to S3 for storage, and then enqueues them for asynchronous processing in ClickHouse, handling various error conditions and configurations related to event sourcing and storage.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/ingestion/sampling.ts",
            "description": "This file implements a deterministic trace sampling mechanism. It determines whether a given trace event should be sampled based on its trace ID, project configuration, and a crypto-based hashing algorithm.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/ingestion/types.ts",
            "description": "This file defines Zod schemas and types for data ingestion, including usage metrics, trace observations (spans, generations), scores, and environment details. It standardizes the structure of incoming data for the Langfuse platform.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/repositories/definitions.ts",
            "description": "This file defines Zod schemas for various data records like observations, traces, scores, and dataset run items. These schemas are used for data validation and structuring when reading from or inserting into a database, often distinguishing between timestamp formats for different operations.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/IORepresentation/parseIO.ts",
            "description": "This utility function parses or transforms an input object based on a specified verbosity level, specifically converting it to a compact representation if requested.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/chatml/types.ts",
            "description": "This file defines core types and interfaces for data normalization and tool event representation. It includes `NormalizerContext`, `ToolEvent` (call/result), and `ProviderAdapter` for consistent handling within a chatml utility.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/chatml/helpers.ts",
            "description": "This file provides utility functions for processing and transforming data structures, especially those related to chat messages, tool calls, and metadata. It includes helpers for cleaning objects, handling JSON stringification, and navigating nested properties.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/chatml/adapters/gemini.ts",
            "description": "This file provides an adapter to normalize various Gemini/VertexAI message formats (raw API, ADK input/output, simple requests) into a standardized ChatML-compatible structure. It handles extraction of tool calls, thinking parts, and text content from Gemini's diverse message payloads.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/chatml/adapters/semantic-kernel.ts",
            "description": "This file implements a provider adapter for Microsoft Semantic Kernel, normalizing its specific message formats (which often embed content as JSON strings in `gen_ai.event.content`) into a standardized structure.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/chatml/adapters/langgraph.ts",
            "description": "This file implements a `ProviderAdapter` for LangGraph messages, providing logic to detect, normalize, and preprocess message formats and tool calls originating from LangGraph (and LangChain) into a standardized internal representation, while rejecting messages from other frameworks like AI SDK or OpenAI Agents.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/chatml/adapters/openai.ts",
            "description": "This file provides an adapter for OpenAI's Chat Completions and Responses APIs, including Zod schemas for format detection and functions to normalize OpenAI-specific message and tool structures into a standardized format.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/chatml/adapters/index.ts",
            "description": "This file manages and exports various adapters responsible for detecting and normalizing chat message formats from different AI frameworks (e.g., OpenAI, Gemini, Vercel AI SDK) into a common ChatML structure. It provides a `selectAdapter` function to choose the appropriate adapter based on a given context.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/utils/framework-traces/merge-observations.ts",
            "description": "This script merges detailed observation data (input, output, metadata) from one JSON file into a base trace JSON file, assigns a fixed project ID, and writes the consolidated data to a new output file. It is used as a utility for seeding framework trace data.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/utils/framework-traces/framework-trace-loader.ts",
            "description": "This file defines a utility class, `FrameworkTraceLoader`, which loads framework-specific trace data from local JSON files, adapts them to a specific project by generating new IDs and formatting, and prepares them for insertion into a data store as trace and observation records.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Steffen Schmitz",
            "percent": 32
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 23
          },
          {
            "name": "Nimar",
            "percent": 23
          }
        ]
      },
      "Project Analytics & Dashboards": {
        "files": [
          {
            "path": "web/src/components/level-counts-display.tsx",
            "description": "This file defines a React component, `LevelCountsDisplay`, which renders a list of categorized counts (e.g., error levels, severities). It displays each count with an associated symbol and level, separated by vertical lines, and includes a loading state.",
            "spof": true
          },
          {
            "path": "web/src/components/error-page.tsx",
            "description": "This file defines React components for displaying error pages, including a generic error page and a variant that integrates with Sentry for error reporting.",
            "spof": false
          },
          {
            "path": "web/src/components/token-usage-badge.tsx",
            "description": "This file defines React components (`AggUsageBadge` and `TokenUsageBadge`) for displaying token usage statistics (input, output, and total tokens) in a badge or inline format. It can aggregate usage from multiple observations or display usage for a single observation/set of numbers.",
            "spof": false
          },
          {
            "path": "web/src/components/onboarding/UsersOnboarding.tsx",
            "description": "This file defines a React component for the user onboarding splash screen, guiding users on how to set up and leverage user tracking features in the application. It highlights the benefits of tracking user interactions, analyzing behavior, and monitoring usage metrics.",
            "spof": true
          },
          {
            "path": "web/src/components/nav/sidebar-notifications.tsx",
            "description": "This file defines and renders a component for displaying dismissible and time-sensitive notifications in a sidebar. It uses local storage to track dismissed notifications and integrates analytics for user interactions.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/model-definitions.servertest.ts",
            "description": "This file contains integration tests for the `/api/public/models` API endpoints. It verifies the functionality for retrieving, creating, and deleting model definitions, including pricing and validation logic.",
            "spof": false
          },
          {
            "path": "web/src/pages/_app.tsx",
            "description": "This file serves as the main entry point for the Next.js application, wrapping all pages with essential providers for authentication, UI components, analytics, error tracking, global styling, and custom polyfills, ensuring application-wide functionality and context.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/traces/setup.tsx",
            "description": "This file defines the Tracing Setup page, guiding users through the process of integrating Langfuse tracing into their project. It allows users to generate API keys and provides instructions for instrumenting their application.",
            "spof": false
          },
          {
            "path": "web/src/features/models/validation.ts",
            "description": "This file defines Zod schemas and types for validating data structures related to models, their pricing tiers, and associated configurations within the Langfuse web application, including schemas for form inputs and API responses.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/UpsertModelFormDialog.tsx",
            "description": "This file defines a dialog component for creating, editing, or cloning model configurations, including their names, matching patterns, tokenizer settings, and complex pricing tiers within the application.",
            "spof": true
          },
          {
            "path": "web/src/features/notifications/Notification.tsx",
            "description": "This file defines the React component for a single notification, displaying its message and description, and providing a dismiss button that logs an analytics event.",
            "spof": false
          },
          {
            "path": "web/src/features/widgets/chart-library/DownloadButton.tsx",
            "description": "This file defines a React component named `DownloadButton` that enables users to download provided data, typically chart data, as a CSV file. It handles the conversion of data to CSV format, initiates the file download, and provides visual feedback using icons.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/components/LatencyTables.tsx",
            "description": "This file defines the `LatencyTables` React component, which fetches and displays percentile latency data for traces, generations, and spans in a dashboard using multiple `DashboardCard` and `DashboardTable` components.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/components/TracesTimeSeriesChart.tsx",
            "description": "This file defines a React component that displays time-series charts for traces and observations within a dashboard. It fetches and visualizes data based on project ID, time range, and aggregation, allowing users to toggle between trace counts and observation counts by level.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/TracesBarListChart.tsx",
            "description": "This file defines a React component that displays a bar list chart of trace counts for a dashboard, fetching data from an API and showing total traces and traces grouped by name.",
            "spof": true
          },
          {
            "path": "web/src/features/feedback/component/FeedbackButton.tsx",
            "description": "This file defines a React component (`FeedbackButtonWrapper`) that, when activated, displays a dialog box with options for users to submit feature requests or report bugs for the Langfuse application.",
            "spof": true
          },
          {
            "path": "web/src/features/setup/components/SetupTracingButton.tsx",
            "description": "This file defines a React component, `SetupTracingButton`, which conditionally renders a button to configure tracing for a project. It checks if tracing is already configured and if the user has appropriate permissions before displaying the button or a disabled version.",
            "spof": false
          },
          {
            "path": "packages/shared/src/constants.ts",
            "description": "This file defines the `ModelUsageUnit` enum, which enumerates various units for tracking and measuring AI model usage, such as characters, tokens, and seconds. It serves as a shared constant definition for usage units across different packages.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Hassieb Pakzad",
            "percent": 30
          },
          {
            "name": "Marc Klingen",
            "percent": 27
          },
          {
            "name": "Lotte Verheyden",
            "percent": 15
          }
        ]
      },
      "Trace Detail Visualization": {
        "files": [
          {
            "path": "web/src/components/level-colors.tsx",
            "description": "Defines UI-related constants for different observation levels, including color schemes and emoji symbols. It also provides a utility function for formatting these levels into a standardized label.",
            "spof": false
          },
          {
            "path": "web/src/components/ItemBadge.tsx",
            "description": "This file defines the `ItemBadge` React component, which displays a categorized icon and optional label for various Langfuse item types. It uses `lucide-react` icons and `class-variance-authority` for dynamic styling based on the item's type.",
            "spof": false
          },
          {
            "path": "web/src/components/session/TraceEventsRow.tsx",
            "description": "This file defines React components for displaying a single trace's events and details within a session view. It includes observations, scores, and actions, with lazy loading implemented for performance optimization.",
            "spof": true
          },
          {
            "path": "web/src/components/session/TraceRow.tsx",
            "description": "This file defines React components for displaying a single trace within a session, optimized for performance in virtualized lists. It includes a `TraceRow` for detailed trace display and a `LazyTraceRow` wrapper for lazy loading content when visible.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/LangfuseMediaView.tsx",
            "description": "This file defines a React component, `LangfuseMediaView`, which displays various types of media (images, audio, video, and other files) fetched from the Langfuse API. It includes helper components for rendering different media formats.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/SimpleSectionHeader.tsx",
            "description": "This React component provides a simple, collapsible header for sections within an advanced JSON viewer. It displays a title, an expand/collapse icon, and the number of rows, managing its state via a section context.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/SearchBar.tsx",
            "description": "This file defines the `SearchBar` React component, which provides a UI for text search within a JSON viewer, including an input field, match count, and navigation buttons for previous/next matches.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/hooks/useMultiSectionTreeState.ts",
            "description": "This file defines a React hook (`useMultiSectionTreeState`) that manages the state and logic for a multi-section, expandable tree structure, particularly for an advanced JSON viewer. It handles tree building, node/section expansion, search-based auto-expansion, and synchronization with external expansion states.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/multiSectionTree.ts",
            "description": "This file provides utilities for building a unified tree structure from multiple JSON data sections, incorporating UI elements like headers, footers, and expansion state management for efficient rendering.",
            "spof": false
          },
          {
            "path": "web/src/components/table/peek/peek-observation-detail.tsx",
            "description": "This file defines a React component, `PeekViewObservationDetail`, that fetches and displays detailed trace information within a 'peek' view context. It retrieves trace and observation details based on URL query parameters and renders them using the `Trace` component.",
            "spof": true
          },
          {
            "path": "web/src/components/table/peek/peek-trace-detail.tsx",
            "description": "This file defines a React component, `PeekViewTraceDetail`, that displays the detailed view of a specific trace. It fetches trace data based on URL query parameters (peekId, timestamp) and renders it using a `Trace` component, handling loading states and tab selection.",
            "spof": true
          },
          {
            "path": "web/src/components/table/peek/hooks/usePeekCompareDetail.ts",
            "description": "This React hook manages UI state for collapsible elements and handles navigation related to trace and observation details within a comparison or 'peek' view. It provides functions to toggle collapsed nodes, open specific observations in new tabs, and dynamically update the trace ID in the URL for comparison.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/Trace.tsx",
            "description": "This file defines the main `Trace` component, which serves as the entry point for displaying a single trace. It orchestrates data provision, context setup, and responsive layout rendering for both desktop and mobile views of a trace, including its observations, scores, and an optional graph visualization.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/TracePage.tsx",
            "description": "This file defines the `TracePage` component, responsible for fetching, displaying, and managing a single trace's details within the Langfuse application, including actions like bookmarking, publishing, and deletion. It supports both legacy and beta data fetching mechanisms.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/TracePreview.tsx",
            "description": "This component renders a detailed preview of a Langfuse trace, displaying its properties, associated observations, scores, annotations, comments, and interactive viewing options for input/output and logs.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/ObservationPreview.tsx",
            "description": "This React component displays a detailed preview of a specific observation within a trace, showing its input, output, metadata, associated scores, comments, and various interactive options like annotation, dataset creation, and testing in a playground.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/SpanContent.tsx",
            "description": "This component is a pure renderer for the content of a single span or observation within a trace, displaying its name, metrics (duration, cost, tokens), badges, and scores based on user view preferences. It focuses solely on rendering the content, independent of its hierarchical or structural context.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceSettingsDropdown.tsx",
            "description": "This file defines the `TraceSettingsDropdown` React component, which provides a dropdown menu for users to adjust their view preferences for trace visualization, such as toggling visibility of comments, scores, duration, and cost/tokens, and setting a minimum observation level. These preferences are managed via `ViewPreferencesContext` and persisted to local storage.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceTree.tsx",
            "description": "This file defines the `TraceTree` component, which renders a virtualized, interactive tree view of trace spans, integrating virtualization, tree structure rendering, and span-specific content display.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/ToolCallInvocationsView.tsx",
            "description": "This component (`ToolCallInvocationsView`) renders a list of tool calls extracted from a ChatML message, displaying each tool's name, ID, and its arguments in a formatted JSON view. It is used to visualize tool invocations within a chat or trace context.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/IOPreview.tsx",
            "description": "This component acts as a router for rendering observation input/output, managing view state and routing to different sub-components (IOPreviewJSON, IOPreviewJSONSimple, IOPreviewPretty) based on the selected view mode.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/IOPreviewPretty.tsx",
            "description": "This component renders the input, output, and metadata of an observation in a user-friendly 'pretty' view. It handles special formats like ChatML messages and tool definitions, and includes features like content size limits and output corrections.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/IOPreviewJSONSimple.tsx",
            "description": "This file defines the `IOPreviewJSONSimple` React component, which renders the input, output, and metadata of a trace or observation in a simplified, legacy JSON view, supporting basic expansion states and output correction.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/IOPreviewJSON.tsx",
            "description": "This component renders a specialized, performant JSON viewer for displaying the input, output, and metadata of a trace. It is optimized to skip non-JSON specific parsing (like ChatML or markdown) and includes features such as search, virtualization, string wrapping, and inline comments, along with output correction capabilities.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/ChatMessageList.tsx",
            "description": "This file defines the `ChatMessageList` React component, which renders a list of ChatML messages, supporting features like message filtering, collapsing long chat histories, and displaying additional input or media sections.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/SectionMedia.tsx",
            "description": "This React component, `SectionMedia`, is responsible for rendering a list of media attachments at the bottom of a message list or similar UI section. It uses `LangfuseMediaView` to display each media item.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/ChatMessage.tsx",
            "description": "This React component renders a single ChatML message, adapting its display based on the message's content type (e.g., text, JSON, tool calls, thinking blocks) and selected view mode.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/chat-message-utils.clienttest.ts",
            "description": "This file contains unit tests for utility functions that process and analyze chat message objects, ensuring their correct behavior in various scenarios.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/CorrectedOutputDiffDialog.tsx",
            "description": "This React component displays a dialog showing the difference between an original output and a corrected output, using a diff viewer. It formats outputs for comparison and handles cases where no original output is available.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/SectionToolDefinitions.tsx",
            "description": "This file defines a React component, `SectionToolDefinitions`, which renders a section displaying available tool definitions along with their call counts and assigned definition numbers, typically within an `IOPreview` component.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/ThinkingBlock.tsx",
            "description": "This file defines two React components, `ThinkingBlock` and `RedactedThinkingBlock`, designed to display AI model 'thinking' process outputs within a UI. `ThinkingBlock` shows the content directly or a summary, while `RedactedThinkingBlock` displays sensitive or redacted thinking data, often due to content filtering.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/ViewModeToggle.tsx",
            "description": "This file defines the `ViewModeToggle` React component, which allows users to switch between 'Formatted' and 'JSON' views for data display, and includes an optional 'Beta' toggle specifically for the JSON view.",
            "spof": false
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/chat-message-utils.ts",
            "description": "Provides utility functions for processing and extracting information from ChatML messages, primarily for determining their renderability and content types in a UI context.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/ToolCallDefinitionCard.tsx",
            "description": "A React component that displays a list of expandable cards, each representing a tool definition. It shows the tool's name, call status, description, and parameters, with an option to view parameters in a formatted or raw JSON format.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/hooks/useChatMLParser.ts",
            "description": "This file defines a React hook (`useChatMLParser`) that processes raw input/output data into a normalized ChatML message format, extracting and organizing tool definitions and calls for display. It also optimizes performance by accepting pre-parsed data.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceDetailView/TraceDetailViewHeader.tsx",
            "description": "This React component renders the header for a trace detail view, displaying key trace information, action buttons (e.g., dataset, annotate, comments), and various metadata badges (timestamp, session, user, environment).",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceDetailView/TraceDetailView.tsx",
            "description": "This component displays the detailed view for a specific trace, showing its properties, observations, and scores across various tabs. It allows users to switch between a preview, a log view of observations, and a scores table, with options for different data display formats like formatted or JSON views.",
            "spof": false
          },
          {
            "path": "web/src/components/trace2/components/TraceDetailView/TraceMetadataBadges.tsx",
            "description": "This file provides reusable React components for displaying various metadata as badges (e.g., session ID, user ID, environment, release, version) within a trace detail view. Each component handles its own data null checks and rendering logic.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/useLogViewPreferences.ts",
            "description": "This file defines a React hook for managing and persisting display preferences (like indentation and millisecond display) for a log view component using local storage.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/log-view-types.ts",
            "description": "This file defines TypeScript types and interfaces used for rendering logs in a trace view component, specifically for virtualized lists and different display modes like chronological or tree-order with various tree styles.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/log-view-flattening.clienttest.ts",
            "description": "This file contains unit tests for the `log-view-flattening` utility, which provides functions to flatten and filter trace observations for display in a log view. It tests chronological and tree-based flattening, as well as search filtering functionality.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/log-view-flattening.ts",
            "description": "Provides utility functions for flattening hierarchical trace log data into linear lists for virtualized display, offering both chronological and tree-order arrangements, and includes search filtering capabilities.",
            "spof": false
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/TraceLogView.tsx",
            "description": "This component (`TraceLogView`) renders a log view of trace observations, featuring conditional virtualization, different display modes (chronological, tree-order), search, and expandable rows for detailed I/O previews.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/log-view-formatters.ts",
            "description": "Provides pure formatting utility functions for presenting trace log data (e.g., display names, relative times, durations, and depth indicators) within a LogView component.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/LogViewObservationCell.tsx",
            "description": "A React component that displays a single log observation entry in a trace view, featuring viewport-based prefetching with debouncing to load observation details before the user expands the row.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/LogViewExpandedContent.tsx",
            "description": "This component displays the expanded details (input, output, and metadata) of a log view row, fetching the observation data lazily and rendering it as a pretty-formatted JSON view.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/LogViewJsonMode.tsx",
            "description": "This React component renders all observations related to a trace as a single, combined JSON object. It fetches the I/O data for all observations and displays it in a collapsable JSON viewer, including loading and error states.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/useLogViewColumns.tsx",
            "description": "This file defines a React hook, `useLogViewColumns`, that provides column configurations for a log view table, including observation details, depth, start time, and duration for trace data.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/useLogViewAllObservationsIO.ts",
            "description": "This file provides a React hook for on-demand, batched loading of all observation input/output data within a trace, optimizing performance by utilizing caching and preventing excessive requests.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/useLogViewObservationIO.ts",
            "description": "This file provides React hooks for lazily fetching and managing observation input/output data within a trace log view. It supports two different API paths for data retrieval based on a beta feature flag, and includes a hook to monitor the loading status of observation data in the cache.",
            "spof": false
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/useLogViewDownload.ts",
            "description": "This React hook provides functionality for downloading and copying trace data as JSON within the LogView component. It intelligently handles data fetching, using cached data or loading all observations as needed, and manages loading states and user notifications.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/LogViewTreeIndent.tsx",
            "description": "This file defines the `LogViewTreeIndent` React component, which renders visual tree indentation lines to display the hierarchical structure and parent-child relationships within a log view.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceLogView/LogViewToolbar.tsx",
            "description": "This React component provides a toolbar for a trace log view, offering controls for searching, toggling indentation and time display, expanding/collapsing log entries, and options to copy or download trace data, with adaptations for large virtualized traces.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceTimeline/types.ts",
            "description": "This file defines TypeScript types and interfaces specifically for the trace timeline visualization component, including metrics, bar properties, flattened items, row properties, and scale properties.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceTimeline/TimelineScale.tsx",
            "description": "This file defines the `TimelineScale` React component, which renders a time axis for a trace timeline. It displays time markers and grid lines at regular intervals, dynamically adjusted based on the trace's duration and the allocated scale width.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceTimeline/timeline-calculations.clienttest.ts",
            "description": "This file contains unit tests for the timeline calculation utility functions used in the trace visualization component. It verifies the correctness of functions for calculating offsets, widths, and appropriate step sizes within a timeline.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceTimeline/timeline-calculations.ts",
            "description": "Provides pure utility functions and constants for calculating the positioning, sizing, and scaling of elements within a trace timeline component.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceTimeline/index.tsx",
            "description": "Renders a virtualized Gantt chart timeline visualization for trace data, displaying individual steps, their durations, and related metrics.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceTimeline/TimelineRow.tsx",
            "description": "This file defines the `TimelineRow` React component, which renders a single row in a trace timeline. It combines tree structure elements like indentation and expand/collapse buttons with a timeline bar representing the item's duration and metrics.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceTimeline/timeline-flattening.ts",
            "description": "This file flattens a hierarchical tree of trace nodes into a linear list, pre-calculating timeline-specific positioning and width metrics for each item to facilitate rendering in a timeline view.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceTimeline/TimelineBar.tsx",
            "description": "This React component, `TimelineBar`, renders an individual bar for a node in a timeline view, similar to a Gantt chart. It visually represents the node's duration and latency, displaying its name, type, comments, cost, and scores, with special handling for streaming LLMs showing first token time.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/ObservationDetailView/ObservationMetadataBadgeModelParameters.tsx",
            "description": "This file defines a React component that displays model parameters as a series of truncated badges. It iterates over an object of model parameters, rendering each key-value pair for visualization in a detail view.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/ObservationDetailView/ObservationMetadataBadgesSimple.tsx",
            "description": "This file provides simple, reusable React components (badges) for displaying various metadata points related to an observation, such as latency, environment, version, and status. Each badge handles null checks for its respective data.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/ObservationDetailView/ObservationMetadataBadgesTooltip.tsx",
            "description": "Provides React components (`CostBadge`, `UsageBadge`) to display interactive metadata badges for observation details, showing cost and token usage with detailed breakdown tooltips.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/ObservationDetailView/ObservationMetadataBadgeModel.tsx",
            "description": "This file provides a React component `ModelBadge` which displays a model's name. It either renders it as a linked badge with an external link to model details if the model is internally recognized, or as an unlinked badge with an option to create a new model entry if it's not.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/ObservationDetailView/ObservationDetailView.tsx",
            "description": "This component displays detailed information for a selected observation, including its metadata, cost, and token usage, with a tabbed interface for viewing previews (formatted or JSON) and scores. It integrates various data sources and user preferences to provide a comprehensive observation overview.",
            "spof": false
          },
          {
            "path": "web/src/components/trace2/components/ObservationDetailView/ObservationDetailViewHeader.tsx",
            "description": "This React component renders the header for an observation detail view, displaying the observation's title, action buttons, and a comprehensive set of metadata badges.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceGraphView/TraceGraphView.tsx",
            "description": "This component acts as a wrapper for the `TraceGraphViewComponent`, fetching trace graph data from a context and rendering it, while also handling loading states.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/api/useTraceComments.ts",
            "description": "This file defines a React hook, `useTraceComments`, which fetches and processes comment counts for observations and a specific trace within a given project, ensuring the user is authenticated and a project member.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/api/usePrefetchObservation.ts",
            "description": "This file defines a React hook for prefetching observation data within the trace viewer component. It conditionally fetches data from different API endpoints based on a 'V4 beta' feature flag, with a 5-minute stale time.",
            "spof": false
          },
          {
            "path": "web/src/components/trace2/lib/tree-building.clienttest.ts",
            "description": "This file contains unit tests for the `tree-building` utility functions, specifically `buildTraceUiData`, which organizes raw trace and observation data into a hierarchical structure for UI display.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/lib/types.ts",
            "description": "Defines core TypeScript types for representing hierarchical trace and observation data, and a flattened version for search and list views, used within a trace component.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/lib/download-trace.ts",
            "description": "This file provides a utility function to download trace data, including associated observations, as a JSON file in the browser.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/lib/tree-building.ts",
            "description": "This file provides utilities for building a hierarchical tree structure and related data (node map, search items) from trace observations. It employs an iterative, non-recursive algorithm to efficiently handle deep trees for UI representation.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/lib/helpers.ts",
            "description": "This file provides helper functions for structuring and processing trace observations. It includes utilities for nesting observations into a hierarchical tree, calculating aggregated costs, and preparing the data for UI display.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/hooks/useHandlePrefetchObservation.ts",
            "description": "This React hook provides a callback function to prefetch observation data when hovering over non-trace nodes in navigation panels, leveraging trace and project IDs from context.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/hooks/useJsonBetaToggle.ts",
            "description": "This file provides a React hook (`useJsonBetaToggle`) to manage the state of a 'JSON Beta' toggle and switch between 'pretty', 'json', and 'json-beta' view modes for JSON content, including a migration for existing user preferences.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/contexts/JsonExpansionContext.tsx",
            "description": "This file defines a React Context and Provider for managing and persisting the expand/collapse state of JSON data across different view types (formatted, JSON, advanced JSON) using session storage.",
            "spof": false
          },
          {
            "path": "web/src/components/trace2/contexts/json-expansion-utils.ts",
            "description": "Provides utility functions to normalize and denormalize JSON expansion state keys for persistent storage, translating between actual observation keys (with IDs) and a simplified, ID-agnostic format.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/contexts/json-expansion-utils.clienttest.ts",
            "description": "This file contains unit tests for utilities that normalize and denormalize JSON expansion state keys. It covers `normalizeKey`, `normalizeExpansionState`, and `denormalizeExpansionState` functions, ensuring correct translation between observation keys and their normalized forms for persistent storage.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/contexts/TraceGraphDataContext.tsx",
            "description": "Provides a React Context for managing and sharing agent graph data required for trace visualization, including fetching data, determining graph view availability, and handling performance for large traces.",
            "spof": false
          },
          {
            "path": "web/src/components/trace2/contexts/SelectionContext.tsx",
            "description": "Manages UI interaction state for a trace visualization, including node selection (synced to URL), tree node collapse/expand states, search queries, and view preferences for data display (synced to URL and local storage).",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/contexts/ViewPreferencesContext.tsx",
            "description": "This file defines a React Context for managing and persisting user display preferences for the trace view, such as showing durations, costs, scores, comments, and various log/JSON view modes, using local storage.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/contexts/TraceDataContext.tsx",
            "description": "This file defines a React Context and Provider for trace-related data. It processes raw trace, observation, and score data, computes and memoizes a tree structure and other derived data for UI display, and makes this read-only data available to child components.",
            "spof": false
          },
          {
            "path": "web/src/components/trace2/config/trace-view-config.ts",
            "description": "This file centralizes configuration constants for the `trace2` component's log view, defining settings related to virtualization, performance thresholds, rendering dimensions, and data fetching behavior. It helps tune and maintain the display and performance of trace logs.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/buildStepData.clienttest.ts",
            "description": "This file contains unit tests for the `buildStepData` function, which organizes trace observations into sequential steps based on their timing and parent-child relationships for trace graph visualization.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/nestObservations.clienttest.ts",
            "description": "This file contains unit tests for the `nestObservations` helper function. It verifies that the function correctly transforms a flat list of observations into a hierarchical, nested tree structure based on their parent-child relationships.",
            "spof": true
          },
          {
            "path": "web/src/pages/trace/[traceId].tsx",
            "description": "This file implements a Next.js server-side redirect for old `/trace/[traceId]` URLs. It retrieves the project ID associated with a given trace ID and redirects the user to the new project-specific trace URL, `/project/[projectId]/traces/[traceId]`.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/traces/[traceId].tsx",
            "description": "This file defines a Next.js page component that displays the details of a specific trace within a project. It extracts the `traceId` and an optional `timestamp` from the URL query parameters and passes them to the `TracePage` component for rendering.",
            "spof": false
          },
          {
            "path": "web/src/pages/public/traces/[traceId].tsx",
            "description": "This file provides a backward-compatible redirect from a deprecated public trace URL (`/public/traces/[traceId]`) to the new trace page (`/trace/[traceId]`). It re-exports the component and server-side props from the updated trace page.",
            "spof": false
          },
          {
            "path": "web/src/hooks/useParsedTrace.ts",
            "description": "A React hook that parses trace input, output, and metadata, offloading large parsing tasks to a Web Worker to prevent UI blocking, and caching the results with React Query.",
            "spof": false
          },
          {
            "path": "web/src/hooks/useParsedObservation.ts",
            "description": "This file defines a React hook, `useParsedObservation`, that fetches and parses observation data using Web Workers to prevent UI blocking, falling back to sync parsing for smaller payloads or when workers are unavailable. It integrates with React Query for efficient data fetching and caching of both raw and parsed observation data.",
            "spof": false
          },
          {
            "path": "web/src/utils/chatml/index.ts",
            "description": "This file re-exports ChatML-related utility functions and types from the `@langfuse/shared` package, making them accessible within the web application. It acts as an aggregation point for core ChatML functionalities.",
            "spof": true
          },
          {
            "path": "web/src/utils/chatml/adapters/aisdk.ts",
            "description": "This file re-exports the `aisdkAdapter` from the shared Langfuse package, likely serving as an integration point or adapter for the AI SDK within the Langfuse web application.",
            "spof": true
          },
          {
            "path": "web/src/workers/json-parser.worker.ts",
            "description": "This file implements a Web Worker responsible for asynchronously parsing large JSON data structures (input, output, metadata) off the main thread to prevent UI blocking. It uses an iterative deep parsing function and returns the parsed data or an error.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/CommentDrawerButton.tsx",
            "description": "This component renders a button that opens a drawer containing a list of comments for a specific object, handling access control and deep linking for comments.",
            "spof": false
          },
          {
            "path": "web/src/features/notifications/ErrorNotification.tsx",
            "description": "This file defines the `ErrorNotification` React component, which displays a customizable error or warning message within the application. It includes options to show an error description, relevant path, and a button to report errors to the support team.",
            "spof": false
          },
          {
            "path": "web/src/features/navigate-detail-pages/context.tsx",
            "description": "This file implements a React Context for managing and sharing multiple lists of detail page entries across an application. It provides a provider component to manage the state and a custom hook to access it.",
            "spof": true
          },
          {
            "path": "web/src/features/trace-graph-view/buildGraphCanvasData.ts",
            "description": "This file contains functions to transform raw LangGraph agent trace data into a generalized graph structure suitable for visualization, including handling system nodes and building connections between steps.",
            "spof": true
          },
          {
            "path": "web/src/features/trace-graph-view/buildStepData.ts",
            "description": "This file processes raw agent graph data to assign chronological 'steps' to observations, ensuring parent-child timing constraints are met, and adds special system nodes for graph visualization or further processing.",
            "spof": true
          },
          {
            "path": "web/src/features/trace-graph-view/types.ts",
            "description": "This file defines TypeScript types and Zod schemas for representing and validating graph structures, specifically tailored for visualizing and processing LangGraph and agent-related tracing data within the application. It establishes data models for nodes, edges, and metadata associated with these graphs.",
            "spof": false
          },
          {
            "path": "web/src/features/trace-graph-view/components/TraceGraphCanvas.tsx",
            "description": "This file implements a React component, `TraceGraphCanvas`, which visualizes an interactive trace graph using `vis-network`. It displays different types of nodes with distinct styles and provides functionalities like zooming, resetting the view, and node selection.",
            "spof": true
          },
          {
            "path": "web/src/features/trace-graph-view/components/TraceGraphView.tsx",
            "description": "This React component orchestrates the display of a trace graph, processing agent data into a visualizable graph structure. It manages user interactions like node selection and observation cycling, updating both internal state and URL query parameters.",
            "spof": false
          },
          {
            "path": "web/src/features/events/hooks/useEventsViewMode.ts",
            "description": "This file defines a custom React hook `useEventsViewMode` that manages and persists the display mode for events (either 'observation' or 'trace') across URL query parameters and session storage. It provides a consistent way to control how event data is presented in the UI.",
            "spof": true
          },
          {
            "path": "web/src/features/events/lib/eventsToTraceAdapter.ts",
            "description": "This file defines types and a utility function to convert a collection of individual event observations into a synthetic trace structure. It synthesizes trace-level information from these observations for display in a trace component.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/IORepresentation/toCompactVerbosity.ts",
            "description": "This file provides a utility function to generate a compact, display-friendly representation of input/output data, primarily by attempting to extract ChatML-formatted content.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/IORepresentation/chatML/types.ts",
            "description": "This file defines Zod schemas for various ChatML message components, supporting OpenAI API formats including multimodal content (text, image, audio), tool definitions and calls, and model thinking/reasoning. It provides schemas for both lightweight backend processing and comprehensive frontend rendering of chat messages.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/IORepresentation/chatML/toCompactVerbosityChatML.ts",
            "description": "This file provides a utility function `toCompactVerbosityChatML` that extracts the stringified content of the last message from various ChatML-like input formats for a compact representation.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/chatml/index.ts",
            "description": "This file serves as an aggregation point for ChatML-related utilities, types, and core functionalities. It re-exports various schema definitions and a collection of adapters for different AI platforms and frameworks to ensure they are easily accessible.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/utils/framework-traces/README.md",
            "description": "This file documents the purpose of the 'framework-traces' folder, explaining what framework traces are, how to add new ones, and how to use them within the UI.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 63
          },
          {
            "name": "Nimar",
            "percent": 28
          },
          {
            "name": "marliessophie",
            "percent": 6
          }
        ]
      },
      "Trace, Session, & Event Tables": {
        "files": [
          {
            "path": "web/src/components/star-toggle.tsx",
            "description": "This file provides reusable React components for toggling the 'starred' or 'bookmarked' status of various entities like traces and sessions. It includes API integration for updating the bookmark status, optimistic UI updates, and analytics capture for these actions.",
            "spof": false
          },
          {
            "path": "web/src/components/onboarding/SessionsOnboarding.tsx",
            "description": "This file defines a React component (`SessionsOnboarding`) that displays an onboarding splash screen for the 'Sessions' feature in Langfuse. It highlights the benefits of sessions and provides instructions on how to get started.",
            "spof": true
          },
          {
            "path": "web/src/components/onboarding/TracesOnboarding.tsx",
            "description": "This file defines a React component that displays an onboarding screen to introduce users to LLM tracing within the Langfuse application. It highlights key value propositions of tracing and provides actions to configure tracing or view documentation.",
            "spof": true
          },
          {
            "path": "web/src/components/session/index.tsx",
            "description": "This file implements the SessionPage component, which displays detailed information for a specific session. It includes features for viewing session users, scores, comments, managing annotations, filtering associated traces, and actions like downloading session data or toggling session visibility.",
            "spof": false
          },
          {
            "path": "web/src/components/table/filtered-run-pills.tsx",
            "description": "This component (`FilteredRunPills`) displays a list of active filters applied to specific runs within a dataset as interactive badges. Users can hover over these badges to see detailed information about the associated run and the filter condition.",
            "spof": true
          },
          {
            "path": "web/src/components/table/key-value-filter-builder.tsx",
            "description": "This component provides a flexible UI for building and managing key-value filters. It supports different filter modes (categorical, numeric, string) and allows users to add, remove, and modify filter criteria using various input types like comboboxes, multi-selects, and text inputs.",
            "spof": false
          },
          {
            "path": "web/src/components/table/data-table-controls.tsx",
            "description": "This file defines a React component and context for a data table's filter controls. It provides state management for the filter sidebar's open/collapsed state and renders various interactive filter facets (e.g., categorical, numeric, key-value) along with an AI-powered filtering option.",
            "spof": false
          },
          {
            "path": "web/src/components/table/use-cases/useFullTextSearch.tsx",
            "description": "This file defines a React hook for managing full-text search parameters (query and type) using URL query parameters, providing state management for search functionality.",
            "spof": true
          },
          {
            "path": "web/src/components/table/use-cases/sessions.tsx",
            "description": "This file defines the SessionsTable component, which displays a paginated and filterable table of sessions for a given project. It integrates various data fetching, filtering, and UI components to manage and interact with session data.",
            "spof": false
          },
          {
            "path": "web/src/components/table/use-cases/observations.tsx",
            "description": "This file defines the `ObservationsTable` React component, which is responsible for displaying a comprehensive table of observations. It includes functionalities for filtering, sorting, searching, pagination, and managing observation data within the Langfuse application.",
            "spof": false
          },
          {
            "path": "web/src/components/table/use-cases/traces.tsx",
            "description": "This file defines the `TracesTable` React component, which displays a comprehensive table of traces with features like filtering, sorting, pagination, and data fetching from the Langfuse API, incorporating various table management hooks and utilities.",
            "spof": false
          },
          {
            "path": "web/src/components/table/peek/hooks/usePeekData.ts",
            "description": "This file defines a React hook, `usePeekData`, which fetches trace data. It conditionally retrieves this data from either an 'old' traces API or a 'new' events API based on a beta feature toggle.",
            "spof": false
          },
          {
            "path": "web/src/components/table/peek/hooks/usePeekNavigation.ts",
            "description": "A React hook for managing 'peek' (detail preview) navigation, including opening/closing the peek view, resolving navigation paths, and optionally expanding the peek view into a full detail page, all while synchronizing with URL parameters.",
            "spof": true
          },
          {
            "path": "web/src/components/table/peek/hooks/usePeekRunsCompareData.ts",
            "description": "This file defines a React hook, `usePeekRunsCompareData`, that fetches and combines trace data, dataset item details, and specific dataset run items for comparison views. It is used to retrieve all necessary data for the 'peek' functionality in tables, allowing detailed inspection and comparison of runs.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceSearchList.tsx",
            "description": "Displays a virtualized list of filtered trace observations based on a search query, optimized for performance with large datasets.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/TraceSearchListItem.tsx",
            "description": "This file defines a React component, `TraceSearchListItem`, which renders an individual search result row within a trace view. It displays detailed information for a trace item, including its type, content, and relative temporal context.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/contexts/SearchContext.tsx",
            "description": "This file defines a React Context (`SearchContext`) for managing search input and query state, including a debounced update mechanism for user typing and an immediate update function. It isolates search-related state to prevent unnecessary re-renders of unrelated components.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/traces-ui-table.servertest.ts",
            "description": "This file contains asynchronous server-side tests for the Traces table API. It verifies the correct retrieval and filtering of trace data, including associated observations, for the UI table display.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/observations.tsx",
            "description": "This file defines a Next.js page component that displays observations or events for a specific project. It includes an onboarding experience for users who have not yet configured tracing.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/sessions.tsx",
            "description": "This Next.js page displays a list of sessions for a specific project, offering an onboarding experience for new users and conditionally loading session data based on a beta feature flag.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/traces.tsx",
            "description": "This page component displays a list of traces or events for a specific project, depending on beta feature enablement. It also provides an onboarding experience for projects where tracing has not yet been configured.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/observations/new.tsx",
            "description": "This file defines a Next.js page that displays tracing events for a specific project. It conditionally renders an onboarding screen if tracing is not yet configured, otherwise it shows a table of observations/events.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/sessions/[sessionId].tsx",
            "description": "This Next.js page component displays details for a specific session within a project, dynamically rendering either a beta or standard session view based on feature flag status.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/users/[userId].tsx",
            "description": "This file implements a Next.js page that displays detailed information and activity for a specific user within a project, including statistics, traces, sessions, and scores, with conditional rendering based on feature flags (beta).",
            "spof": false
          },
          {
            "path": "web/src/features/batch-exports/components/BatchExportsTable.tsx",
            "description": "This file defines a React component, `BatchExportsTable`, which displays a paginated table of batch exports for a specific project. It allows users to view details, download completed exports, and cancel queued or processing exports.",
            "spof": false
          },
          {
            "path": "web/src/features/mcp/core/error-formatting.ts",
            "description": "This file provides utilities for formatting various error types into standardized `McpError` objects for user display in MCP responses. It also includes a `wrapErrorHandling` function to automatically catch and format errors from asynchronous operations.",
            "spof": true
          },
          {
            "path": "web/src/features/filters/lib/filter-config.ts",
            "description": "This file defines the data structures for configuring filters in the application, including various types of facets (e.g., categorical, boolean, numeric, key-value) and the overall filter configuration.",
            "spof": false
          },
          {
            "path": "web/src/features/filters/config/observations-config.ts",
            "description": "This file defines the filter configuration for the 'observations' table, including mappings between frontend and backend column names and a comprehensive list of filterable facets with their types, labels, and validation rules.",
            "spof": false
          },
          {
            "path": "web/src/features/filters/config/sessions-config.ts",
            "description": "This file defines the filter configuration for the 'sessions' view, including mapping frontend column IDs to backend keys and specifying all available filterable facets and their properties for sessions.",
            "spof": false
          },
          {
            "path": "web/src/features/filters/config/traces-config.ts",
            "description": "This file defines the configuration for filtering traces within the Langfuse application. It specifies the available filter facets, their types, labels, and associated columns for the traces table.",
            "spof": false
          },
          {
            "path": "web/src/features/background-migrations/components/background-migrations.tsx",
            "description": "This file defines a React component that displays a data table of background migrations. It fetches migration data, shows their status and details, and provides an option to retry failed migrations.",
            "spof": true
          },
          {
            "path": "web/src/features/events/components/index.ts",
            "description": "This file serves as a barrel file, re-exporting the `ObservationsEventsTable` component from its local directory. It simplifies imports for other modules needing event-related components.",
            "spof": true
          },
          {
            "path": "web/src/features/events/components/EventsViewModeToggle.tsx",
            "description": "This file defines a React component, `EventsViewModeToggle`, which provides a dropdown menu for users to switch between different viewing modes for events, such as 'Traces' or 'Observations'.",
            "spof": true
          },
          {
            "path": "web/src/features/events/components/V4BetaSidebarToggle.tsx",
            "description": "This file defines a React component for a sidebar toggle that allows users to enable or disable a 'v4 Beta' feature, likely related to an 'events-based v4 architecture'.",
            "spof": true
          },
          {
            "path": "web/src/features/events/components/EventsTable.tsx",
            "description": "This file defines the `ObservationsEventsTable` React component, which displays a table of events (observations) for a given project. It includes functionalities for data fetching, filtering, sorting, pagination, and view mode switching (e.g., trace vs. observation mode).",
            "spof": true
          },
          {
            "path": "web/src/features/events/server/types.ts",
            "description": "This file defines the Zod schema for `EventsTableOptions`, specifying the structure for filtering, searching, and ordering parameters used when querying or displaying events in a table.",
            "spof": true
          },
          {
            "path": "web/src/features/events/hooks/useEventsFilterOptions.ts",
            "description": "This file defines a React hook to fetch and transform available filter options for events based on the project ID and current filter state. It prepares the data for display in a filtering UI, such as a sidebar.",
            "spof": true
          },
          {
            "path": "web/src/features/events/hooks/useEventsTableData.ts",
            "description": "This file defines a React hook `useEventsTableData` responsible for fetching, processing, and managing event observation data for a UI table, including filtering, pagination, I/O data, and actions like adding to an annotation queue.",
            "spof": true
          },
          {
            "path": "web/src/features/events/hooks/useV4Beta.ts",
            "description": "This file defines a custom React hook `useV4Beta` that manages the V4 beta feature flag for the current user. It allows checking if the beta is enabled and provides a function to toggle its status, integrating with user sessions and an API.",
            "spof": true
          },
          {
            "path": "web/src/features/events/config/filter-config.ts",
            "description": "This file defines the filtering configuration for the 'observations-events' table, specifying which columns can be filtered, their data types, and display labels for the user interface. It centralizes the schema and behavior for applying filters to event data.",
            "spof": false
          },
          {
            "path": "web/src/features/navigation/utils/tracing-tabs.ts",
            "description": "This file defines constants and a utility function for creating navigation tabs for 'Traces' and 'Observations' within a project, standardizing their values, labels, and routes.",
            "spof": true
          },
          {
            "path": "web/src/features/tag/hooks/useTagManager.tsx",
            "description": "This file defines a React hook (`useTagManager`) for managing a collection of tags, including selection, input for new tags, and creation of new tags, with integrated PostHog analytics.",
            "spof": false
          },
          {
            "path": "packages/shared/src/eventsTable.ts",
            "description": "This file defines the column structure for the ClickHouse events table, mapping UI column properties to their internal ClickHouse representations. It is used for filtering, sorting, and displaying events data in the user interface.",
            "spof": true
          },
          {
            "path": "packages/shared/src/observationsTable.ts",
            "description": "This file defines the column structure for an 'observations' data table, including default properties and a mechanism to dynamically populate filter options for certain columns at runtime.",
            "spof": false
          },
          {
            "path": "packages/shared/src/types.ts",
            "description": "This file defines various TypeScript types for data structures related to filtering conditions, states, and options, leveraging Zod schemas. It also enumerates common table names used across the application for consistent referencing.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/tableMappings/mapTracesTable.ts",
            "description": "This file defines the mapping between UI column definitions and their corresponding ClickHouse table fields and select expressions for displaying trace-related data.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/tableMappings/mapSessionTable.ts",
            "description": "This file defines the mappings between UI table columns and their corresponding ClickHouse database fields for session-related data. It specifies how session metrics and attributes are retrieved and displayed from the ClickHouse `traces` and `scores` tables.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/tableMappings/mapEventsTable.ts",
            "description": "This file defines the mapping between user interface column definitions and their corresponding ClickHouse database tables and select statements for event-related data, facilitating data retrieval and display in the frontend.",
            "spof": true
          },
          {
            "path": "packages/shared/src/tableDefinitions/types.ts",
            "description": "This file defines TypeScript types for structuring UI table data, including column definitions, option types, and mappings to backend (ClickHouse) table structures. It serves as a central place for schema definitions used in the application's data display.",
            "spof": false
          },
          {
            "path": "packages/shared/src/tableDefinitions/sessionsView.ts",
            "description": "This file defines the column structure and dynamic options for a table displaying session-related data, including metrics like duration, costs, tokens, and user/environment information. It provides a base column definition and a function to populate options for certain columns at runtime.",
            "spof": false
          },
          {
            "path": "packages/shared/src/tableDefinitions/typeHelpers.ts",
            "description": "This file provides a generic helper function, `formatColumnOptions`, for inferring and assigning the correct type of options to a `ColumnDefinition` object based on its column type.",
            "spof": true
          },
          {
            "path": "packages/shared/src/tableDefinitions/tracesTable.ts",
            "description": "This file defines column structures and types for 'traces' and 'datasets' tables within the Langfuse application. It provides configurable column definitions used for displaying and filtering data, including functions to dynamically populate column options based on available data.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Nimar",
            "percent": 29
          },
          {
            "name": "Leo Weigand",
            "percent": 28
          },
          {
            "name": "Max Deichmann",
            "percent": 17
          }
        ]
      },
      "Data Querying & Analytics API": {
        "files": [
          {
            "path": "web/src/components/trace2/api/useTraceData.ts",
            "description": "This file defines a React hook (`useTraceData`) for fetching a specific trace, its observations, and scores from the API based on a trace ID and project ID. It includes retry logic and provides the fetched data along with loading and error states.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/api/useMedia.ts",
            "description": "This file defines a React hook (`useMedia`) for fetching media attachments associated with a specific trace or observation within a given project, utilizing an API query.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/queryBuilder.servertest.ts",
            "description": "This file contains server-side tests for the query builder and executor. It verifies that various query configurations (for traces, observations, and scores) compile to valid SQL and produce correct results.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/daily-metrics-api.servertest.ts",
            "description": "This file contains asynchronous server-side integration tests for the daily metrics API endpoint, verifying its functionality for retrieving metrics and filtering them by environment.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/event-query-builder.servertest.ts",
            "description": "This file contains unit tests for the `CTEQueryBuilder` class, verifying its functionality for composing multiple Common Table Expressions (CTEs), handling type-safe references, and merging parameters in SQL query construction.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/sessions-comment-filter.servertest.ts",
            "description": "This file contains integration tests for filtering sessions based on comment-related criteria, such as comment count and content, using both PostgreSQL and ClickHouse databases.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/sessions-trpc.servertest.ts",
            "description": "This file contains asynchronous server-side Jest tests for the Langfuse TRPC API session endpoints. It verifies the functionality of retrieving sessions by ID, listing all sessions with filters, and counting sessions.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/async/observations-comment-filter.servertest.ts",
            "description": "This file contains integration tests for filtering observations (generations) based on their associated comments. It verifies that the API can correctly filter observations by comment count, comment content, and combinations of these filters.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/sessions-api.servertest.ts",
            "description": "This file contains asynchronous server tests for the `/api/public/sessions` and `/api/public/sessions/:sessionId` API endpoints, verifying their functionality including session retrieval, filtering by environment, pagination, and date range queries.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/traces-api.servertest.ts",
            "description": "This file contains integration tests for the Langfuse public API's trace management endpoints, including creating, retrieving, and filtering traces and their associated observations.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/sessions-ui-table.servertest.ts",
            "description": "This file contains server-side integration tests for the sessions API, specifically testing the retrieval, filtering, ordering, and metric calculation functionalities for session data.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/async/traces-trpc.servertest.ts",
            "description": "This file contains server-side integration tests for the Langfuse TRPC API endpoints related to 'traces', including listing, counting, retrieving by ID, and fetching filter options.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/async/metrics-v2-api.servertest.ts",
            "description": "This file contains integration tests for the `/api/public/v2/metrics` API endpoint, verifying its data aggregation, filtering, and pagination capabilities. It ensures the API correctly processes and returns various metrics like counts, latency, cost, tokens, and histograms based on the underlying event data.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/traces-comment-filter.servertest.ts",
            "description": "This file contains server-side integration tests for filtering traces based on comment properties such as count and content. It verifies the functionality of these filters across different trace retrieval methods (all, count, metrics).",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/metrics-api.servertest.ts",
            "description": "This file contains asynchronous server-side tests for the `/api/public/metrics` endpoint. It verifies the API's ability to process various valid and invalid metric queries for traces and observations, as well as its authentication and error handling mechanisms.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/observation-api.servertest.ts",
            "description": "This file contains asynchronous integration tests for the public '/api/public/observations' API endpoints. It verifies the functionality of retrieving individual observations and lists of observations, testing against different underlying data storage implementations (events table vs. observations table).",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/observations-trpc.servertest.ts",
            "description": "This file contains server-side integration tests for the TRPC API, specifically verifying the `generations.all` endpoint's functionality, including full-text search and filtering by trace attributes and scores.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/observations-api.servertest.ts",
            "description": "This file contains asynchronous integration tests for the `/api/public/observations` API endpoint. It verifies the API's ability to fetch various types of observations, testing both 'observations table' and 'events table' backend implementations.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/observations-api-v2.servertest.ts",
            "description": "This file contains asynchronous integration tests for the Langfuse public API's /v2/observations endpoint. It verifies functionalities like field group selection, input/output parsing, pagination, and various filtering options.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/repositories/event-repository.servertest.ts",
            "description": "This file contains integration tests for the ClickHouse event repository, verifying the functionality of retrieving observations, including model data, filtering, and pagination, from the events table.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/repositories/clickhouse-resource-errors.servertest.ts",
            "description": "This file contains integration tests for handling and categorizing resource-related errors from ClickHouse, specifically for `queryClickhouse` and `queryClickhouseStream` functions. It ensures that memory, overcommit, and timeout errors are transformed into `ClickHouseResourceError` instances, while other SQL errors are not.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/server/api/tables/prompts-ui.servertest.ts",
            "description": "This file contains server-side tests for fetching and aggregating observation data related to prompts. It verifies the functionality for counting observations associated with prompts (including foldered prompts) and calculating prompt-specific metrics for display in a UI table.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/sessions/index.ts",
            "description": "This file defines a public API endpoint for retrieving a list of sessions associated with a project. It supports filtering by timestamp range, environment, and includes pagination for the results.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/sessions/[sessionId].ts",
            "description": "This file defines a public API endpoint (`GET /api/public/sessions/[sessionId]`) that retrieves the details of a specific session, identified by its ID, along with all traces associated with that session, within an authenticated project scope.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/metrics/daily.ts",
            "description": "This file defines a public API endpoint for retrieving authenticated daily metrics and their total count for a specific project, supporting various filters and pagination.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/traces/[traceId].ts",
            "description": "This file defines an authenticated API endpoint for retrieving details of a specific trace (including its observations, scores, and calculated metrics) and for deleting a specific trace within a project.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/traces/index.ts",
            "description": "This file defines the public API endpoints for managing traces, including creating new traces (legacy method), retrieving traces with optional filtering (supporting both legacy and events-based storage), and deleting multiple traces.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/v2/metrics.ts",
            "description": "This file defines an authenticated public API endpoint for retrieving v2 metrics based on events data, including query validation and execution.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/v2/observations/index.ts",
            "description": "This file defines a public API endpoint (v2) for retrieving observations, supporting filtering, pagination, and data transformation based on various query parameters.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/observations/index.ts",
            "description": "This file defines a public API endpoint to retrieve and filter observations for a project, supporting both an events table and a legacy observations table as data sources, and enriching results with model pricing information.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/observations/[observationId].ts",
            "description": "This file defines a public API endpoint for retrieving a single observation by its ID, optionally fetching from an events table and enriching the data with associated model information.",
            "spof": false
          },
          {
            "path": "web/src/utils/types.ts",
            "description": "This file defines various custom data types, primarily extending a base 'Observation' type for different event/process categories, and provides utility functions for type checking within the application, including tRPC router types.",
            "spof": false
          },
          {
            "path": "web/src/server/api/services/tableDefinitions.ts",
            "description": "Defines column structures and table join logic for various data entities (e.g., traces, observations, scores) within the application, mapping them to their corresponding SQL database representations for data retrieval.",
            "spof": false
          },
          {
            "path": "web/src/features/comments/validateCommentReferenceObject.ts",
            "description": "This file provides a utility function to validate the existence of a referenced object (e.g., observation, trace, session, prompt) before a comment can be created for it, checking against both Clickhouse and Prisma databases.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/types/sessions.ts",
            "description": "This file defines Zod schemas for API session objects and the request/response structures for session-related API endpoints (listing sessions and retrieving a single session) within the public API.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/types/traces.ts",
            "description": "This file defines Zod schemas for trace-related data structures and public API endpoints, including object definitions, query parameters, and response formats for fetching, creating, and deleting traces.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/types/metrics.ts",
            "description": "This file defines Zod schemas for validating request and response payloads for various public API endpoints related to metrics data within the Langfuse application, including general metrics queries and daily summary metrics.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/types/observations.ts",
            "description": "This file defines Zod schemas for the Langfuse Public API's observation resources, including data models, request/response formats for listing and retrieving observations (V1 and V2), and transformation logic from internal database models.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/server/observations.ts",
            "description": "This file provides server-side functions for the public API to query and retrieve observation data and their total counts from ClickHouse, supporting filtering, pagination, and data conversion.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/server/traces.ts",
            "description": "This module constructs and executes ClickHouse queries to retrieve and filter trace data for the public API. It dynamically builds complex SQL queries, incorporating related observations and scores based on request parameters and advanced filters.",
            "spof": false
          },
          {
            "path": "web/src/features/query/index.ts",
            "description": "This file serves as a barrel export for the 'query' feature, aggregating data models, UI table to view mappings, and type definitions related to query functionalities.",
            "spof": true
          },
          {
            "path": "web/src/features/query/dataModel.ts",
            "description": "This file defines data models for various views (e.g., traces, observations) within the Langfuse query system, specifying their dimensions, measures, and table relations for data analysis and querying.",
            "spof": true
          },
          {
            "path": "web/src/features/query/types.ts",
            "description": "This file defines Zod schemas and TypeScript types for various data structures related to querying and data views within the Langfuse application. It specifies the structure of data views, query parameters, metrics, dimensions, and other query-related configurations.",
            "spof": false
          },
          {
            "path": "web/src/features/query/server/queryExecutor.ts",
            "description": "This file is responsible for validating and executing analytical queries against a data store (likely ClickHouse). It includes logic for ensuring query safety, building queries, and optimizing execution with shadow testing capabilities.",
            "spof": true
          },
          {
            "path": "web/src/features/query/server/queryBuilder.ts",
            "description": "This file defines the `QueryBuilder` class, which is responsible for constructing database queries based on user-defined dimensions, metrics, and filters. It validates input against view declarations, translates aggregations, and maps filters for execution, likely against a Clickhouse database.",
            "spof": false
          },
          {
            "path": "web/src/features/events/server/eventsService.ts",
            "description": "This file provides server-side service functions for fetching, counting, and filtering event (observation) data, as well as retrieving batch I/O and metadata for events in the Langfuse application.",
            "spof": false
          },
          {
            "path": "web/src/features/events/hooks/useEventsTraceData.ts",
            "description": "This file defines a React hook, `useEventsTraceData`, that fetches and transforms trace-related data (observations, I/O, and scores) from the events table into a unified trace format. It is specifically designed for use when a v4 beta mode is enabled, providing a mechanism to reconstruct trace views from individual event observations.",
            "spof": true
          },
          {
            "path": "web/src/features/feedback/server/corsMiddleware.ts",
            "description": "This file implements a CORS middleware specifically for feedback-related API routes, allowing requests from any origin for POST, GET, and HEAD methods. It wraps the `cors` library into a promise-based function suitable for Next.js API routes.",
            "spof": false
          },
          {
            "path": "web/src/features/natural-language-filters/server/utils.ts",
            "description": "This file provides utility functions for processing natural language into structured filter conditions using LLMs and for initializing the Langfuse client. It includes logic for parsing and validating AI-generated JSON output for filters.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/batchExport.test.ts",
            "description": "This file contains unit tests for the batch export functionality, specifically verifying the streaming and filtering of observations, traces, and sessions from the database for export.",
            "spof": false
          },
          {
            "path": "worker/src/errors/ObservationNotFoundError.ts",
            "description": "Defines a custom error class, `ObservationNotFoundError`, for situations where a requested observation cannot be found. It also provides a type guard function to check if an error is an instance of this specific error type.",
            "spof": true
          },
          {
            "path": "worker/src/scripts/verifyClickhouseRecords/index.ts",
            "description": "This script verifies data consistency between Postgres and ClickHouse databases for observations, traces, and scores. It queries records from both databases, compares them, logs any discrepancies, and outputs lists of failed verifications.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/__tests__/filterEvaluation.test.ts",
            "description": "This file contains unit tests for the filtering logic used in observation evaluations. It verifies that observations are correctly matched or excluded based on various string and stringOptions filter operators (e.g., equals, contains, starts with, any of) applied to their properties like name, type, and level.",
            "spof": true
          },
          {
            "path": "worker/src/features/database-read-stream/trace-stream.ts",
            "description": "This file defines a function that retrieves trace data, including associated scores and comments, from a database (ClickHouse) and provides it as a readable stream for efficient batch export or processing.",
            "spof": false
          },
          {
            "path": "worker/src/features/database-read-stream/observation-stream.ts",
            "description": "This file provides a function to stream observation data from ClickHouse, including associated scores and trace information, for batch export purposes. It handles filtering, searching, and enriching observations with model data.",
            "spof": false
          },
          {
            "path": "worker/src/features/database-read-stream/getDatabaseReadStream.ts",
            "description": "This file provides a paginated database read stream for various tables (e.g., scores, sessions, observations) in the Langfuse application. It supports batch exports by fetching and transforming data based on filters, orderings, and pagination parameters.",
            "spof": false
          },
          {
            "path": "worker/src/features/database-read-stream/types.ts",
            "description": "This file defines TypeScript types, `BatchExportSessionsRow` and `BatchExportTracesRow`, used for representing session and trace records. These types are likely utilized when reading or streaming data from a database for batch export or processing.",
            "spof": true
          },
          {
            "path": "worker/src/features/eventPropagation/handleExperimentBackfill.ts",
            "description": "This file implements a backfill mechanism for experiment-related data, fetching dataset run items, observations, and traces from ClickHouse, and preparing them for further processing or ingestion.",
            "spof": true
          },
          {
            "path": "packages/shared/src/interfaces/search.ts",
            "description": "Defines the `TracingSearchType` enum, which specifies the types of search operations available for tracing data, differentiating between ID/metadata and content-based searches.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/orderByToPrisma.ts",
            "description": "This file provides a utility function to convert an `OrderByState` object into a Prisma `ORDER BY` SQL clause, mapping UI column names to their internal database representations and handling ordering (ASC/DESC) and nulls.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/index.ts",
            "description": "This file serves as a barrel file, re-exporting a wide range of shared server-side functionalities, services, utilities, and types from various modules within the `shared` package. It aggregates core components for services, data handling, authentication, LLM interactions, background queues, and analytics integrations.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/queries/public-api-filter-builder.ts",
            "description": "This file defines mappings for public API query parameters to ClickHouse columns and provides functions to convert API-provided filters into ClickHouse filter objects for traces, events, and observations.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/queries/types.ts",
            "description": "This file defines the Zod schema and TypeScript type for table filtering parameters used in server-side queries. It includes properties for project ID, filters, search queries, ordering, and pagination.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/queries/createGenerationsQuery.ts",
            "description": "This file defines various extended TypeScript types for observations and events within the application. These types aggregate core observation data with additional fields like pricing, trace metadata, and tool counts for different views and API consumption.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/queries/index.ts",
            "description": "This file serves as a central export point for various types, filters, and utility functions primarily used for constructing and managing ClickHouse SQL queries, including filtering, ordering, and event aggregation. It bundles server-side data access logic related to observations and events.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/queries/clickhouse-sql/clickhouse-filter.ts",
            "description": "This file defines classes for constructing ClickHouse SQL filter clauses based on various data types (string, number, datetime, etc.) and operators. It enables dynamic generation of ClickHouse queries for filtering data.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/queries/clickhouse-sql/orderby-factory.ts",
            "description": "This file provides utility functions to convert UI-defined order-by states into formats suitable for ClickHouse queries. It generates ClickHouse SQL `ORDER BY` clauses or structured order-by entries, mapping UI column names to their internal ClickHouse equivalents.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/queries/clickhouse-sql/search.ts",
            "description": "This file provides a utility function `clickhouseSearchCondition` for generating SQL `WHERE` clause conditions and parameters suitable for ClickHouse searches. It dynamically constructs search queries based on search type, query string, and specified columns, facilitating flexible trace data searching.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/queries/clickhouse-sql/query-fragments.ts",
            "description": "Provides reusable ClickHouse SQL query fragments and Common Table Expressions (CTEs) for aggregating events and scores at both trace and observation levels. It helps build queries to reconstruct traces from events and consolidate score data.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/queries/clickhouse-sql/event-query-builder.ts",
            "description": "This file defines SQL field mappings and sets for querying event and trace data in ClickHouse, and provides a base class for constructing SQL queries with WHERE, ORDER BY, and LIMIT clauses.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/queries/clickhouse-sql/query-options.ts",
            "description": "This file defines a utility function to determine whether the `FINAL` modifier should be skipped for ClickHouse observations queries, based on environment variables or a project's OTEL usage status.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/queries/clickhouse-sql/factory.ts",
            "description": "This file serves as a factory for converting frontend filter conditions into ClickHouse-specific filter objects. It maps UI column names to ClickHouse schema, validates table names, and constructs filter instances to prepare parameterized SQL queries, primarily to prevent SQL injection.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/services/sessions-ui-table-service.ts",
            "description": "This file provides service functions to fetch session data for UI tables, including session counts, basic details, and comprehensive metrics, with support for filtering, ordering, and pagination from a ClickHouse database.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/services/commentFilterService.ts",
            "description": "This file provides a service for processing and applying comment-related filters (by count or content) to different object types. It converts comment filters into object ID filters, handles edge cases like zero-comment inclusion, and enforces result limits.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/services/traces-ui-table-service.ts",
            "description": "This file defines types and functions for retrieving, filtering, sorting, and transforming trace data and associated metrics for UI display. It constructs complex ClickHouse queries to fetch detailed trace information based on various criteria.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/services/sessions-ui-table-events-service.ts",
            "description": "This service file is responsible for querying and aggregating session-related data from ClickHouse, including traces, metrics, and event details, to support the display and analysis of sessions in a UI table. It provides functions to fetch session counts, detailed session lists, and session data with associated metrics.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/trace-sessions.ts",
            "description": "This file provides utility functions for querying and filtering trace sessions within a project. It includes logic to transform bookmark filters into ID-based filters and to check for the existence of any trace session for a given project.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/repositories/observations_converters.ts",
            "description": "This file provides utility functions for converting and enriching observation records from ClickHouse database format into application domain models, handling various data types, rendering, and validation. It supports both partial and complete conversions of observation data.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/repositories/index.ts",
            "description": "This file serves as an aggregation point, re-exporting various repository modules from the `repositories` directory. It provides a central entry point for accessing data access logic related to different application entities like traces, scores, observations, events, and datasets.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/repositories/observations.ts",
            "description": "This file defines functions for interacting with 'observations' data, primarily performing CRUD operations (create, retrieve, check existence) by querying and updating the ClickHouse database. It handles fetching observations based on various criteria like trace ID, observation ID, and name.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/repositories/constants.ts",
            "description": "This file defines constant time intervals used for querying and linking data related to observations, traces, and scores within the application's repository layer, typically for database operations.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/events.ts",
            "description": "This file provides functions to query and process event observations from a ClickHouse database. It includes logic for enriching observations with model pricing data, handling filters, and preparing data for API consumption.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/tableMappings/mapObservationsTable.ts",
            "description": "This file defines mappings between user interface column definitions and their corresponding ClickHouse table and select expressions for observations and traces, facilitating data display and querying from the frontend.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/zod.ts",
            "description": "This file provides a collection of reusable Zod schemas and utility functions for common data validation patterns, including recursive JSON structures, pagination parameters, string sanitization, and date parsing, primarily for API request and response handling.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Valery Meleshkin",
            "percent": 48
          },
          {
            "name": "Steffen Schmitz",
            "percent": 21
          },
          {
            "name": "Max Deichmann",
            "percent": 12
          }
        ]
      },
      "Data Persistence & Lifecycle Management": {
        "files": [
          {
            "path": "web/src/__tests__/media.servertest.ts",
            "description": "This file contains end-to-end server-side tests for the media upload and retrieval API, verifying the complete flow from obtaining upload URLs to storing and fetching media assets for traces and observations.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/repositories/trace-repository.servertest.ts",
            "description": "This file contains unit/integration tests for the trace repository, specifically for its Clickhouse implementation. It verifies the functionality of retrieving, creating, and checking the existence of traces and associated observations, including filtering by level.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/async/repositories/observation-repository.servertest.ts",
            "description": "This file contains server-side integration tests for the observation repository, specifically verifying its functionality to create, retrieve, and manage observations stored in ClickHouse.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/BatchActionsSettingsPage.tsx",
            "description": "This file defines a React component for displaying and managing batch actions within a project's settings. It shows the status of asynchronous bulk operations like adding observations or deleting traces, while enforcing access control based on user permissions.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/batchDataRetentionCleaner.test.ts",
            "description": "This file contains unit tests for the `BatchDataRetentionCleaner` class, verifying its functionality in deleting old data (traces, observations, and scores) based on project-specific retention policies.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/batchTraceDeletionCleaner.test.ts",
            "description": "This file contains unit and integration tests for the BatchTraceDeletionCleaner, ensuring it correctly processes and marks trace deletions, and handles soft-deleted projects appropriately.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/traceDeletion.test.ts",
            "description": "This file contains unit tests for the trace deletion functionality, verifying that traces, observations, scores, and their associated S3 media and event files are correctly removed from ClickHouse and S3 buckets.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/utils.ts",
            "description": "This utility file provides a function to prune (delete all data from) various tables in the database, intended for use in test environments running on localhost to ensure a clean state.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/traceDeleteQueue.test.ts",
            "description": "This file contains unit tests for the `traceDeleteQueue` processor, which handles the deletion of traces from the system. It verifies various scenarios, including deleting new traces, handling already marked-as-deleted traces, batch processing, and interactions with a 'pending deletion' tracking mechanism.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/migrateObservationsFromPostgresToClickhouse.ts",
            "description": "This file defines a background migration task to transfer observation data from a PostgreSQL database to a ClickHouse database, handling batch processing and state management.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/backfillEventsHistoric.ts",
            "description": "This file implements a background migration to backfill historic event data into ClickHouse, managing concurrent queries and processing data in defined chunks.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/migrateTracesFromPostgresToClickhouse.ts",
            "description": "This file implements a background migration task to transfer trace data from a PostgreSQL database to a ClickHouse database in batches. It validates ClickHouse connectivity and table existence before performing the data transfer, and tracks its progress in a background migration state.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/migrateEventLogToBlobStorageRefTable.ts",
            "description": "This file implements a background migration process to transfer data from the `event_log` ClickHouse table to the `blob_storage_file_log` table, tracking its progress and state for resume capability.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/addGenerationsCostBackfill.ts",
            "description": "This file defines a background migration that backfills and calculates cost-related fields for 'observations' records in the database, especially for entries where these costs are currently null. It processes data in batches, utilizing model pricing information and a temporary column for tracking progress.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/backfillEventsHistoricFromParts.ts",
            "description": "This file implements a background migration to backfill historical event data into the 'events' table in ClickHouse. It processes data in chunks, specifically by iterating over 'parts' from ClickHouse's system tables (`observations_pid_tid_sorting` and `traces_pid_tid_sorting`), and manages concurrent data insertion queries.",
            "spof": true
          },
          {
            "path": "worker/src/queues/traceDelete.ts",
            "description": "This file defines a BullMQ processor responsible for batch deleting traces from both PostgreSQL and ClickHouse databases based on job payloads and pending deletion records, and then marking them as deleted.",
            "spof": false
          },
          {
            "path": "worker/src/scripts/verifyClickhouseRecords/README.md",
            "description": "This script is used to compare and validate data consistency between Clickhouse and Postgres records, specifically checking if they produce equal results.",
            "spof": true
          },
          {
            "path": "worker/src/features/batch-trace-deletion-cleaner/index.ts",
            "description": "This file defines a background worker that periodically identifies projects with the largest backlog of pending trace deletions and processes them in batches, deleting traces from both PostgreSQL and ClickHouse databases.",
            "spof": true
          },
          {
            "path": "worker/src/features/health/index.ts",
            "description": "This file defines functions for checking the health of a container, including its database and Redis connections, and for managing graceful shutdowns based on SIGTERM signals.",
            "spof": false
          },
          {
            "path": "worker/src/features/traces/processClickhouseTraceDelete.ts",
            "description": "This file contains a function to orchestrate the deletion of specified traces and their associated data (media, observations, scores, events) from Clickhouse and S3 storage for a given project. It ensures all related data is removed comprehensively.",
            "spof": true
          },
          {
            "path": "worker/src/features/traces/processPostgresTraceDelete.ts",
            "description": "This file provides a function to delete specified traces for a given project from the PostgreSQL database, specifically by removing associated job execution records.",
            "spof": false
          },
          {
            "path": "worker/src/features/eventPropagation/handleEventPropagationJob.ts",
            "description": "This file defines a BullMQ job handler that propagates event data from the `observations_batch_staging` table to the `events` table in ClickHouse. It uses Redis to track the last processed data partition for sequential processing.",
            "spof": true
          },
          {
            "path": "worker/src/services/ClickhouseWriter/ClickhouseWriter.unit.test.ts",
            "description": "This file contains unit tests for the `ClickhouseWriter` class, ensuring its functionality for batching, writing, error handling, and shutdown with ClickHouse. It verifies aspects like singleton behavior, queue management, flush intervals, retries, and metrics reporting.",
            "spof": true
          },
          {
            "path": "worker/src/services/ClickhouseWriter/index.ts",
            "description": "This file defines the `ClickhouseWriter` class, a singleton responsible for buffering and reliably writing various types of data records (like traces, observations, and scores) to a ClickHouse database. It handles batching, retries, and error conditions such as oversized records or network issues.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/traceDeletionProcessor.ts",
            "description": "This file contains logic for processing and scheduling the delayed deletion of traces. It includes functions to check if trace deletion should be skipped for a project and to add trace deletion jobs to a queue for asynchronous, batched execution.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/clickhouse/schemaUtils.ts",
            "description": "Provides utility functions for validating ClickHouse table names and mapping ingestion event types to specific Langfuse entity types (e.g., trace, observation, score) for ClickHouse storage.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/data-deletion/ingestionFileDeletion.ts",
            "description": "This file provides functions to delete ingestion event data from S3 storage and soft-delete their references in ClickHouse, based on project, score IDs, trace IDs, or a cutoff date.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/traceDelete.ts",
            "description": "This file defines a singleton class for managing a BullMQ Redis queue specifically designed to handle trace deletion tasks, including configuration for retries and error logging.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/s3SlowdownTracking.ts",
            "description": "This file provides utilities to detect S3 SlowDown errors and manage a Redis-based tracking system for projects experiencing these issues. It allows marking projects with S3 slowdowns and checking for existing slowdown flags to potentially route traffic differently.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/types.ts",
            "description": "This file defines common data types used across the server-side repositories, specifically the 'TableCount' type for representing a count of items, likely from a table.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/repositories/traces_converters.ts",
            "description": "This file contains utility functions for converting trace data between the application's domain model (`TraceDomain`) and the Clickhouse database record format (`TraceRecordReadType`). It handles both conversion from domain to Clickhouse and from Clickhouse to domain, including batch conversions and conditional inclusion of related fields.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/repositories/README.md",
            "description": "This document outlines time-based guarantees and look-back periods for relating data entities (Traces, Observations, Scores) within Langfuse, addressing discrepancies in event timestamps.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/traces.ts",
            "description": "This file defines a repository for interacting with trace data stored in Clickhouse. It provides functions to check for trace existence, retrieve traces by ID or session ID, and upsert trace records.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/repositories/clickhouse.ts",
            "description": "This file provides a repository layer for interacting with ClickHouse, handling data upserts (including S3 blob storage integration), streaming queries, custom error management for resource issues, and OpenTelemetry instrumentation.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/repositories/blobStorageLog.ts",
            "description": "This file provides repository functions for querying and managing blob storage file references (metadata about files stored externally) in a ClickHouse database. It includes functionalities to retrieve references by project, entity, or trace IDs, as well as a utility for migrating data from an event log table.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/tableMappings/index.ts",
            "description": "This file serves as an aggregation point for various server-side table mapping definitions within the shared package. It re-exports functions or modules responsible for mapping data to different table structures like observations, traces, scores, and dataset run items.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/test-utils/index.ts",
            "description": "This file serves as an index for server-side test utilities, re-exporting modules related to tracing, ClickHouse helpers, and organization factory functions for testing purposes.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/test-utils/clickhouse-helpers.ts",
            "description": "This file provides utility functions for inserting test data into various ClickHouse tables (traces, observations, events, scores, and dataset run items). It is used for testing purposes, likely integration or end-to-end tests.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/test-utils/tracing-factory.ts",
            "description": "This file provides factory functions for creating mock data objects for traces, observations, scores, dataset run items, and events. These utilities are primarily used in testing to generate predefined data structures for database insertions.",
            "spof": false
          },
          {
            "path": "packages/shared/scripts/seeder/seed-media.ts",
            "description": "This script seeds test traces with various media attachments (images, PDFs, audio) into the database and uploads them to configured storage. It is used to test the media rendering capabilities of the application's UI.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/seed-clickhouse.ts",
            "description": "This script seeds ClickHouse with sample data for specified project IDs, preparing it for testing or development environments. It uses a `prepareClickhouse` function to generate data over a set number of days and runs.",
            "spof": true
          },
          {
            "path": "packages/shared/prisma/migrations/20230707132314_traces_project_id_index",
            "description": "This directory contains a specific Prisma database migration for the `langfuse` project, located within its shared packages. It is responsible for applying a schema change to the database, specifically to add an index on the `traces_project_id` column.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230518193415_add_observaionts_and_traces",
            "description": "This directory contains a specific Prisma database migration script for the `langfuse` project, dated 20230518. Its role is to define and apply schema changes, specifically adding tables or columns related to 'observations' and 'traces' to the shared database.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230622114254_new_oservations",
            "description": "This directory contains a specific Prisma migration script, dated 20230622114254, which introduces schema changes related to 'new observations' for the shared database. Its purpose is to evolve the database structure for the `langfuse` application as part of the `shared` package.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230706195819_add_completion_start_time",
            "description": "This directory contains a specific database migration script for the Prisma ORM, designed to add a `completion_start_time` column to the database schema. It represents a single step in the evolution of the database structure.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230623172401_observation_add_level_and_status_message",
            "description": "This directory contains a specific Prisma database migration script within the Langfuse project. Its role is to define the schema change that adds 'level' and 'status_message' fields to the 'observation' table. As part of the `shared/prisma/migrations` system, it ensures incremental updates to the database schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230522094431_endtime_optional",
            "description": "This directory contains a specific Prisma database migration. It defines the schema changes applied at the timestamp 2023-05-22 09:44:31, primarily making the 'endtime' field optional in the database schema. Its role is to track and apply this particular database evolution.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230618125818_remove_status_from_trace",
            "description": "This directory represents a specific database migration within the Prisma schema for the shared package. Its purpose is to remove the 'status' column from a 'trace' table, reflecting a schema change implemented on June 18, 2023.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230809132331_add_project_id_to_observations",
            "description": "This directory contains a specific Prisma database migration script for the 'shared' package. Its purpose is to implement the schema change of adding a 'project_id' to the 'observations' table. This ensures proper data organization and association within the application's database.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230522092340_add_metrics_and_observation_types",
            "description": "This directory contains a specific Prisma database migration. Its role is to define the schema changes necessary to introduce new metrics and observation types into the database, applied on May 22, 2023.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231012161041_add_events_table",
            "description": "This directory contains a specific Prisma migration file. Its role is to define the database schema changes required to add an `events` table, as part of a versioned database update for the `langfuse` application.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230912115644_add_trace_public_bool",
            "description": "This directory contains a specific database migration script for the Prisma ORM. The migration, named '20230912115644_add_trace_public_bool', is responsible for modifying the database schema to add a 'public' boolean field, likely related to trace entities.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231110012457_observation_created_at",
            "description": "This directory represents a specific database migration for the shared Prisma schema within the `langfuse` package. It was created on November 10, 2023, likely to add or modify a 'created_at' field for observation-related database entities.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230710114928_traces_add_user_id",
            "description": "This directory contains a specific Prisma database migration script. Its role is to apply a schema change that adds a 'user_id' column to the 'traces' table within the database. The timestamped name indicates it is part of an ordered sequence of database updates.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230711104810_traces_add_index",
            "description": "This directory contains a specific Prisma database migration script. Its role is to add an index to the `traces` table, optimizing database query performance. It is part of the version-controlled database schema changes for the shared Prisma module.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231025153548_add_headers_to_events",
            "description": "This directory represents a specific database migration script for a Prisma-managed database. Its purpose is to alter the database schema by adding headers to events, as part of the 'shared' package. This ensures the database schema evolves correctly for the application.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231110012829_observation_created_at_index",
            "description": "This directory contains a specific Prisma migration script responsible for adding an index to the 'created_at' column of the 'observation' table. This optimization improves database query performance for the shared data models within the Langfuse project.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231112095703_observations_add_unique_constraint",
            "description": "This directory contains a specific Prisma database migration script. Its purpose is to add a unique constraint to the 'observations' table. This helps maintain data integrity within the Langfuse application's shared database schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230810191452_traceid_nullable_on_observations",
            "description": "This directory contains a specific Prisma database migration script identified by its timestamp. Its role is to apply a schema change that makes the 'traceid' field nullable on the 'observations' table, ensuring proper evolution of the database for the 'shared' package of the Langfuse application.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230922030325_add_observation_index",
            "description": "This directory contains a specific Prisma migration script responsible for applying a database schema change. Specifically, it adds an index related to 'observation' data within the shared package's database schema. Its role is to define and execute this particular step in the database evolution.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240226165118_add_observations_index",
            "description": "This directory contains a specific Prisma migration file responsible for adding an index to the 'observations' table. It represents a single step in the evolution of the database schema for the shared package.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240117165747_add_cost_to_observations",
            "description": "This directory contains the specific database migration files for '20240117165747_add_cost_to_observations'. It is part of the Prisma migration history for the shared package, ensuring that database schemas can be evolved to include a 'cost' field for observations.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240105170551_index_tags_in_traces",
            "description": "This directory represents a specific database migration for the Langfuse application, identified by its timestamp. Its purpose is to define the schema changes required to index 'tags' within the 'traces' table, thereby improving query performance for tag-based searches on traces.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231004005909_add_parent_observation_id_index",
            "description": "This directory contains the specific Prisma database migration script for '20231004005909_add_parent_observation_id_index'. Its role is to apply a schema change, likely adding an index to a database table to optimize queries involving parent observation IDs. It ensures version-controlled and systematic updates to the shared database schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240105010215_add_tags_in_traces",
            "description": "This directory contains a specific Prisma database migration script, timestamped `20240105010215`. Its role is to apply a schema change to the database, specifically adding a 'tags' feature to the 'traces' table as part of the shared Prisma schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240119140941_add_tokenizer_id",
            "description": "This directory represents a specific database migration script for the shared Prisma schema within the Langfuse project. Its role is to define the changes required to add a 'tokenizer_id' field to the database schema. It is part of the version control system for the database structure.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231030184329_events_add_index_on_projectid",
            "description": "This directory contains a specific Prisma database migration script. Its purpose is to add an index on the `projectId` column within the `events` table, improving query performance. It is part of the shared Prisma migrations for the `langfuse` project.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240304123642_traces_view_improvement",
            "description": "This directory contains a specific Prisma database migration. Its purpose is to implement an improvement or update related to the 'traces_view' within the shared Prisma schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240118204937_add_observations_view",
            "description": "This directory contains a specific Prisma database migration. Its primary role is to manage the schema changes required to introduce an 'observations' view within the database. It is named after the timestamp and the action it performs, adding an observations view.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240215234937_fix_observations_view",
            "description": "This directory contains a specific Prisma database migration file, timestamped 20240215234937. Its role is to apply a schema change, likely related to fixing or updating database views concerning observations, within the shared package of the Langfuse application.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240226203642_rewrite_observations_view",
            "description": "This directory contains a specific Prisma database migration named '20240226203642_rewrite_observations_view'. Its purpose is to manage schema changes related to rewriting the 'observations' view within the shared Prisma module.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240226183642_add_observations_index",
            "description": "This directory contains a specific Prisma migration file. Its purpose is to define a database schema change that adds an index for observations, likely to improve query performance.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231204223505_add_unit_to_observations",
            "description": "This directory represents a specific Prisma database migration for the shared package of the Langfuse project. Its purpose is to implement a schema change that adds a 'unit' field to the 'observations' table.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240305100713_traces_add_index",
            "description": "This directory contains a specific Prisma database migration script. Its role is to define and apply schema changes, specifically adding an index to the 'traces' table, to improve database query performance for the shared package.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240226202040_add_observations_trace_id_project_id_start_time_idx",
            "description": "This directory contains a specific database migration script for the Prisma ORM. Its role is to define and apply a schema change that adds an index to the 'observations' table, optimizing queries by 'trace_id', 'project_id', and 'start_time'.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240226182815_add_model_index",
            "description": "This directory represents a specific database migration within the `shared` Prisma schema for the `langfuse` project. It is responsible for applying the changes to add a model index to the database. The name indicates it was created on February 26, 2024.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240228123642_observations_view_fix",
            "description": "This directory contains a specific Prisma database migration identified by its timestamp. Its primary role is to apply a fix to an 'observations view' within the shared package's database schema. This ensures the database structure remains consistent and correct for the application.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240305095119_add_observations_index",
            "description": "This directory contains a specific database migration for the shared Prisma schema. It is responsible for adding an index to the 'observations' table, likely to improve query performance. This helps manage the evolution of the database schema for shared components within the application.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240226202041_add_observations_trace_id_project_id_type_start_time_idx",
            "description": "This directory contains a specific Prisma database migration script. Its role is to apply a schema change by adding an index to the 'observations' table on the 'trace_id', 'project_id', 'type', and 'start_time' columns, likely for performance optimization.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240304123642_traces_view",
            "description": "This directory contains a specific database migration script, identified by its timestamp and name `traces_view`. It is part of the `langfuse` project's shared Prisma migrations, suggesting it modifies the database schema to introduce or update a view related to traces.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240228103642_observations_view_cte",
            "description": "This directory contains a specific Prisma database migration. Its purpose is to define schema changes related to an 'observations_view_cte', likely involving the creation or modification of a database view using Common Table Expressions for observation data.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240227112101_index_prompt_id_in_observations",
            "description": "This directory contains a specific Prisma database migration. Its primary role is to implement an index on the `prompt_id` column within the `observations` table, thereby optimizing database query performance.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Steffen Schmitz",
            "percent": 60
          },
          {
            "name": "Valery Meleshkin",
            "percent": 17
          },
          {
            "name": "Max Deichmann",
            "percent": 14
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 433,
      "spofCount": 247
    },
    "busFactor": 3,
    "authorCount": 13
  },
  "Enterprise SSO": {
    "description": "Enables integration with corporate identity providers like Okta, Azure AD, and Google for secure, seamless, and centralized user authentication.",
    "functions": {
      "SSO Configuration & Identity Management": {
        "files": [
          {
            "path": "web/src/ee/README.md",
            "description": "This README file describes that the features within this folder are exclusive to the Enterprise Edition of Langfuse and Langfuse Cloud. It also provides links to the license and further documentation.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/multi-tenant-sso/multiTenantSsoAvailable.ts",
            "description": "This file determines if multi-tenant SSO features are available based on the presence of a `NEXT_PUBLIC_LANGFUSE_CLOUD_REGION` environment variable. It acts as a feature flag, likely for cloud deployments of Langfuse.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/multi-tenant-sso/types.ts",
            "description": "Defines Zod schemas for various multi-tenant Single Sign-On (SSO) authentication providers and their configurations, including Google, GitHub, Okta, and others. It culminates in a discriminated union schema for a generic SSO provider configuration.",
            "spof": false
          },
          {
            "path": "web/src/ee/features/multi-tenant-sso/utils.ts",
            "description": "This file provides utility functions for managing and integrating multi-tenant SSO configurations with NextAuth, loading and transforming database-stored SSO settings into NextAuth provider instances, and offering helper functions for domain-based provider retrieval.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/multi-tenant-sso/createNewSsoConfigHandler.ts",
            "description": "This file defines a Next.js API handler to create new multi-tenant SSO configurations. It validates input, checks for administrative privileges, encrypts sensitive data, and stores the configuration in the database.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/sso-settings/components/SSOSettings.tsx",
            "description": "This file defines the SSOSettings React component, which displays the Single Sign-On (SSO) configuration page. It either informs the user that SSO is unavailable due to their current plan or instructs them to contact support for setup if entitled.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/auth/add-sso-config.ts",
            "description": "This file defines an API endpoint for adding a new SSO configuration to the database, which is an Enterprise Edition feature.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/scim/ResourceTypes.ts",
            "description": "This Next.js API route provides a SCIM (System for Cross-domain Identity Management) endpoint that, upon successful organization-level authentication, returns information about the available resource types, specifically detailing the 'User' resource.",
            "spof": true
          },
          {
            "path": "packages/shared/prisma/migrations/20231223230008_accounts_add_cols_azure_ad_auth",
            "description": "This directory contains a specific Prisma database migration script. It is responsible for adding columns to the accounts table to support Azure AD authentication, as part of the shared package's database schema evolution.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Marc Klingen",
            "percent": 71
          },
          {
            "name": "Steffen Schmitz",
            "percent": 15
          },
          {
            "name": "mariusp12",
            "percent": 4
          }
        ]
      },
      "SSO Authentication Flow & Provider Integration": {
        "files": [
          {
            "path": "web/src/pages/auth/sso-initiate.tsx",
            "description": "This file initiates the Single Sign-On (SSO) process by reading the SSO provider from the URL query parameters and redirecting the user to the appropriate identity provider using NextAuth.js.",
            "spof": true
          },
          {
            "path": "web/src/pages/auth/enterprise-sso-required.tsx",
            "description": "This page handles the scenario where a user's email domain requires Enterprise SSO for authentication. It prompts the user to enter their company email to identify the specific SSO provider and initiate the correct sign-in flow.",
            "spof": true
          },
          {
            "path": "web/src/pages/auth/sign-in.tsx",
            "description": "This file implements the sign-in page, allowing users to authenticate via email/password credentials or various third-party OAuth/SSO providers like Google, GitHub, and Azure AD. It dynamically determines available authentication methods based on server-side environment configurations.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/auth/check-sso.ts",
            "description": "This API endpoint checks if a custom SSO provider is configured for a given domain. It returns the provider ID if found, otherwise a 404 response.",
            "spof": true
          },
          {
            "path": "web/src/server/auth.ts",
            "description": "This file configures NextAuth.js for the application, defining authentication options and providers such as Credentials, Google, GitHub, and various SSO solutions. It handles user authentication, session management, and related authorization checks.",
            "spof": false
          },
          {
            "path": "web/src/features/auth/constants.ts",
            "description": "This file defines constant strings used within the authentication features of the web application, specifically for Enterprise SSO related messages.",
            "spof": true
          },
          {
            "path": "web/src/features/auth/components/AuthProviderButton.tsx",
            "description": "This file defines the `AuthProviderButton` React component, which renders a button for an authentication provider with an icon, label, loading state, and an optional 'Last used' badge. It is designed for use in authentication UIs.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/auth/customSsoProvider.ts",
            "description": "This file defines and exports a function `CustomSSOProvider` which configures a custom OpenID Connect (OIDC) provider for NextAuth.js, allowing integration with an external identity provider using configurable claim mappings for user attributes.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/auth/gitHubEnterpriseProvider.ts",
            "description": "This file defines a custom NextAuth.js OAuth provider for GitHub Enterprise, enabling authentication against self-hosted GitHub instances with configurable base URLs and enhanced email retrieval.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/auth/jumpcloudProvider.ts",
            "description": "This file defines a custom JumpCloud OAuth provider configuration for NextAuth.js. It enables authentication by integrating with JumpCloud's OpenID Connect endpoint and mapping user profile data.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Marc Klingen",
            "percent": 41
          },
          {
            "name": "Leo Weigand",
            "percent": 19
          },
          {
            "name": "Michael Frhlich",
            "percent": 17
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 19,
      "spofCount": 13
    },
    "busFactor": 1,
    "authorCount": 6
  },
  "User & Access Management": {
    "description": "Manages users, organizations, projects, and role-based access control (RBAC). Provides granular permissions to ensure secure team collaboration and data access segregation.",
    "functions": {
      "User Profile & Navigation UI": {
        "files": [
          {
            "path": "web/src/ee/features/ui-customization/productModuleSchema.ts",
            "description": "This file defines the available product modules for Langfuse, provides a Zod schema for them, and includes a utility function to determine which modules should be visible in the UI based on environment variable configurations.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/ui-customization/useUiCustomization.ts",
            "description": "This file defines a React hook, `useUiCustomization`, which fetches UI customization data from an API. The data is only fetched and returned if the user has the `self-host-ui-customization` entitlement.",
            "spof": true
          },
          {
            "path": "web/src/components/projectNavigation.tsx",
            "description": "This file defines a React component (`ProjectNavigation`) that provides a dropdown menu for users to select and switch between different projects. It uses Next.js routing to navigate to the selected project's page.",
            "spof": true
          },
          {
            "path": "web/src/components/SettingsDangerZone.tsx",
            "description": "This file defines a React component named `SettingsDangerZone` that displays a list of sensitive or irreversible actions within a settings interface. Each item in the 'danger zone' includes a title, a description, and an associated button for execution.",
            "spof": true
          },
          {
            "path": "web/src/components/nav/app-sidebar.tsx",
            "description": "This file defines the main application sidebar component (`AppSidebar`) for the Langfuse web application. It includes primary and secondary navigation, user-specific controls, and a demo project badge.",
            "spof": false
          },
          {
            "path": "web/src/components/nav/nav-user.tsx",
            "description": "This file defines the `NavUser` React component, which displays the current user's avatar, name, and email, and provides a dropdown menu for user-specific navigation actions or settings.",
            "spof": true
          },
          {
            "path": "web/src/components/nav/nav-main.tsx",
            "description": "This file defines and renders the main navigation component for the application. It structures navigation items into ungrouped and grouped sections, allowing for organized display within a sidebar.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/avatar.tsx",
            "description": "This file defines reusable React components for displaying avatars, including an avatar root, image, and fallback, built upon Radix UI primitives and styled with Tailwind CSS.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/users-ui-table.servertest.ts",
            "description": "This file contains asynchronous server-side tests for the `getUserMetrics` function. It verifies that the function accurately calculates and returns user-specific metrics (e.g., usage, cost, observation/trace counts) based on simulated trace and observation data, including filtering by timestamp.",
            "spof": true
          },
          {
            "path": "web/src/pages/account/settings/index.tsx",
            "description": "This file defines and renders the main user account settings page, including functionalities for updating display name, changing password, and deleting the account.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/models.tsx",
            "description": "This file serves as a temporary redirect for the project models page, immediately forwarding users to the project's settings models page. It ensures old links or direct access to this path are rerouted to the correct, updated location.",
            "spof": false
          },
          {
            "path": "web/src/hooks/useProjectIdFromURL.ts",
            "description": "This custom hook extracts and returns the 'projectId' from the URL query parameters using Next.js router.",
            "spof": true
          },
          {
            "path": "web/src/features/command-k-menu/CommandMenu.tsx",
            "description": "This file implements the Command K menu (command palette) for the application. It allows users to quickly navigate to various sections like main navigation, projects, dashboards, and settings pages via keyboard shortcuts and search functionality.",
            "spof": true
          },
          {
            "path": "web/src/features/notifications/showVersionUpdateToast.tsx",
            "description": "This file defines a function to display a custom toast notification, informing users about a new Langfuse version and prompting them to refresh the page to apply updates.",
            "spof": true
          },
          {
            "path": "web/src/features/projects/components/HostNameProject.tsx",
            "description": "This component displays the configured hostname or base URL for connecting to Langfuse, dynamically generated from UI customizations and environment variables. It provides users with the correct address to interact with the application.",
            "spof": true
          },
          {
            "path": "web/src/features/organizations/hooks.ts",
            "description": "This file provides custom React hooks for managing the current organization context from the URL query and user session, and for determining the Langfuse cloud environment and region based on environment variables.",
            "spof": false
          },
          {
            "path": "web/types/global.d.ts",
            "description": "This TypeScript declaration file extends JSX types to include a custom 'stripe-pricing-table' web component, allowing it to be used within React components without type errors.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Aman Thakur",
            "percent": 39
          },
          {
            "name": "Michael Frhlich",
            "percent": 22
          },
          {
            "name": "marliessophie",
            "percent": 19
          }
        ]
      },
      "Role-Based Access Control (RBAC) & Membership": {
        "files": [
          {
            "path": "web/src/ee/features/admin-api/server/memberships.ts",
            "description": "This file provides server-side API handlers for managing organization memberships. It includes functions to retrieve, update/create, and delete user memberships within an organization.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/admin-api/server/projects/projectById/memberships/index.ts",
            "description": "This file defines API handlers for managing project memberships within a specific project and organization. It provides functionality to retrieve, create/update, and delete project member assignments.",
            "spof": true
          },
          {
            "path": "web/src/components/ActionButton.tsx",
            "description": "Provides a versatile button component that integrates loading states, access control (permissions, entitlements, limits), and optional linking capabilities with hover-card explanations for disabled states. It also includes PostHog analytics tracking for external link clicks.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/async/members-trpc.servertest.ts",
            "description": "This file contains integration tests for the `membersRouter` to verify that organization member and invitation limits are correctly enforced based on different subscription plans (e.g., hobby vs. core/team).",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/memberships-api.servertest.ts",
            "description": "This file contains asynchronous integration tests for the Project Memberships API endpoints. It verifies the functionality of retrieving, creating/updating, and deleting project memberships.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/projects/[projectId]/memberships/index.ts",
            "description": "This file defines a public API endpoint for managing (retrieving, updating, deleting) project memberships within a specific project. It includes authentication, authorization, and entitlement checks, requiring an organization-scoped API key and specific plan entitlements.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/organizations/memberships/index.ts",
            "description": "This file defines a public API endpoint for managing organization memberships, supporting GET, PUT, and DELETE methods. It includes authentication, authorization checks for organization-scoped API keys, and plan-based entitlement verification for admin-level operations.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/users.tsx",
            "description": "This file implements the users page for a project, displaying a table of users along with their activity metrics and offering an onboarding experience for new projects. It fetches user data and metrics, supporting both standard and beta API versions.",
            "spof": false
          },
          {
            "path": "web/src/hooks/useUserSearch.ts",
            "description": "This file defines a React hook (`useUserSearch`) that provides debounced user search functionality within a specific project, including access control and result pagination.",
            "spof": false
          },
          {
            "path": "web/src/server/utils/checkProjectMembershipOrAdmin.ts",
            "description": "This file defines a utility function to check if a user is either an administrator or a member of a given project.",
            "spof": false
          },
          {
            "path": "web/src/features/auth/lib/createProjectMembershipsOnSignup.ts",
            "description": "This file manages the creation of organization and project memberships for a new user upon signup, assigning default roles based on environment configurations (for cloud or self-hosted instances) and processing any pending membership invitations.",
            "spof": true
          },
          {
            "path": "web/src/features/feature-flags/components/FeatureFlagToggle.tsx",
            "description": "This file defines a React component, `FeatureFlagToggle`, that conditionally renders content based on the status of a given feature flag for the current user. It considers user roles (admin) and experimental feature access, along with specific flag whitelisting.",
            "spof": true
          },
          {
            "path": "web/src/features/feature-flags/hooks/useIsFeatureEnabled.ts",
            "description": "This file provides a React hook to determine if a specific feature flag is enabled for the current user, based on their session data, experimental features settings, and admin status.",
            "spof": false
          },
          {
            "path": "web/src/features/table/components/TableActionTargetOptions.tsx",
            "description": "This component dynamically renders a list of selectable options for a table action, fetching them based on the action's ID and user entitlements, then mapping the results to `SelectItem` components.",
            "spof": true
          },
          {
            "path": "web/src/features/organizations/components/AIFeatureSwitch.tsx",
            "description": "This component provides a UI to enable or disable AI features for an organization within the Langfuse Cloud, including access control checks and a confirmation dialog for the user.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/server/authorizeRequest.ts",
            "description": "This file defines a utility function (`authorizeRequestOrThrow`) that verifies user authentication and project membership/admin status. It ensures that the current user is authenticated and authorized for a specific project, throwing errors if not.",
            "spof": false
          },
          {
            "path": "web/src/features/rbac/constants/projectAccessRights.ts",
            "description": "This file defines all possible project-level access rights (scopes) and maps these scopes to different project roles (e.g., OWNER, ADMIN, MEMBER, VIEWER) to manage access control within a project.",
            "spof": false
          },
          {
            "path": "web/src/features/rbac/constants/orderedRoles.ts",
            "description": "This file defines a numerical order for different user roles within the application, mapping each role to an integer to represent its hierarchy or precedence.",
            "spof": true
          },
          {
            "path": "web/src/features/rbac/constants/organizationAccessRights.ts",
            "description": "This file defines the available organization-level access scopes and maps them to specific roles within an organization. It establishes the permissions associated with each organization role (e.g., OWNER, ADMIN, MEMBER) for Langfuse's Role-Based Access Control (RBAC) system.",
            "spof": false
          },
          {
            "path": "web/src/features/rbac/components/MembershipInvitesPage.tsx",
            "description": "This React component displays and manages membership invitations for a given organization or project, allowing users with appropriate permissions to view and cancel invites.",
            "spof": true
          },
          {
            "path": "web/src/features/rbac/components/CreateProjectMemberButton.tsx",
            "description": "This component provides a button and a dialog for inviting new members to an organization or a specific project, allowing the assignment of roles based on access permissions and entitlements.",
            "spof": false
          },
          {
            "path": "web/src/features/rbac/components/MembersTable.tsx",
            "description": "This file defines the `MembersTable` component, which displays a data table of members for an organization or a specific project. It includes functionality for viewing member details, managing their roles (organization and project-specific), and deleting memberships, all subject to user access permissions.",
            "spof": false
          },
          {
            "path": "web/src/features/rbac/components/RoleSelectItem.tsx",
            "description": "This file defines a React component (`RoleSelectItem`) used in role selection dropdowns. It displays a role and, on hover, provides a detailed breakdown of the access rights associated with that role, distinguishing between inherited and new permissions for both organization and project scopes.",
            "spof": true
          },
          {
            "path": "web/src/features/rbac/utils/checkProjectAccess.ts",
            "description": "This file provides utilities for checking a user's project-specific access rights (RBAC) based on their role and a required scope. It includes functions for server-side validation (TRPC resolvers) and client-side access control (React hook).",
            "spof": true
          },
          {
            "path": "web/src/features/rbac/utils/checkOrganizationAccess.ts",
            "description": "This file provides utility functions and a React hook for checking a user's organization-specific access rights based on their role and defined access scopes, suitable for both server-side (TRPC) and client-side (React) usage.",
            "spof": true
          },
          {
            "path": "web/src/features/rbac/server",
            "description": "This directory is designated for server-side implementations of Role-Based Access Control (RBAC) features within the web application. It would typically contain backend logic for managing user roles, permissions, and access policies.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/auth/userProjectRoleAuth.ts",
            "description": "This file provides utilities for resolving and retrieving user roles within a specific project, considering both explicit project memberships and inherited organization roles. It generates SQL queries to fetch users along with their resolved project roles and counts.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/services/email/organizationInvitation/MembershipInvitationEmailTemplate.tsx",
            "description": "This file defines a React component for an email template used to invite users to join an organization on the Langfuse platform. It renders the email content with details about the inviter, organization, and an invitation link.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/services/email/organizationInvitation/sendMembershipInvitationEmail.ts",
            "description": "This file provides a function to send an email invitation to a user, inviting them to join an organization on Langfuse. It dynamically generates the invitation link based on whether the user already has an account and uses environment variables for email configuration.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230717190411_users_feature_flags",
            "description": "This directory contains a specific Prisma database migration script. It is responsible for schema changes related to user management and feature flags, implemented on July 17, 2023.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231129013314_invites",
            "description": "This directory contains a specific Prisma database migration script, identified by its timestamp 20231129013314 and name 'invites'. Its role is to define the schema changes required for implementing or updating the 'invites' functionality within the shared database. It is part of the automated database version control system.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231014131841_users_add_admin_flag",
            "description": "This directory contains a specific Prisma database migration. Its role is to define and apply the schema change that adds an 'admin' flag to the users table. This ensures the database schema evolves correctly for the shared components.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230711110517_memberships_add_userid_index",
            "description": "This directory contains a specific Prisma database migration for the shared package of the `langfuse` repository. Its role is to implement the `20230711110517_memberships_add_userid_index` migration. This migration is responsible for adding an index to the `memberships` table, likely on the `userId` column, to optimize database performance.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230814184705_add_viewer_membership_role",
            "description": "This directory represents a specific Prisma database migration. Its role is to define and apply schema changes, specifically adding a 'viewer' role to the membership functionality within the shared database schema. It ensures database evolution and consistency for the 'langfuse' project.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Steffen Schmitz",
            "percent": 48
          },
          {
            "name": "Marc Klingen",
            "percent": 17
          },
          {
            "name": "Nimar",
            "percent": 11
          }
        ]
      },
      "API Key & Access Token Management": {
        "files": [
          {
            "path": "web/src/ee/features/admin-api/server/adminApiAuth.ts",
            "description": "This file provides an `AdminApiAuthService` for authenticating admin API requests by verifying a bearer token against a pre-configured `ADMIN_API_KEY`. It includes logic to restrict access on Langfuse Cloud and offers a utility function (`handleAdminAuth`) for use in Next.js API routes.",
            "spof": false
          },
          {
            "path": "web/src/ee/features/admin-api/server/organizations/apiKeys/apiKeyById.ts",
            "description": "This file defines the API endpoint logic for deleting an API key by its ID within a specific organization, including input validation and audit logging. It serves as an administrative API for API key management.",
            "spof": false
          },
          {
            "path": "web/src/ee/features/admin-api/server/organizations/apiKeys/index.ts",
            "description": "This file provides server-side API handlers for managing API keys within an organization. It includes functions to validate requests, retrieve existing API keys, and create new API keys for a specified organization.",
            "spof": false
          },
          {
            "path": "web/src/ee/features/admin-api/server/projects/projectById/apiKeys/index.ts",
            "description": "This file defines API handlers for managing project-level API keys. It includes functions to retrieve existing API keys and to create new API keys for a specified project.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/admin-api/server/projects/projectById/apiKeys/apiKeyById.ts",
            "description": "This file defines the API endpoint logic for deleting a specific project-scoped API key. It includes validation of query parameters, the deletion process using the ApiAuthService, and logging of the action in audit logs.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/api-auth.servertest.ts",
            "description": "This file contains integration tests for the API authentication service, verifying how API keys are created, validated, and managed, including scenarios with and without Redis caching, and handling organization-specific settings like cloud configurations and rate limits.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/admin-api-key-auth.servertest.ts",
            "description": "This file contains integration tests for the API authentication mechanism, covering both standard basic authentication with API keys and special admin API key authentication flows. It verifies correct authentication, handles various failure scenarios, and ensures proper fallback behavior.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/organizations-api-key-trpc.servertest.ts",
            "description": "This file contains asynchronous server-side tests for the organization API key TRPC procedures. It verifies access control for fetching, creating, updating, and deleting API keys based on user roles (owner, member, unauthenticated).",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/projects/[projectId]/apiKeys/[apiKeyId].ts",
            "description": "This API route handles the deletion of a specific API key within a project. It enforces organization-scoped API keys, admin-api entitlement, and verifies project and API key existence before proceeding with the deletion.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/projects/[projectId]/apiKeys/index.ts",
            "description": "This Next.js API route handles the management of API keys for a specific project, allowing retrieval (GET) and creation (POST) of API keys after performing authentication, organization-level authorization, and plan-based entitlement checks.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/organizations/apiKeys/index.ts",
            "description": "This API endpoint handles GET requests to retrieve API keys for a specific organization. It requires an organization-scoped API key and an 'admin-api' entitlement for access.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/admin/organizations/[organizationId]/apiKeys/[apiKeyId].ts",
            "description": "This API route handles the deletion of a specific API key for a given organization by an administrator, including authentication and entitlement checks.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/admin/organizations/[organizationId]/apiKeys/index.ts",
            "description": "This file defines an admin API endpoint for managing API keys within a specific organization. It handles requests to retrieve existing API keys and create new ones for the given organization, requiring admin authentication and specific entitlements.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/admin/api-keys/index.ts",
            "description": "This file defines an admin API endpoint for managing API keys. It allows Langfuse Cloud to delete or invalidate API keys for specified projects from both the database and cache.",
            "spof": false
          },
          {
            "path": "web/src/server/api/trpc.ts",
            "description": "This file sets up the tRPC server, defining the API context, initializing tRPC, and creating various reusable procedures with common middlewares for authentication, error handling, and OpenTelemetry tracing.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/README.md",
            "description": "This file describes the caching strategy for API keys in Langfuse, detailing how they are managed in Redis for creation, reading, and updates, including the cache structure and TTL management.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/components/ApiKeyList.tsx",
            "description": "This file defines a React component `ApiKeyList` that displays and manages API keys for a given project or organization. It allows users to view, create, edit the note of, and delete API keys based on their access permissions.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/components/CreateApiKeyButton.tsx",
            "description": "This file defines a React component for creating new API keys (project or organization scope) through a modal dialog. It handles the creation process, displays the generated secret and public keys, and provides a corresponding .env configuration example.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/server/apiAuth.ts",
            "description": "This file defines the ApiAuthService class, which handles API key authentication and management for the public API. It verifies API keys, manages caching in Redis, interacts with the database (Prisma), and supports both Basic and Bearer authentication schemes.",
            "spof": false
          },
          {
            "path": "web/src/features/background-migrations/components/retry-background-migration.tsx",
            "description": "This file defines a React component that provides a user interface to retry a failed background migration. It includes a popover for user interaction, an input for an Admin API key for authentication, and handles the API call to re-schedule the migration.",
            "spof": true
          },
          {
            "path": ".claude/skills/backend-dev-guidelines/resources/middleware-guide.md",
            "description": "This document serves as a comprehensive guide to middleware patterns within Langfuse's Next.js and tRPC architecture. It details various tRPC middlewares for authentication, authorization, error handling, and OpenTelemetry, as well as public API middleware patterns for similar functionalities.",
            "spof": true
          },
          {
            "path": "packages/shared/src/interfaces/rate-limits.ts",
            "description": "This file defines types and Zod schemas for rate limiting, including the various resources that can be rate-limited, the configuration for rate limits, and the structure of a rate limit check result.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/auth/invalidateApiKeys.ts",
            "description": "This file provides utility functions to invalidate cached API keys in Redis. It supports invalidating specific keys, all keys associated with an organization, or all keys for a particular project.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/auth/apiKeys.ts",
            "description": "This file provides utility functions for generating, hashing, verifying, and managing API keys, including securely storing them in a database with different hashing mechanisms and display formats.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/auth/types.ts",
            "description": "This file defines Zod schemas and TypeScript types for API keys, authentication verification results, and access scopes. It provides structured definitions for handling API key data and determining access levels within the application.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230907225604_api_keys_publishable_to_public",
            "description": "This directory contains a specific database migration script for the Langfuse project. It is responsible for altering the API keys schema, specifically changing a field from 'publishable' to 'public'.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230720164603_migrate_tokens",
            "description": "This directory represents a specific Prisma database migration within the shared package, executed on 2023-07-20 at 16:46:03 UTC. Its purpose is to apply schema changes related to 'tokens' as part of the application's database evolution. It contains the necessary SQL or other migration files for this particular change.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231019094815_add_additional_secret_key_column",
            "description": "This directory is a placeholder for a specific Prisma database migration named \"add_additional_secret_key_column\", identified by its timestamp. It is intended to house the schema changes required to add an additional secret key column to the database.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Max Deichmann",
            "percent": 38
          },
          {
            "name": "Steffen Schmitz",
            "percent": 32
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 8
          }
        ]
      },
      "Organization & Project Administration": {
        "files": [
          {
            "path": "web/src/ee/features/admin-api/server/projects.ts",
            "description": "This file defines the API handler for retrieving all projects within a given organization for the administrative interface.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/admin-api/server/organizations/index.ts",
            "description": "This file contains Next.js API route handlers for administrative management of organizations. It provides functionality to retrieve all organizations and to create new organizations, including associated project data and audit logging.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/admin-api/server/organizations/organizationById.ts",
            "description": "This file contains API handlers for an admin interface, enabling the retrieval, update, and deletion of organizations by ID, including associated project management and audit logging.",
            "spof": false
          },
          {
            "path": "web/src/ee/features/admin-api/server/projects/createProject.ts",
            "description": "This file defines an API handler to create a new project, including validation of project name, retention days, and metadata, as well as checking for necessary entitlements and ensuring uniqueness within an organization.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/admin-api/server/projects/projectById/index.ts",
            "description": "This file provides server-side logic for handling API requests to update and delete projects within an admin context. It includes validation, entitlement checks, database operations, and queuing of asynchronous deletion tasks.",
            "spof": false
          },
          {
            "path": "web/src/components/deleteButton.tsx",
            "description": "This file defines a reusable DeleteButton component and several specialized versions for deleting different entities (e.g., traces, datasets, dashboards). It handles confirmation prompts, access checks, API calls, and analytics for delete operations.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/async/organizations-api.servertest.ts",
            "description": "This file contains integration tests for the administrative organizations API, covering operations like creating, retrieving, and managing organizations using various HTTP methods.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/projects-api.servertest.ts",
            "description": "This file contains asynchronous integration tests for the projects API endpoints, covering operations like retrieving and creating projects, along with authentication and validation checks.",
            "spof": true
          },
          {
            "path": "web/src/pages/background-migrations.tsx",
            "description": "This file defines the page component for displaying background migrations. It renders the `BackgroundMigrationsTable` component.",
            "spof": true
          },
          {
            "path": "web/src/pages/index.tsx",
            "description": "This file defines the home page of the web application. It renders the `OrganizationProjectOverview` component, serving as the main entry point to display an overview of an organization's projects.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/projects/index.ts",
            "description": "This Next.js API route handles public API requests for projects, allowing authenticated users to retrieve details for a specific project via GET requests or create new projects within an organization via POST requests, subject to entitlement checks.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/projects/[projectId]/index.ts",
            "description": "This file defines a public API route for managing (updating or deleting) a specific project by its ID. It handles authentication, authorization via organization-scoped API keys and entitlements, and dispatches to dedicated handlers for PUT (update) and DELETE operations.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/organizations/projects/index.ts",
            "description": "This file defines a public API endpoint for retrieving projects associated with a specific organization. It handles GET requests, authenticates the API key, ensures it's an organization-scoped key, verifies 'admin-api' entitlement, and then fetches the projects.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/admin/organizations/index.ts",
            "description": "This Next.js API route handles administrative operations for organizations, specifically allowing authenticated administrators to retrieve a list of all organizations (GET) or create new ones (POST), provided the instance's plan includes the 'admin-api' entitlement.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/admin/organizations/[organizationId]/index.ts",
            "description": "This API route provides administrative endpoints for managing a specific organization (retrieve, update, delete) based on its ID. It includes authentication, authorization checks, and is designed for self-hosted Langfuse instances.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/settings/index.tsx",
            "description": "This file defines the project settings page, providing a comprehensive interface for managing various configurations and features related to a specific project. It organizes settings into categories such as general, API keys, members, and integrations.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/settings/[page].tsx",
            "description": "This file defines a dynamic route for specific project settings sub-pages, re-exporting the main settings page component.",
            "spof": true
          },
          {
            "path": "web/src/pages/organization/[organizationId]/index.tsx",
            "description": "This file serves as the main entry point for the organization's project overview page, re-exporting the `OrganizationProjectOverview` component.",
            "spof": true
          },
          {
            "path": "web/src/pages/organization/[organizationId]/settings/[page].tsx",
            "description": "This file acts as a dynamic route handler for organization-specific settings pages. It re-exports the main OrgSettingsPage component, suggesting it manages sub-routes or specific sections within the organization settings.",
            "spof": true
          },
          {
            "path": "web/src/pages/organization/[organizationId]/settings/index.tsx",
            "description": "This file defines and renders the main organization settings page, presenting various configurable sections such as general information, members, API keys, billing, and SSO, with dynamic visibility based on user entitlements and platform features. It uses a paged container to organize these settings.",
            "spof": false
          },
          {
            "path": "web/src/features/auth/lib/projectNameSchema.ts",
            "description": "Defines a Zod schema for validating project names, ensuring they are strings without HTML, between 3 and 60 characters long.",
            "spof": true
          },
          {
            "path": "web/src/features/auth/lib/projectRetentionSchema.ts",
            "description": "Defines a Zod schema for validating project retention settings. It ensures that the retention period, which is an integer, is either 0 or at least 3 days.",
            "spof": true
          },
          {
            "path": "web/src/features/projects/hooks.ts",
            "description": "This file provides custom React hooks for fetching and managing project and organization data based on router parameters or explicit IDs, leveraging user session information.",
            "spof": true
          },
          {
            "path": "web/src/features/projects/server",
            "description": "This directory is intended to house server-side code and logic specifically for the 'projects' feature within the Langfuse web application. It likely contains API endpoints, data fetching, or business logic executed on the server, serving the 'projects' frontend components.",
            "spof": false
          },
          {
            "path": "web/src/features/projects/components/RenameProject.tsx",
            "description": "This file defines a React component that provides a user interface for renaming a project, including form validation, API interaction, and access control checks.",
            "spof": false
          },
          {
            "path": "web/src/features/projects/components/ConfigureRetention.tsx",
            "description": "This file provides a UI component to configure data retention settings for a project. It allows users to set or update the number of days data should be retained, with options for indefinite retention, and handles form submission and access control.",
            "spof": true
          },
          {
            "path": "web/src/features/projects/components/DeleteProjectButton.tsx",
            "description": "This file defines a React component that provides a button and a dialog for securely deleting a project. It includes a confirmation step requiring the user to type the project's name, access control checks, and integrates with an API to perform the deletion.",
            "spof": false
          },
          {
            "path": "web/src/features/projects/components/NewProjectForm.tsx",
            "description": "This React component provides a form for users to create a new project within a specified organization, handling input validation, API submission, and navigation upon successful project creation.",
            "spof": true
          },
          {
            "path": "web/src/features/projects/components/TransferProjectButton.tsx",
            "description": "This file defines a React component, `TransferProjectButton`, which provides functionality for a user to transfer an existing project to a different organization within the application, including access checks, a confirmation step, and displaying relevant warnings.",
            "spof": false
          },
          {
            "path": "web/src/features/table/components/TableActionDialog.tsx",
            "description": "This file defines a reusable dialog component for confirming and executing batch actions (like create or delete) on a table within a project, including access checks, form handling, and progress indication.",
            "spof": true
          },
          {
            "path": "web/src/features/organizations/utils/organizationNameSchema.ts",
            "description": "This file defines Zod schemas for validating organization-related data, including organization names, types, and sizes, used for both server-side and client-side form validation.",
            "spof": false
          },
          {
            "path": "web/src/features/organizations/components/DeleteOrganizationButton.tsx",
            "description": "This file defines a React component that provides a button and a confirmation dialog for deleting an organization, including access checks, validation, and post-deletion actions like redirection and analytics.",
            "spof": false
          },
          {
            "path": "web/src/features/organizations/components/RenameOrganization.tsx",
            "description": "This file defines a React component that provides a form for users to rename their organization, handling form submission, validation, and access control.",
            "spof": true
          },
          {
            "path": "web/src/features/organizations/components/ProjectOverview.tsx",
            "description": "This file defines a React component that displays an overview of a user's organizations and their projects in the Langfuse application, supporting multi-organization views, single-organization detail, search, and access-controlled actions like creating new projects or organizations.",
            "spof": false
          },
          {
            "path": "web/src/features/organizations/server",
            "description": "This directory is designated for server-side logic and API endpoints specifically supporting the 'organizations' feature of the web application. It would typically contain code for handling data persistence, business rules, and integration with backend services related to organizational management.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/batchProjectCleaner.test.ts",
            "description": "This file contains unit tests for the `BatchProjectCleaner` worker component. It verifies that the cleaner correctly identifies and deletes data associated with soft-deleted projects from ClickHouse, while ensuring Redis locking mechanisms function as expected.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/projectDeletionProcessing.test.ts",
            "description": "This file contains unit tests for the project deletion processing job, verifying that all associated data across various storage systems (Postgres, ClickHouse, S3) is correctly removed when a project is deleted.",
            "spof": true
          },
          {
            "path": "worker/src/queues/projectDelete.ts",
            "description": "This file defines a BullMQ processor responsible for completely deleting a project. It orchestrates the removal of all associated data from S3, ClickHouse, and PostgreSQL databases.",
            "spof": false
          },
          {
            "path": "worker/src/features/batch-project-cleaner/index.ts",
            "description": "This file implements the `BatchProjectCleaner` service, which periodically deletes data associated with soft-deleted projects from ClickHouse tables. It uses distributed locking to coordinate deletion across multiple instances for data consistency.",
            "spof": true
          },
          {
            "path": "packages/shared/src/interfaces/parseDbOrg.ts",
            "description": "This file defines a utility function to safely parse and validate the 'cloudConfig' field of a Prisma 'Organization' object using a Zod schema, returning a strongly typed 'ParsedOrganization' object.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/projectDelete.ts",
            "description": "This file defines a singleton class, `ProjectDeleteQueue`, responsible for creating and managing a BullMQ queue specifically for handling project deletion jobs. It sets up the Redis connection and default job options for these deletion tasks.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/test-utils/org-factory.ts",
            "description": "This file provides utility functions for creating test data related to organizations, projects, and API keys, typically used in test environments to set up a database with predefined entities.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/seed-postgres.ts",
            "description": "This script seeds a PostgreSQL database with initial data for development, demonstration, and testing purposes, including users, organizations, projects, API keys, prompts, datasets, evaluation configurations, and other application-specific entities for the Langfuse platform.",
            "spof": true
          },
          {
            "path": "packages/shared/prisma/migrations/20230810191453_project_id_not_null",
            "description": "This directory contains a specific Prisma database migration script within the `shared` package. Its purpose is to apply a schema change, likely ensuring that the `project_id` field is non-nullable in the database.",
            "spof": false
          },
          {
            "path": "fern/apis/organizations/definition",
            "description": "This directory contains the API definition for the 'organizations' resource within the Langfuse project's Fern API. It likely defines the data structures, endpoints, and operations related to managing organizations.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Valery Meleshkin",
            "percent": 32
          },
          {
            "name": "Steffen Schmitz",
            "percent": 31
          },
          {
            "name": "marliessophie",
            "percent": 19
          }
        ]
      },
      "In-App User Support": {
        "files": [
          {
            "path": "web/src/components/nav/support-button.tsx",
            "description": "This file defines the `SupportButton` component, which provides a UI element in the sidebar to open a support chat or drawer. It handles mobile responsiveness by closing the sidebar when the support drawer is opened.",
            "spof": true
          },
          {
            "path": "web/src/features/support-chat/SuccessSection.tsx",
            "description": "This component displays a success message after a support chat message has been sent, confirming a ticket has been created and offering an option to submit another message. It is part of the support chat feature.",
            "spof": true
          },
          {
            "path": "web/src/features/support-chat/SupportDrawerProvider.tsx",
            "description": "This file provides a React Context API for managing the open/close state of a support chat drawer, allowing it to be controlled from any component within the application.",
            "spof": true
          },
          {
            "path": "web/src/features/support-chat/createSupportEmailHash.ts",
            "description": "This file provides a function to generate an HMAC-SHA256 hash of an email address using a secret key, primarily for secure identification or authentication in support-related features.",
            "spof": true
          },
          {
            "path": "web/src/features/support-chat/SupportDrawer.tsx",
            "description": "This file defines the `SupportDrawer` React component, which implements a multi-step support contact interface. It orchestrates the display of an introduction, a support form, and a success message within a drawer UI, allowing users to submit support requests.",
            "spof": true
          },
          {
            "path": "web/src/features/support-chat/SupportFormSection.tsx",
            "description": "This file implements the `SupportFormSection` React component, which provides a user interface for submitting support requests. It handles form validation, file attachments (including pre-signed S3 uploads), and integrates with an internal API to create support threads.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 98
          },
          {
            "name": "Marc Klingen",
            "percent": 2
          },
          {
            "name": "Nimar",
            "percent": 0
          }
        ]
      },
      "User Authentication & Identity": {
        "files": [
          {
            "path": "web/src/__e2e__/auth.spec.ts",
            "description": "This file contains end-to-end (e2e) tests for the authentication system, covering user sign-in, sign-up, input validation, and redirection logic based on authentication status and target paths.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/mcp-auth.servertest.ts",
            "description": "This file contains server-side Jest tests for the Multi-Client Protocol (MCP) authentication endpoint of the Langfuse web application. It verifies that the endpoint returns correct HTTP status codes (401 for invalid/missing credentials, 200 for valid credentials) for authentication attempts.",
            "spof": true
          },
          {
            "path": "web/src/pages/auth/reset-password.tsx",
            "description": "This file defines the password reset page, which renders the ResetPasswordPage component. It uses `getServerSideProps` to check if password reset functionality is available based on environment variables for SMTP and email configuration.",
            "spof": true
          },
          {
            "path": "web/src/pages/auth/error.tsx",
            "description": "This file defines a Next.js page component for displaying authentication errors. It extracts error messages from the URL query parameters or provides a default message.",
            "spof": false
          },
          {
            "path": "web/src/pages/auth/hf-spaces.tsx",
            "description": "This file renders a page instructing users to open the Langfuse application in a new tab when deployed on HuggingFace Spaces, which is necessary for proper session cookie access. It dynamically generates the link to the deployment domain.",
            "spof": true
          },
          {
            "path": "web/src/pages/auth/sign-up.tsx",
            "description": "This file implements the user sign-up page for the Langfuse application, featuring a two-step process to first check for enterprise SSO based on the provided email domain, and then allow for credentials-based sign-up if SSO is not configured.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/auth/signup.ts",
            "description": "This file serves as the API endpoint handler for user signup functionality. It imports and re-exports the `signupApiHandler` to process new user registrations.",
            "spof": true
          },
          {
            "path": "web/src/features/auth/hooks.ts",
            "description": "This file provides a React hook to check if the current user is authenticated and is a member of a specified project. It leverages NextAuth.js for session management and user organization/project data.",
            "spof": true
          },
          {
            "path": "web/src/features/auth/lib/signupSchema.ts",
            "description": "This file defines Zod validation schemas for user signup, including specific rules for name, email, and password fields, used for input validation in the web application's authentication features.",
            "spof": false
          },
          {
            "path": "web/src/features/auth/components/AuthCloudRegionSwitch.tsx",
            "description": "This file defines a React component that allows users to select and switch between different Langfuse cloud data regions, providing information about each region and handling the redirection to the corresponding hostname.",
            "spof": false
          },
          {
            "path": "web/src/features/auth/components/AuthCloudPrivacyNotice.tsx",
            "description": "This file defines a React component named `CloudPrivacyNotice` that displays a legal notice with links to Terms and Conditions, Privacy Policy, and Cookie Policy. It is conditionally rendered during authentication actions specifically for cloud deployments of the application.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/types.ts",
            "description": "This file defines the `ServerContext` interface and other type definitions for the Langfuse Model Context Protocol (MCP) server implementation. It outlines the structure of authenticated request contexts, including security and compliance considerations.",
            "spof": true
          },
          {
            "path": "web/src/features/auth-credentials/lib/credentialsUtils.ts",
            "description": "Provides utility functions for checking email verification status, specifically if an email was verified within a recent cutoff period.",
            "spof": true
          },
          {
            "path": "web/src/features/auth-credentials/lib/credentialsServerUtils.ts",
            "description": "This file provides server-side utilities for managing user authentication credentials, including creating and updating user accounts with email and password, hashing passwords, and verifying credentials.",
            "spof": false
          },
          {
            "path": "web/src/features/auth-credentials/server/signupApiHandler.ts",
            "description": "This file defines an API handler for user sign-up via email and password. It performs validation, checks for disabled sign-up methods, enforces SSO for specific domains, creates the user, and optionally triggers a webhook.",
            "spof": false
          },
          {
            "path": "web/src/features/auth-credentials/components/ResetPasswordButton.tsx",
            "description": "This file provides a React component for requesting a password reset email and then verifying the received one-time passcode to initiate the password reset process.",
            "spof": true
          },
          {
            "path": "web/src/features/auth-credentials/components/ResetPasswordPage.tsx",
            "description": "This file defines the ResetPasswordPage component, which provides a user interface for authenticated users to reset their password or for unauthenticated users to request a password reset email.",
            "spof": false
          },
          {
            "path": "web/types/next-auth.d.ts",
            "description": "This file extends NextAuth.js types (Session and User) to include custom properties such as user roles, organization details, feature flags, and environment variables, ensuring type safety across the application. It defines the structure of the authentication session and user object within the Langfuse ecosystem.",
            "spof": false
          },
          {
            "path": "packages/shared/src/errors/UnauthorizedError.ts",
            "description": "This file defines the `UnauthorizedError` class, which extends `BaseError` and represents an HTTP 401 Unauthorized status, used for handling unauthorized access attempts.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/services/email/passwordReset/sendResetPasswordVerificationRequest.tsx",
            "description": "This file defines a React component for a password reset email template and an asynchronous function to send this password reset verification email using Nodemailer, typically integrated with NextAuth.js's email provider.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/utils/formatAuthProvider.ts",
            "description": "This file provides a utility function to format authentication provider IDs into user-friendly display names, handling both standard OAuth providers and multi-tenant Enterprise SSO configurations securely by stripping domain information.",
            "spof": true
          },
          {
            "path": "packages/shared/src/tableDefinitions/usersTable.ts",
            "description": "This file defines the column structure for a 'users' table. It specifies properties like name, ID, type, and internal database mapping for user-related data.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230530204241_auth_api_ui",
            "description": "This directory represents a specific database migration script within the `shared` package's Prisma setup. It contains the schema changes applied on '20230530204241' related to authentication API and UI features, ensuring database compatibility with those functionalities.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230720172051_tokens_non_null",
            "description": "This directory contains a specific Prisma database migration script. Its purpose is to alter the database schema, specifically making the 'tokens' field non-nullable, as indicated by the timestamped name '20230720172051_tokens_non_null'.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230707133415_user_add_email_index",
            "description": "This directory represents a specific Prisma database migration. Its purpose is to add an index to the 'email' column of the 'user' table, likely for performance optimization in querying user records by email.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230529140133_user_add_pw",
            "description": "This directory contains a specific Prisma database migration named `user_add_pw`, applied on May 29, 2023. It defines the schema changes to add a password field for users within the shared package's database.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230720162550_tokens",
            "description": "This directory represents a specific database migration within the `shared` package, managed by Prisma. It is timestamped 20230720162550 and likely contains schema changes or modifications related to 'tokens'.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231021182825_user_emails_all_lowercase",
            "description": "This directory contains a specific Prisma database migration. Its purpose is to ensure all user email addresses stored in the database are converted to lowercase, standardizing email formats. The timestamped name indicates its unique identifier and position within the migration history.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Marc Klingen",
            "percent": 53
          },
          {
            "name": "Michael Frhlich",
            "percent": 24
          },
          {
            "name": "Nimar",
            "percent": 11
          }
        ]
      },
      "User Onboarding & Setup Flow": {
        "files": [
          {
            "path": "web/src/__e2e__/create-project.spec.ts",
            "description": "This file contains end-to-end (e2e) tests using Playwright, verifying the user flow for signing in, creating an organization, creating a project, and navigating to various project-related pages within the application.",
            "spof": false
          },
          {
            "path": "web/src/initialize.ts",
            "description": "Initializes a Langfuse instance by provisioning an organization, project, API keys, and a user based on environment variables, handling creation, updates, and partial configuration warnings.",
            "spof": true
          },
          {
            "path": "web/src/pages/setup.tsx",
            "description": "This file defines the setup page component, re-exporting the main SetupPage component from the features directory to serve as the page entry point.",
            "spof": true
          },
          {
            "path": "web/src/pages/onboarding.tsx",
            "description": "This file defines the Onboarding page for Langfuse, which renders an onboarding survey component for cloud users.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/setup.tsx",
            "description": "This file defines the project setup page, re-exporting the `SetupPage` component from the features directory. It serves as the entry point for the project-specific setup interface.",
            "spof": true
          },
          {
            "path": "web/src/pages/organization/[organizationId]/setup.tsx",
            "description": "This file defines the setup page for a specific organization, re-exporting the `SetupPage` component from the `setup` feature module. It serves as the entry point for organization setup within the web application.",
            "spof": true
          },
          {
            "path": "web/src/features/organizations/components/NewOrganizationForm.tsx",
            "description": "This file defines a React component (`NewOrganizationForm`) that provides a user interface for creating a new organization. It handles form submission, interacts with an API to create the organization, and optionally captures survey data, updating the user session upon successful creation.",
            "spof": true
          },
          {
            "path": "web/src/features/onboarding/lib/questions.ts",
            "description": "This file defines the questions and structure for an onboarding survey within the application. It exports an array of survey questions and the total number of steps based on these questions.",
            "spof": true
          },
          {
            "path": "web/src/features/onboarding/lib/surveyTypes.ts",
            "description": "Defines TypeScript types and interfaces for an onboarding survey feature, including question structures (radio, text), survey state, form data, and component props. It provides the building blocks for managing and rendering survey steps and questions.",
            "spof": true
          },
          {
            "path": "web/src/features/onboarding/lib/surveyReducer.ts",
            "description": "This file defines a reducer and initial state for managing the step-by-step navigation and state transitions within a survey feature. It handles actions to move forward, backward, or directly to specific steps of the survey.",
            "spof": true
          },
          {
            "path": "web/src/features/onboarding/components/SurveyProgress.tsx",
            "description": "This file defines a React component named `SurveyProgress` which visually indicates the user's progress through a multi-step survey or onboarding flow. It displays a series of progress bars, highlighting the steps completed so far.",
            "spof": true
          },
          {
            "path": "web/src/features/onboarding/components/SurveyStep.tsx",
            "description": "This file defines a React component, SurveyStep, responsible for rendering a single question step within an onboarding survey. It dynamically displays radio button groups or text input fields based on the question type and integrates with react-hook-form for state management, including an optional auto-advance feature.",
            "spof": true
          },
          {
            "path": "web/src/features/onboarding/components/OnboardingSurvey.tsx",
            "description": "This file defines the `OnboardingSurvey` React component, which renders a multi-step onboarding survey for users. It manages survey state, navigates between questions, handles user input, and submits the survey data upon completion.",
            "spof": true
          },
          {
            "path": "web/src/features/onboarding/hooks/useSurveyForm.ts",
            "description": "This file defines a React hook (`useSurveyForm`) that manages the state, logic, and submission for a multi-step onboarding survey, handling form input, step navigation, conditional question skipping, and API integration.",
            "spof": true
          },
          {
            "path": "web/src/features/setup/components/SetupPage.tsx",
            "description": "This file defines the `SetupPage` component, which orchestrates a multi-step onboarding process for new users. It guides them through creating an organization, inviting members, and finally creating their first project.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Leo Weigand",
            "percent": 46
          },
          {
            "name": "Marc Klingen",
            "percent": 24
          },
          {
            "name": "Max Deichmann",
            "percent": 10
          }
        ]
      },
      "LLM Provider Key Management": {
        "files": [
          {
            "path": "web/src/__tests__/llm-api-key.servertest.ts",
            "description": "This file contains integration tests for the LLM API key management functionality, specifically testing the create, retrieve, and update operations for LLM API keys within a project using TRPC and Prisma.",
            "spof": true
          },
          {
            "path": "web/src/features/llm-api-key/types.ts",
            "description": "This file defines Zod schemas for validating and structuring data related to Large Language Model (LLM) API keys, including schemas for creating, updating, and defining the API key configuration.",
            "spof": false
          },
          {
            "path": "web/src/features/llm-api-key/server",
            "description": "This directory is intended to house server-side logic and API endpoints specifically for managing LLM API keys within the web application. It would handle operations such as storing, retrieving, validating, or securing these keys.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/components/LLMApiKeyList.tsx",
            "description": "This file defines the `LlmApiKeyList` component, which displays a list of LLM API keys for a specific project, and provides functionality to create, update, and delete these keys. It includes access control checks and UI components for managing LLM connections.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/components/CreateLLMApiKeyDialog.tsx",
            "description": "This file defines a React component (`CreateLLMApiKeyDialog`) that provides a dialog for adding a new LLM API connection. It includes a trigger button, a dialog header, and embeds a form (`CreateLLMApiKeyForm`) for the actual key creation, conditionally rendered based on user access.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/components/UpdateLLMApiKeyDialog.tsx",
            "description": "This file defines a React component that provides a dialog for updating an existing LLM API key. It reuses the CreateLLMApiKeyForm component configured in 'update' mode and includes access control checks.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/components/CreateLLMApiKeyForm.tsx",
            "description": "This file defines a React component for creating or updating LLM API keys. It provides a form to configure API keys for various LLM providers, including specific validation rules for each adapter type.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Leo Weigand",
            "percent": 30
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 22
          },
          {
            "name": "Thorsten Spieker",
            "percent": 15
          }
        ]
      },
      "SCIM User Provisioning": {
        "files": [
          {
            "path": "web/src/__tests__/async/scim-api.servertest.ts",
            "description": "This file contains server-side integration tests for the SCIM (System for Cross-domain Identity Management) API endpoints, verifying their functionality, response schemas, and authentication/authorization handling.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/scim/Schemas.ts",
            "description": "This API endpoint serves SCIM (System for Cross-domain Identity Management) schemas, detailing the User schema, for clients requiring identity management capabilities. It authenticates requests using an organization-scoped API key.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/scim/ServiceProviderConfig.ts",
            "description": "This file defines a Next.js API route that provides the SCIM (System for Cross-domain Identity Management) service provider configuration, including supported features and authentication schemes. It requires an authenticated, organization-scoped API key to access this information.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/scim/Users/index.ts",
            "description": "This file implements a Next.js API route for SCIM (System for Cross-domain Identity Management) user management, allowing the retrieval (GET) and creation (POST) of users within an organization via a public API endpoint.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/scim/Users/[id].ts",
            "description": "This file implements a Next.js API route for SCIM (System for Cross-domain Identity Management) user management, allowing retrieval, update (provisioning/deprovisioning), and deletion of individual user identities within an organization.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Steffen Schmitz",
            "percent": 97
          },
          {
            "name": "Nimar",
            "percent": 3
          }
        ]
      },
      "User Collaboration & Mentions": {
        "files": [
          {
            "path": "web/src/pages/api/public/comments/index.ts",
            "description": "This file defines the public API endpoint for managing comments, allowing authenticated users to create new comments and retrieve existing comments based on various filters and pagination.",
            "spof": false
          },
          {
            "path": "web/src/features/comments/components/MentionAutocomplete.tsx",
            "description": "This component provides an autocomplete interface for user mentions, displaying a list of suggested users with avatars and details. It handles loading states, keyboard navigation, and selection of users from the list.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/hooks/useMentionAutocomplete.ts",
            "description": "This file implements a React hook `useMentionAutocomplete` that provides mention autocomplete functionality for textareas. It detects the '@' character, extracts the search query, and fetches user suggestions for display in a dropdown.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/lib/mentionParser.clienttest.ts",
            "description": "This file contains unit tests for the mention parsing utility functions, specifically `extractUniqueMentionedUserIds` and `sanitizeMentions`. It verifies their behavior across various valid, invalid, and edge cases related to extracting user IDs from mention formats, including checks for Redos prevention.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/lib/mentionParser.ts",
            "description": "This file provides utilities for parsing, extracting, and sanitizing user mentions within markdown content, including validation against project members and protection against spam or abuse.",
            "spof": true
          },
          {
            "path": "web/src/features/notifications/components/NotificationSettings.tsx",
            "description": "This file defines a React component that allows users to view and manage their notification settings for a specific project, particularly focusing on email notifications for comment mentions.",
            "spof": true
          },
          {
            "path": "worker/src/features/notifications/commentMentionHandler.ts",
            "description": "This file contains logic to handle comment mention notifications. It retrieves comment details, constructs a link to the comment, and sends email notifications to mentioned users based on their project roles and preferences.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 93
          },
          {
            "name": "Nimar",
            "percent": 4
          },
          {
            "name": "marliessophie",
            "percent": 2
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 192,
      "spofCount": 113
    },
    "busFactor": 2,
    "authorCount": 12
  },
  "Billing & Subscription Management": {
    "description": "Manages subscription plans, payment processing, and usage-based billing for Langfuse Cloud and Enterprise customers. Provides an interface to view invoices and manage spending alerts.",
    "functions": {
      "Stripe Integration & Billing Backend": {
        "files": [
          {
            "path": "web/src/ee/features/billing/README.md",
            "description": "This README provides a comprehensive overview of the billing system, detailing the integration with Stripe for subscriptions, usage-based pricing, and related features like checkout, plan changes, cancellations, and webhook handling. It also includes implementation details, testing guidance, and current limitations of the billing system.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/utils/stripeClientReference.ts",
            "description": "This file provides utility functions for managing Stripe client references in a multi-region deployment, ensuring subscriptions are linked to organizations and webhooks are processed in the correct cloud region. It handles creation, region validation, and organization ID extraction from these references.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/utils/stripeIdempotencyKey.ts",
            "description": "This file provides utilities for generating idempotency keys for Stripe API operations. It defines an enumeration of supported idempotent operation types and a function to construct unique keys, ensuring operations are not executed multiple times.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/utils/stripe.ts",
            "description": "This file initializes and exports a Stripe client instance, which is used for billing functionalities within the application. The client is conditionally created based on the presence of Stripe API keys and cloud region environment variables.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/utils/stripeExpand.ts",
            "description": "This file provides TypeScript utilities and type guards to correctly handle Stripe's `expand` feature, narrowing `Expandable<T>` types to `T` when objects are expanded. It helps ensure type safety and simplifies working with fully-expanded Stripe objects.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/utils/stripeSubscriptionMetadata.ts",
            "description": "This file defines the Zod schema and TypeScript type for Stripe subscription metadata, including `orgId` and `cloudRegion`. It is used to link subscriptions to organizations and manage them across multi-region deployments, ensuring correct webhook processing.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/server/stripeBillingService.ts",
            "description": "This file implements a service for managing an organization's billing and subscriptions through the Stripe API, including retrieving subscription details, invoices, and handling subscription schedules.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/server/stripeWebhookHandler.ts",
            "description": "This file implements a Stripe webhook handler to process various Stripe events (e.g., subscription changes, invoice creation) and synchronize the billing state of organizations within the Langfuse application. It ensures data consistency between Stripe and the application's internal organization records.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/billingCycleHelpers.servertest.ts",
            "description": "This file contains unit tests for server-side helper functions (`getBillingCycleAnchor`, `getBillingCycleStart`, `getBillingCycleEnd`, `getDaysToLookBack`) that calculate and manage billing cycle dates for organizations, including handling edge cases like month ends and leap years.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/billing/README.md",
            "description": "This README file explains that the billing APIs are implemented using the NextJS App router and specifies their location within the source code.",
            "spof": true
          },
          {
            "path": "web/src/app/api/billing/stripe-webhook",
            "description": "This directory is responsible for managing webhook events received from Stripe, specifically for billing-related operations within the application. It acts as an API endpoint to process updates regarding subscriptions, payments, and other financial activities reported by Stripe.",
            "spof": false
          },
          {
            "path": "worker/src/backgroundMigrations/backfillBillingCycleAnchors.ts",
            "description": "This file implements a background migration to backfill the 'cloud_billing_cycle_anchor' field for organizations. It sets the anchor based on the organization's creation date for non-subscribing users and retrieves it from Stripe for those with active subscriptions.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/utils/billingCycleHelpers.ts",
            "description": "This file provides utility functions for calculating and managing billing cycle dates in UTC, including determining cycle start and end dates and handling month-end boundary adjustments for organizations.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 100
          },
          {
            "name": "Marc Klingen",
            "percent": 0
          },
          {
            "name": "Nimar",
            "percent": 0
          }
        ]
      },
      "Plan & Entitlement Definition": {
        "files": [
          {
            "path": "web/src/ee/features/billing/constants.ts",
            "description": "This file defines constants related to billing features for the enterprise edition, specifically the maximum number of events allowed on the free plan.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/utils/isCloudBilling.ts",
            "description": "Provides utility functions to check if cloud billing is enabled or available, with separate functions for server-side and client-side contexts based on the cloud region environment variable.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/utils/stripeCatalogue.ts",
            "description": "This file defines the catalogue of Stripe products used for billing, mapping them to Langfuse plans. It includes product details for checkout and provides utility functions for product lookup, plan mapping, and upgrade logic.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/rate-limit.servertest.ts",
            "description": "This file contains unit tests for the server-side rate limiting service. It verifies that the `RateLimitService` correctly applies, tracks, and resets rate limits using Redis, including handling various scenarios like overrides and plan types.",
            "spof": false
          },
          {
            "path": "web/src/features/entitlements/README.md",
            "description": "This README documents the 'Entitlements' feature, which manages the availability of features and resource limits based on organizational plans. It outlines concepts like plans and entitlements, and explains how they are implemented and utilized both client-side and server-side.",
            "spof": true
          },
          {
            "path": "web/src/features/entitlements/hooks.ts",
            "description": "This file provides React hooks for retrieving and checking user/organization plans, entitlements, and their associated limits within the application, based on session data and current route.",
            "spof": true
          },
          {
            "path": "web/src/features/entitlements/server/hasEntitlement.ts",
            "description": "This file provides server-side utilities to check if a user or an organization's plan has access to specific entitlements, and to throw an error if an entitlement is missing.",
            "spof": true
          },
          {
            "path": "web/src/features/entitlements/server/getPlan.ts",
            "description": "This file contains server-side functions to determine the Langfuse plan (cloud, self-hosted, or open-source) for an organization or instance based on cloud configuration, Stripe product IDs, or license keys.",
            "spof": false
          },
          {
            "path": "web/src/features/entitlements/server/hasEntitlementLimit.ts",
            "description": "This file provides server-side utility functions for checking and enforcing entitlement limits based on a user's organization plan. It includes functions to retrieve limits, verify if current usage is within those limits, and throw errors when limits are exceeded.",
            "spof": true
          },
          {
            "path": "web/src/features/entitlements/constants/entitlements.ts",
            "description": "This file defines the available entitlements (features) and their corresponding limits for different subscription plans and deployment types (cloud, self-hosted) within the application.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/server/RateLimitService.ts",
            "description": "This file implements a rate limiting service for API requests, applying different limits based on the organization's plan and the specific API resource being accessed. It uses Redis to manage and enforce these rate limits, and provides utilities for checking limits and sending 429 responses.",
            "spof": false
          },
          {
            "path": "ee/README.md",
            "description": "This file serves as a README for the Enterprise Edition (EE) features of Langfuse, indicating that these features are exclusive to EE and Langfuse Cloud.",
            "spof": true
          },
          {
            "path": "ee/src/ee-license-check/index.ts",
            "description": "Determines if Enterprise Edition (EE) features are available or enabled based on the presence of specific environment variables, such as a cloud region or an EE license key.",
            "spof": true
          },
          {
            "path": "packages/shared/src/interfaces/cloudConfigSchema.ts",
            "description": "Defines the Zod schema for cloud configuration, including plan details, usage limits, Stripe integration, and custom rate limits for an organization. This schema outlines the structure for managing cloud-related settings.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/entitlements/plans.ts",
            "description": "Defines various subscription plans (e.g., Hobby, Pro, Enterprise) for both cloud and self-hosted deployments, including their labels and utility functions to categorize them.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Marc Klingen",
            "percent": 34
          },
          {
            "name": "Max Deichmann",
            "percent": 25
          },
          {
            "name": "Steffen Schmitz",
            "percent": 17
          }
        ]
      },
      "Billing & Plan Management UI": {
        "files": [
          {
            "path": "web/src/ee/features/billing/components/BillingDiscountCodeButton.tsx",
            "description": "This React component provides a button that opens a dialog for users to enter and apply a promotion or discount code to their organization's billing subscription. It handles the API call, success/error feedback, and UI state management for applying the code.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/BillingDiscountView.tsx",
            "description": "This component displays and manages billing discounts for an organization, showing applied discounts and providing a button to apply new discount codes.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/BillingPlanPeriodView.tsx",
            "description": "This component displays the current billing plan label and the billing period (start and end dates) for a given organization.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/SupportOrUpgradePage.tsx",
            "description": "This file defines a React component that displays a page indicating restricted access to a feature, prompting the user to contact an administrator or upgrade their plan.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/BillingActionButtons.tsx",
            "description": "This file defines the `BillingActionButtons` React component, which provides a set of UI buttons for managing an organization's billing, including changing plans, updating payment details via Stripe, canceling subscriptions, and comparing plans.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/StripeKeepPlanButton.tsx",
            "description": "This file defines a React component (`StripeKeepPlanButton`) that allows users to cancel a scheduled change to their Stripe billing plan and remain on their current plan. It uses a confirmation dialog and interacts with a backend API to clear the plan switch schedule.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/StripeCancellationButton.tsx",
            "description": "This file defines a React component (`StripeCancellationButton`) that allows users to cancel or reactivate their Stripe subscription, displaying appropriate buttons and confirmation dialogs based on the current subscription status.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/useBillingInformation.tsx",
            "description": "This file defines a React hook, `useBillingInformation`, which fetches and processes an organization's billing and subscription details, including its current plan, cancellation status, and scheduled plan changes.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/BillingScheduleNotification.tsx",
            "description": "This component displays notifications to users regarding their billing schedule, specifically for subscription cancellations or scheduled plan changes. It informs users about the effective dates and details of these billing events.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/BillingSettings.tsx",
            "description": "This file defines the `BillingSettings` component, which renders the main billing page for an organization. It displays usage charts, plan details, invoices, and allows managing billing actions, with checks for cloud billing availability, user entitlements, and organization access.",
            "spof": false
          },
          {
            "path": "web/src/ee/features/billing/components/BillingUsageChart.tsx",
            "description": "This React component displays the current billing usage for a Langfuse organization, showing event counts against plan limits, particularly for hobby plans, within the Langfuse Cloud environment.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/BillingCurrentPlanLabel.tsx",
            "description": "This React component displays the user's current billing plan. It also indicates if a subscription cancellation is pending and shows the end date if applicable.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/StripeSwitchPlanButton.tsx",
            "description": "This file defines a React component `StripeSwitchPlanButton` that provides a UI for users to switch their subscription plan via Stripe. It displays a confirmation dialog detailing the financial implications of the plan change (upgrade, downgrade, or legacy subscription) before calling a billing API.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/StripeCustomerPortalButton.tsx",
            "description": "This component renders a button that allows users with appropriate permissions to access their organization's Stripe Customer Portal for managing billing, handling the redirection and loading states.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/BillingSwitchPlanDialog.tsx",
            "description": "This React component provides a dialog that allows users to view available billing plans and manage their Langfuse Cloud subscription, including switching plans, reactivating a cancelled subscription, or canceling a scheduled downgrade.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/BillingInvoiceTable.tsx",
            "description": "This file defines a React component, `BillingInvoiceTable`, which displays a paginated table of a user's billing invoice history. It fetches invoice data, presents details like date, status, cost breakdown, and provides links to view or download invoices, while also handling pagination and conditional rendering based on billing availability.",
            "spof": true
          },
          {
            "path": "web/src/components/VersionLabel.tsx",
            "description": "This component displays the current application version, and for self-hosted instances, checks for available updates, shows the current plan (OSS, Pro, EE), and indicates background migration status, all accessible via a dropdown menu with relevant links.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/settings/billing.ts",
            "description": "This file handles redirection from a project-specific billing settings page to the corresponding organization's billing settings page, utilizing the organization ID derived from the project.",
            "spof": true
          },
          {
            "path": "web/src/features/payment-banner/index.ts",
            "description": "This file serves as an entry point for the payment banner feature, exporting the main `PaymentBanner` component and its context provider with a height hook.",
            "spof": true
          },
          {
            "path": "web/src/features/payment-banner/PaymentBanner.tsx",
            "description": "This component renders a persistent banner at the top of the page to alert users about past-due or unpaid subscription payments for their organization, prompting authorized users to update billing information.",
            "spof": true
          },
          {
            "path": "web/src/features/payment-banner/PaymentBannerContext.tsx",
            "description": "This file defines a React Context and Provider to manage the height of a payment banner. It allows child components to access and update the banner's height, and also exposes this height as a CSS variable for global layout adjustments.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 79
          },
          {
            "name": "Marc Klingen",
            "percent": 12
          },
          {
            "name": "marliessophie",
            "percent": 5
          }
        ]
      },
      "Spend Alert Management": {
        "files": [
          {
            "path": "web/src/ee/features/billing/components/SpendAlerts/DeleteSpendAlertDialog.tsx",
            "description": "This file defines a React component that provides a confirmation dialog for deleting a spend alert. It handles the API call for deletion, displays loading states, and provides user feedback.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/SpendAlerts/SpendAlertDialog.tsx",
            "description": "This component renders a dialog for creating or editing spend alerts, allowing users to define a title and a spending limit. It handles form submission, validation, and interaction with the API to manage these alerts.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/SpendAlerts/SpendAlertsTable.tsx",
            "description": "This file defines the `SpendAlertsTable` component, which displays a table of spending alerts for an organization, allowing users to view, edit, and delete these alerts.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/billing/components/SpendAlerts/SpendAlertsSection.tsx",
            "description": "This file defines the `SpendAlertsSection` React component, which displays and manages spend alerts for an organization. It includes a table of existing alerts and functionality to create new alerts, with access controlled by organization permissions and feature entitlements.",
            "spof": true
          },
          {
            "path": "worker/src/queues/cloudSpendAlertQueue.ts",
            "description": "This file defines a BullMQ processor responsible for handling cloud spend alert jobs within the Langfuse worker, delegating the actual alert processing to `handleCloudSpendAlertJob`.",
            "spof": true
          },
          {
            "path": "worker/src/scripts/send-test-spend-alert-emails.ts",
            "description": "This script is used for sending various types of test spend alert emails to a predefined list of recipients. Its primary purpose is visual testing of email templates by simulating different alert scenarios.",
            "spof": true
          },
          {
            "path": "worker/src/scripts/send-test-threshold-emails.ts",
            "description": "This script sends test usage threshold warning and suspension emails to a predefined list of email addresses for visual and functional testing purposes.",
            "spof": true
          },
          {
            "path": "worker/src/ee/cloudSpendAlerts/handleCloudSpendAlertJob.ts",
            "description": "This file handles a background job to monitor an organization's cloud spend using Stripe data. It checks configured spend alerts, calculates current spend from a Stripe invoice preview, and sends email notifications to organization administrators if spend thresholds are exceeded within the current billing cycle.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/cloudSpendAlertQueue.ts",
            "description": "This file defines a singleton class `CloudSpendAlertQueue` that manages a BullMQ queue for processing cloud spend alerts. The queue is only initialized if the Stripe secret key is available.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/email/cloudSpendAlert/CloudSpendAlertEmailTemplate.tsx",
            "description": "This file defines a React component that serves as an email template for notifying users when their cloud spend for a specific organization reaches a predefined alert threshold.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/services/email/cloudSpendAlert/sendCloudSpendAlertEmail.ts",
            "description": "This file defines a function to send email notifications for cloud spend alerts. It uses environment variables for email configuration and renders a React-based email template to inform recipients when an organization's cloud spending exceeds a predefined threshold.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/email/usageThresholdWarning/sendUsageThresholdWarningEmail.ts",
            "description": "This file defines and exports a function to send a usage threshold warning email to an organization. It utilizes Nodemailer to send a pre-formatted HTML email when an organization's usage approaches or exceeds a specified limit.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 100
          }
        ]
      },
      "Custom Model Pricing Management": {
        "files": [
          {
            "path": "web/src/__tests__/async/model-pricing-tiers.servertest.ts",
            "description": "This file contains unit tests for validation utility functions, specifically `validateRegexPattern` and `validatePricingTiers`, which are used to ensure the correctness of regular expression patterns and model pricing tier configurations.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/models/index.ts",
            "description": "This file defines a public API endpoint for managing model definitions. It allows authenticated users to retrieve a paginated list of models and create new custom models with their associated pricing configurations.",
            "spof": true
          },
          {
            "path": "web/src/features/models/hooks/usePriceUnitMultiplier.ts",
            "description": "This file defines a React hook that manages a user's preferred price unit (e.g., per unit, per 1K units) stored in local storage and provides a corresponding numerical multiplier for calculations.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/PriceBreakdownTooltip.tsx",
            "description": "This component renders a price breakdown for a model, displaying individual prices for different usage types. It uses a tooltip to show detailed prices when there are many, or directly displays them if the list is short, formatting them based on a price unit multiplier.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/PriceUnitSelector.tsx",
            "description": "This file defines the `PriceUnitSelector` React component, which provides a UI for users to select a price unit using a popover and select dropdown.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/ModelSettings.tsx",
            "description": "This file defines the `ModelsSettings` React component, which displays and manages definitions for LLM models, including their pricing and token usage calculation within Langfuse. It presents a header, an explanation, and a table of models.",
            "spof": false
          },
          {
            "path": "web/src/features/models/components/EditModelButton.tsx",
            "description": "This file defines a React component (`EditModelButton`) that renders a button to open a dialog for editing an existing model. It incorporates role-based access control to disable the button if the user lacks the necessary permissions.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/PricePreview.tsx",
            "description": "This React component, `PricePreview`, displays a formatted preview of various price calculations. It takes a map of usage types to prices, validates them, and then renders prices per unit, per 1K, and per 1M, or an error message if the input is invalid.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/pricing-tiers/TierPrefillButtons.tsx",
            "description": "This React component provides buttons to prefill pricing tier usage types in a form, offering templates for platforms like OpenAI and Anthropic.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/pricing-tiers/TierConditionsEditor.tsx",
            "description": "This file defines a React component (`TierConditionsEditor`) that allows users to add, edit, and remove conditions for a specific pricing tier. It provides UI elements to configure usage detail patterns, operators, values, and case sensitivity for each condition using a form.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/pricing-tiers/TierAccordionItem.tsx",
            "description": "This file defines a React component, `TierAccordionItem`, which renders a single pricing tier within an accordion, allowing users to view and edit its name, conditions, and pricing details. It integrates with `react-hook-form` for managing form state for model pricing tiers.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/pricing-tiers/TierPriceEditor.tsx",
            "description": "This component provides an interface for editing the pricing tiers of a model, allowing users to define and modify prices for different usage types within a specific tier. It supports adding, removing, and updating individual price entries.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/pricing-tiers/PricingSection.tsx",
            "description": "This component provides a UI for managing pricing tiers of a model within a form. It renders either a simple price editor for a single default tier or an accordion view for defining multiple custom pricing tiers, allowing users to add new tiers.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/test-match/NoMatchDisplay.tsx",
            "description": "A React component that displays an error message when a model name does not match any existing configurations, along with suggestions for troubleshooting.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/test-match/MatchedModelCard.tsx",
            "description": "This file defines a React component (`MatchedModelCard`) that displays details of a matched model, including its name, matching pattern, and indicates if it's a Langfuse-provided model.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/test-match/TestModelMatchDialog.tsx",
            "description": "This component provides a dialog for users to test how a given model name and usage details would match against the project's defined pricing models and tiers. It displays the matching results, including the matched model and pricing tier, or indicates if no match was found.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/test-match/UsageDetailsEditor.tsx",
            "description": "This file defines a React component `UsageDetailsEditor` that allows users to edit and define custom usage details, often using predefined templates (e.g., OpenAI, Anthropic), to test pricing tier matching for a given model or service. Users can add, remove, and modify key-value pairs representing different usage metrics.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/test-match/MatchedTierCard.tsx",
            "description": "This file defines a React component, `MatchedTierCard`, that displays the details of a matched pricing tier within a card, including its name, priority, default status, and a list of prices per usage type.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/test-match/TestModelMatchButton.tsx",
            "description": "This file defines a React component, `TestModelMatchButton`, which provides a button that, when clicked, opens a dialog to test model matching functionality within the Langfuse application.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/types/models.ts",
            "description": "This file defines Zod schemas for public API model definitions, pricing tiers, and usage units. It also includes schemas for request/response bodies and query parameters for model-related API endpoints (GET, POST, DELETE), along with a transformation function from Prisma models to API models.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/pricing-tier-matcher.test.ts",
            "description": "This file contains unit tests for the structure and consistency of the 'default-model-prices.json' data, as well as tests for the pricing tier matching logic and regular expression validation used in pricing conditions.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/modelMatch.test.ts",
            "description": "This file contains unit tests for the model matching and caching mechanisms, verifying that models can be correctly retrieved from Redis cache or PostgreSQL, including their pricing tiers, and that the cache can be effectively cleared for a given project.",
            "spof": false
          },
          {
            "path": "worker/src/scripts/convertDefaultModelPricesToTiers.ts",
            "description": "This script converts a JSON file containing model pricing data from an old, flat format to a new, tiered pricing format. It reads the old data, transforms it, and writes the new data to a separate file, also creating a backup of the original.",
            "spof": true
          },
          {
            "path": "worker/src/scripts/createDefaultModelPricesJson.ts",
            "description": "This script retrieves default model pricing information from the database. It then exports this data into a JSON file, which serves as a static configuration for default model prices.",
            "spof": true
          },
          {
            "path": "worker/src/scripts/upsertDefaultModelPrices.ts",
            "description": "This script manages and updates default model prices, along with their associated pricing tiers, in the database from a JSON configuration file. It ensures data consistency through batched transactional upserts and optional cache invalidation.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/pricing-tiers/index.ts",
            "description": "This file exports shared types and utilities for managing pricing tiers, including matching functionality and data structures related to pricing tier results and prices.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/pricing-tiers/matcher.ts",
            "description": "This file contains the logic for matching usage details to a specific pricing tier based on a set of defined conditions and priorities. It evaluates pricing tier conditions against usage data to determine the applicable pricing structure.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/pricing-tiers/types.ts",
            "description": "This file defines shared TypeScript types for pricing tier functionality, including the structure for matching results and full pricing tier configurations with associated prices.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/model-pricing/index.ts",
            "description": "This file serves as the entry point for the model pricing feature within the shared package, primarily re-exporting validation-related utilities.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/model-pricing/validation.ts",
            "description": "This file defines Zod schemas and validation functions for managing model pricing tiers. It includes validation for regex patterns used in conditions, ensures the structural integrity and consistency of a collection of pricing tiers, and validates the chosen pricing method (flat prices versus pricing tiers).",
            "spof": true
          },
          {
            "path": "packages/shared/prisma/migrations/20230901155252_add_pricings_table",
            "description": "This directory contains a specific Prisma migration script. It is responsible for defining the database schema changes related to adding a 'pricings' table. The directory name reflects the timestamp and purpose of this particular database migration.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230901155336_add_pricing_data",
            "description": "This directory represents a specific Prisma database migration within the `langfuse` project. Its purpose is to apply schema changes related to adding pricing data to the database, identified by its timestamp and descriptive name. This migration ensures the database can support new pricing features.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240111152124_add_gpt_35_pricing",
            "description": "This directory represents a specific database migration script within the Langfuse application, executed by Prisma. Its role is to implement changes related to the pricing structure for GPT-3.5 models. This ensures the database schema accurately reflects the necessary cost information.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240103135918_add_pricings",
            "description": "This directory contains a specific Prisma migration script responsible for updating the database schema. It likely introduces new tables or columns related to 'pricings' within the shared package of the Langfuse project. The timestamp indicates the creation date of this particular migration.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240215224148_update_openai_pricing",
            "description": "This directory contains a specific Prisma database migration script, dated 2024-02-15, which is responsible for updating the OpenAI pricing schema within the shared package. It ensures the database schema evolves correctly to reflect changes in pricing logic or data structures for OpenAI services.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231018130032_add_per_1000_chars_pricing",
            "description": "This directory represents a specific Prisma database migration within the shared package. It is responsible for applying schema changes to introduce 'per 1000 characters pricing' functionality. The timestamp indicates it was created on October 18, 2023.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240213124148_update_openai_pricing",
            "description": "This directory contains a specific Prisma database migration within a shared package. It is named by its creation timestamp and describes an update related to OpenAI pricing within the database schema or data.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240203184148_update_pricing",
            "description": "This directory contains a specific Prisma database migration script, identified by its timestamp and purpose. Its role is to apply schema changes related to updating pricing within the shared package of the Langfuse application.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240104210052_add_model_indices_pricing",
            "description": "This directory holds a specific Prisma database migration script, identified by its timestamp and name: `20240104210052_add_model_indices_pricing`. Its role is to apply database schema changes, specifically adding model indices for pricing-related data. This ensures consistent and version-controlled database updates within the shared `langfuse` package.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Hassieb Pakzad",
            "percent": 95
          },
          {
            "name": "Steffen Schmitz",
            "percent": 2
          },
          {
            "name": "Max Deichmann",
            "percent": 1
          }
        ]
      },
      "Usage Metering & Free Tier Enforcement": {
        "files": [
          {
            "path": "worker/src/__tests__/usageAggregation.test.ts",
            "description": "This file contains unit tests for functions that aggregate usage data (traces, observations, and scores) from individual projects to their respective organizations. It tests mapping projects to organizations and the aggregation logic for calculating total usage per organization.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/usageThresholdCacheInvalidation.test.ts",
            "description": "Tests the cache invalidation mechanism for API keys in Redis, ensuring they are correctly invalidated when an organization's usage threshold blocking status changes (e.g., becoming blocked or unblocked).",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/thresholdProcessing.test.ts",
            "description": "This file contains unit tests for the `processThresholds` function, verifying its logic for detecting and updating an organization's free-tier usage threshold state (e.g., warning, blocked) based on current usage.",
            "spof": true
          },
          {
            "path": "worker/src/queues/cloudFreeTierUsageThresholdQueue.ts",
            "description": "This file defines a BullMQ processor responsible for executing jobs related to cloud free tier usage thresholds, logging their execution and handling potential errors. It processes `CloudFreeTierUsageThresholdJob` by calling a dedicated handler function.",
            "spof": true
          },
          {
            "path": "worker/src/queues/cloudUsageMeteringQueue.ts",
            "description": "This file defines a BullMQ processor responsible for handling cloud usage metering jobs. It executes the core metering logic, logs its progress, and manages error recovery by re-queuing failed jobs and updating their database status.",
            "spof": false
          },
          {
            "path": "worker/src/scripts/refill-billing-event.ts",
            "description": "This script manually triggers the cloud usage metering job by adding it to the queue. It is used to re-trigger billing events.",
            "spof": true
          },
          {
            "path": "worker/src/ee/cloudUsageMetering/constants.ts",
            "description": "Defines constants and states for the database cron job responsible for cloud usage metering, likely for an enterprise feature.",
            "spof": false
          },
          {
            "path": "worker/src/ee/cloudUsageMetering/handleCloudUsageMeteringJob.ts",
            "description": "This file defines a job handler that calculates and submits cloud usage metrics (observations, traces, scores) to Stripe for billing purposes for various organizations. It operates on an hourly interval, manages its own cron job state, and triggers spend alerts.",
            "spof": false
          },
          {
            "path": "worker/src/ee/usageThresholds/constants.ts",
            "description": "This file defines constants for usage thresholds used in free-tier enforcement, including maximum events, notification levels, and API blocking limits. These thresholds trigger email alerts or API blocking based on usage.",
            "spof": true
          },
          {
            "path": "worker/src/ee/usageThresholds/bulkUpdates.ts",
            "description": "This file provides utility functions for bulk updating organization data, primarily related to free tier usage thresholds and billing cycles. It includes two distinct methods: one utilizing Prisma transactions and another employing raw SQL for optimized performance.",
            "spof": true
          },
          {
            "path": "worker/src/ee/usageThresholds/thresholdProcessing.ts",
            "description": "Manages and processes usage thresholds for organizations, sending warning or suspension emails and blocking ingestion for free-tier accounts when limits are exceeded.",
            "spof": true
          },
          {
            "path": "worker/src/ee/usageThresholds/handleCloudFreeTierUsageThresholdJob.ts",
            "description": "This file defines a BullMQ job handler responsible for aggregating usage data across all organizations, specifically for cloud free tier usage thresholds.",
            "spof": true
          },
          {
            "path": "worker/src/ee/usageThresholds/usageAggregation.ts",
            "description": "Aggregates usage data (traces, observations, scores) for all organizations over a billing cycle. It processes usage thresholds, determines billing states (e.g., free tier), and updates organization records accordingly.",
            "spof": true
          },
          {
            "path": "worker/src/ee/meteringDataPostgresExport/handleMeteringDataPostgresExportJob.ts",
            "description": "This file defines a BullMQ processor that exports active Stripe metering data for all billing organizations to a PostgreSQL database. It fetches event summaries from Stripe and stores them in the `billingMeterBackup` table.",
            "spof": true
          },
          {
            "path": "worker/src/features/tokenisation/worker-thread.ts",
            "description": "This file defines a worker thread responsible for token counting. It receives text and model information from the main thread, calculates token usage, and sends the result or any errors back.",
            "spof": true
          },
          {
            "path": "worker/src/features/tokenisation/worker-thread.js",
            "description": "This file defines a worker thread responsible for calculating the token count of provided text using a specified model. It receives data from and sends results or errors back to the main thread.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/cloudUsageMeteringQueue.ts",
            "description": "Manages a Redis-backed queue for cloud usage metering, scheduling both recurring hourly jobs and an immediate bootstrap job to track usage.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/cloudFreeTierUsageThresholdQueue.ts",
            "description": "Manages a Redis-backed queue for processing and monitoring cloud free-tier usage thresholds. It schedules recurring jobs to check usage at specific intervals in cloud deployments.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/meteringDataPostgresExportQueue.ts",
            "description": "This file defines a singleton class for managing a BullMQ queue responsible for exporting metering data to PostgreSQL. It initializes the queue and schedules a daily job to perform this export, contingent on an environment variable.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/email/usageThresholdSuspension/UsageThresholdUpcomingEnforcementEmailTemplate.tsx",
            "description": "This file defines a React component for an email template that notifies users their organization is exceeding its free tier usage limit, warns of upcoming service suspension, and prompts them to upgrade their plan to avoid disruption.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/email/usageThresholdSuspension/UsageThresholdSuspensionEmailTemplate.tsx",
            "description": "This file defines a React component for an email template. It is used to notify organizations when their data ingestion has been suspended due to exceeding their free tier usage limit, providing details on the issue and resolution options.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/email/usageThresholdSuspension/sendUsageThresholdSuspensionEmail.ts",
            "description": "This file defines and exports a function to send an email notification when a Langfuse organization's ingestion has been suspended due to exceeding its usage threshold. It uses `nodemailer` and a React email template to construct and send the urgent email.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/email/usageThresholdWarning/UsageThresholdWarningEmailTemplate.tsx",
            "description": "This file defines a React component for an email template. It is used to notify organizations when their usage of a service is approaching or has exceeded a predefined threshold, prompting them to upgrade their plan.",
            "spof": true
          },
          {
            "path": "packages/shared/prisma/migrations/20240130100110_usage_unit_nullable",
            "description": "This directory contains a specific Prisma database migration. Its purpose is to alter the database schema, making the 'usage_unit' column nullable. The migration is identified by its timestamp and descriptive name.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 89
          },
          {
            "name": "Marc Klingen",
            "percent": 4
          },
          {
            "name": "Steffen Schmitz",
            "percent": 4
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 124,
      "spofCount": 99
    },
    "busFactor": 2,
    "authorCount": 8
  },
  "Security & Compliance": {
    "description": "Provides a detailed, immutable audit trail of all significant user and system activities. Essential for security monitoring, incident investigation, and meeting compliance requirements.",
    "functions": {
      "Audit Trail Management": {
        "files": [
          {
            "path": "web/src/ee/features/audit-log-viewer/AuditLogsTable.tsx",
            "description": "This component renders a paginated and sortable data table for displaying audit logs, supporting both project-level and organization-level views. It allows users to inspect actions, actors, resources, and changes, and includes functionality for batch export.",
            "spof": false
          },
          {
            "path": "web/src/ee/features/audit-log-viewer/AuditLogsSettingsPage.tsx",
            "description": "This file defines a React component for displaying project audit logs, including checks for enterprise feature entitlement and user access permissions before rendering the audit log table.",
            "spof": true
          },
          {
            "path": "web/src/ee/features/audit-log-viewer/OrgAuditLogsSettingsPage.tsx",
            "description": "This file implements the organization-level audit logs settings page, displaying a table of audit log entries, and enforcing enterprise entitlement and user access permissions.",
            "spof": true
          },
          {
            "path": "web/src/features/table/server/helpers.ts",
            "description": "This file provides a helper function to generate a unique identifier for batch actions by combining project ID, table name, and action ID. It is likely used within the table feature of the web application.",
            "spof": true
          },
          {
            "path": "web/src/features/table/server/createBatchActionJob.ts",
            "description": "This file defines a server-side function to create and enqueue a background job for performing batch actions (e.g., updates or exports) on data, ensuring an audit log entry is generated for each action.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/patchLLMToolAndLLLMSchemaAuditLogs.test.ts",
            "description": "This file contains unit tests for the `PatchLLMToolAndLLLMSchemaAuditLogs` background migration script. It verifies that audit logs are correctly updated to reflect `llmTool` or `llmSchema` resource types based on their content, handling various data scenarios including malformed JSON and batch processing.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/patchLLMToolAndLLLMSchemaAuditLogs.ts",
            "description": "This script is a background migration that corrects misclassified audit logs in the database. It identifies audit logs incorrectly labeled as 'project' and infers their true resource type (LLMTool or LLMSchema) based on their content, then updates them accordingly.",
            "spof": true
          },
          {
            "path": "packages/shared/prisma/migrations/20240212175433_add_audit_log_table",
            "description": "This directory contains a specific Prisma database migration script. Its purpose is to define the changes required to add an audit log table to the database schema. The timestamped name indicates its creation date and sequential order within the migration history.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Steffen Schmitz",
            "percent": 52
          },
          {
            "name": "Jannik Maierhfer",
            "percent": 25
          },
          {
            "name": "Marc Klingen",
            "percent": 10
          }
        ]
      },
      "Security Hardening and Threat Prevention": {
        "files": [
          {
            "path": "web/src/__tests__/dom.clienttest.ts",
            "description": "This file contains client-side tests for DOM sanitization, specifically verifying that `DOMPurify` correctly removes malicious scripts from URLs while preserving valid Langfuse URLs.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/queryBuilderSQLI.servertest.ts",
            "description": "This file contains a test suite designed to identify and prevent SQL injection vulnerabilities within the QueryBuilder component. It verifies that various input fields and parameters are properly sanitized or parameterized to avert malicious SQL code execution.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/ip-blocking.test.ts",
            "description": "This file contains unit tests for the IP and hostname blocking module, verifying that various IP addresses and hostnames are correctly identified as blocked or allowed, including handling whitelists and invalid inputs.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/encryption.test.ts",
            "description": "This file contains unit tests for the encryption and decryption utility functions (`keyGen`, `encrypt`, `decrypt`) used in the Langfuse project. It verifies their correctness, including key generation, encryption with mocked randomness, decryption, and a full encrypt-decrypt roundtrip.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/webhooks/validation.ts",
            "description": "This file provides functions to validate webhook URLs, resolving hostnames and checking IP addresses against blocklists and whitelists to prevent Server-Side Request Forgery (SSRF) attacks.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Steffen Schmitz",
            "percent": 36
          },
          {
            "name": "Max Deichmann",
            "percent": 27
          },
          {
            "name": "0x0034",
            "percent": 17
          }
        ]
      },
      "Automated Data Retention": {
        "files": [
          {
            "path": "worker/src/__tests__/mediaRetentionCleaner.test.ts",
            "description": "This file contains unit tests for the `MediaRetentionCleaner` class, verifying its functionality to delete media files from projects and S3 storage based on project-specific retention policies.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/dataRetentionProcessing.test.ts",
            "description": "This file contains unit tests for the `DataRetentionProcessingJob`, verifying that it correctly deletes expired event files, media files, traces, observations, and scores from cloud storage (S3), ClickHouse, and the database (Prisma) based on defined retention policies.",
            "spof": false
          },
          {
            "path": "worker/src/queues/dataRetentionQueue.ts",
            "description": "This file defines BullMQ queue processors responsible for scheduling and executing data retention tasks within the application, handling both the scheduling and the actual processing of data retention jobs.",
            "spof": true
          },
          {
            "path": "worker/src/ee/dataRetention/handleDataRetentionProcessingJob.ts",
            "description": "Handles a data retention processing job by deleting old project data (including media files, traces, observations, scores, and events) from various storage systems (S3, ClickHouse, PostgreSQL) based on the project's configured retention policy.",
            "spof": false
          },
          {
            "path": "worker/src/features/media-retention-cleaner/index.ts",
            "description": "This file defines the MediaRetentionCleaner class, which periodically cleans up old media files and blob storage entries. It identifies projects with expired media based on their retention settings and removes them from S3, PostgreSQL, and ClickHouse.",
            "spof": true
          },
          {
            "path": "worker/src/features/batch-data-retention-cleaner/index.ts",
            "description": "This file defines a background worker responsible for periodically cleaning up old data in ClickHouse (traces, observations, scores, events) based on project-specific data retention settings. It ensures exclusive execution per table using distributed locking.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/dataRetentionProcessingQueue.ts",
            "description": "This file defines a singleton class, `DataRetentionProcessingQueue`, responsible for creating and managing a BullMQ Redis queue specifically for data retention processing tasks. It configures connection details, job options (like retries and removal policies), and error handling for the queue.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/dataRetentionQueue.ts",
            "description": "This file defines a singleton class, `DataRetentionQueue`, which initializes and manages a BullMQ queue for data retention tasks. It schedules a daily job at 3:15 AM to process data retention operations using Redis.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Valery Meleshkin",
            "percent": 89
          },
          {
            "name": "Steffen Schmitz",
            "percent": 7
          },
          {
            "name": "Max Deichmann",
            "percent": 2
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 21,
      "spofCount": 15
    },
    "busFactor": 3,
    "authorCount": 7
  },
  "Automations & Integrations": {
    "description": "Automates workflows by triggering actions like webhooks or Slack notifications based on events in Langfuse. Integrates with third-party tools like PostHog and Mixpanel for extended analytics.",
    "functions": {
      "Third-Party Analytics Synchronization": {
        "files": [
          {
            "path": "web/src/components/MixpanelLogo.tsx",
            "description": "This file exports a React component named `MixpanelLogo` which renders the Mixpanel logo as an SVG. It is designed to be easily adaptable by using `currentColor` and without external styles or metadata.",
            "spof": true
          },
          {
            "path": "web/src/components/PosthogLogo.tsx",
            "description": "This file defines a React component, `PostHogLogo`, which renders the PostHog logo as an SVG. It allows for the logo to be used as a reusable UI element in web applications.",
            "spof": true
          },
          {
            "path": "web/src/components/nav/book-a-call-button.tsx",
            "description": "This file defines a React component for a 'Book a Call' button that appears in a sidebar menu. The button is displayed for a limited time (7 days) using local storage and tracks user clicks via PostHog analytics.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/posthog-integration.servertest.ts",
            "description": "This file contains server-side tests for the PostHog integration, specifically verifying its Server-Side Request Forgery (SSRF) protection by ensuring that invalid or private hostnames are rejected.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/settings/integrations/posthog.tsx",
            "description": "This file implements the user interface and logic for managing PostHog integration settings within a specific project. It allows users to configure PostHog credentials, enable/disable the integration, and view its synchronization status.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/settings/integrations/mixpanel.tsx",
            "description": "This file defines the UI and logic for configuring Mixpanel integration settings for a specific project, allowing users to enable/disable the integration, set the region, and provide a project token.",
            "spof": true
          },
          {
            "path": "web/src/features/mixpanel-integration/types.ts",
            "description": "This file defines types, constants, and a Zod schema for configuring Mixpanel integration, including available regions and validation for the project token and integration status.",
            "spof": true
          },
          {
            "path": "web/src/features/posthog-integration/types.ts",
            "description": "This file defines a Zod schema for the PostHog integration form, including validation rules for the PostHog hostname, project API key, and an 'enabled' flag.",
            "spof": false
          },
          {
            "path": "web/src/features/theming/ThemeToggle.tsx",
            "description": "This file defines the `ThemeToggle` React component, which provides a UI for users to switch between light, dark, and system themes. It manages theme state using `next-themes` and tracks theme changes via PostHog analytics.",
            "spof": true
          },
          {
            "path": "web/src/features/posthog-analytics/ServerPosthog.ts",
            "description": "This file defines a `ServerPosthog` class that provides a server-side wrapper for the PostHog analytics client. It handles the initialization and configuration of PostHog based on environment variables and offers methods to capture events.",
            "spof": true
          },
          {
            "path": "web/src/features/posthog-analytics/usePostHogClientCapture.ts",
            "description": "This file defines a comprehensive list of PostHog analytics events, categorized by resource and action, and provides a custom `usePostHogClientCapture` hook to ensure type-safe and consistent event capturing across the application based on this predefined list.",
            "spof": false
          },
          {
            "path": "web/src/features/telemetry/README.md",
            "description": "This file describes the telemetry service for Langfuse Docker deployments, detailing what basic usage statistics are collected, their purpose for product improvement and reporting, and how users can opt-out.",
            "spof": false
          },
          {
            "path": "web/src/features/telemetry/index.ts",
            "description": "This file implements a telemetry service that periodically collects anonymized usage statistics (e.g., project, trace, score, dataset counts) from the Langfuse instance and sends them to Posthog. It includes scheduling logic to ensure the job runs at set intervals and various environment checks to control its execution.",
            "spof": false
          },
          {
            "path": "web/src/features/playground/server/analytics/posthogCallback.ts",
            "description": "This file defines a Langchain callback handler that captures and sends chat completion event data to Posthog analytics. It records details like input/output length, model provider, and model name after an LLM interaction ends.",
            "spof": true
          },
          {
            "path": "worker/src/queues/postHogIntegrationQueue.ts",
            "description": "This file defines BullMQ processors for handling PostHog integration-related jobs, including scheduling integration tasks and processing individual project integration jobs. It acts as the entry point for executing PostHog integration logic within a queue-based system.",
            "spof": true
          },
          {
            "path": "worker/src/queues/mixpanelIntegrationQueue.ts",
            "description": "This file defines BullMQ queue processors responsible for handling Mixpanel integration tasks. It includes processors for scheduling general integration jobs and for processing specific Mixpanel data for individual projects.",
            "spof": true
          },
          {
            "path": "worker/src/features/mixpanel/handleMixpanelIntegrationSchedule.ts",
            "description": "This file schedules jobs to process Mixpanel integrations for all enabled projects by querying the database and adding them to a processing queue.",
            "spof": true
          },
          {
            "path": "worker/src/features/mixpanel/mixpanelClient.ts",
            "description": "This file defines a `MixpanelClient` class responsible for batching and sending analytical events to the Mixpanel Import API, handling compression and authentication.",
            "spof": true
          },
          {
            "path": "worker/src/features/mixpanel/handleMixpanelIntegrationProjectJob.ts",
            "description": "This file defines a worker job responsible for processing and synchronizing project data (traces, generations, and scores) with Mixpanel for analytics. It fetches data, transforms it, sends it to Mixpanel, and updates the last synchronization timestamp for the project's Mixpanel integration.",
            "spof": true
          },
          {
            "path": "worker/src/features/mixpanel/transformers.ts",
            "description": "This file provides functions to transform Langfuse analytics events (trace, generation, score) into a format compatible with Mixpanel's event tracking API. It generates unique IDs and maps relevant properties for Mixpanel ingestion.",
            "spof": true
          },
          {
            "path": "worker/src/features/posthog/handlePostHogIntegrationSchedule.ts",
            "description": "This file defines a function to schedule processing jobs for enabled PostHog integrations. It retrieves all active integrations and adds them to a processing queue, ensuring unique job IDs based on project and last sync time.",
            "spof": true
          },
          {
            "path": "worker/src/features/posthog/handlePostHogIntegrationProjectJob.ts",
            "description": "This file defines a BullMQ job handler responsible for integrating Langfuse project data (traces, generations, and scores) with PostHog. It fetches data within a specified time range, transforms it, and sends it to PostHog using the PostHog Node.js SDK.",
            "spof": false
          },
          {
            "path": "worker/src/features/posthog/transformers.ts",
            "description": "This file contains functions to transform Langfuse analytics events (traces, generations, and scores) into a PostHog-compatible event format. It handles ID generation, session mapping, and user identification for PostHog.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/mixpanelIntegrationProcessingQueue.ts",
            "description": "This file defines a singleton class that manages a Redis-backed BullMQ queue specifically for processing Mixpanel integration tasks. It handles queue instantiation, configuration, and error logging.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/mixpanelIntegrationQueue.ts",
            "description": "This file defines a singleton class `MixpanelIntegrationQueue` responsible for initializing and managing a BullMQ queue specifically for Mixpanel integration tasks, including scheduling a recurring job.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/postHogIntegrationProcessingQueue.ts",
            "description": "This file defines and manages a singleton instance of a BullMQ queue specifically for processing PostHog integration-related tasks using Redis. It configures the queue with retry options and error handling.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/postHogIntegrationQueue.ts",
            "description": "This file defines and manages a singleton BullMQ queue, backed by Redis, specifically for PostHog integration tasks. It initializes the queue and schedules a recurring job to run every hour at 30 minutes past.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Marc Klingen",
            "percent": 69
          },
          {
            "name": "Max Deichmann",
            "percent": 8
          },
          {
            "name": "Nimar",
            "percent": 6
          }
        ]
      },
      "Data Export to Cloud Storage": {
        "files": [
          {
            "path": "web/src/__tests__/async/blob-storage-integration-api.servertest.ts",
            "description": "This file contains asynchronous integration tests for the Blob Storage Integrations API. It verifies the functionality of creating, retrieving, updating, and deleting blob storage integrations via the public API.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/integrations/blob-storage/[id].ts",
            "description": "This API endpoint handles the deletion of a specific blob storage integration, requiring organization-scoped authentication and the 'scheduled-blob-exports' entitlement.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/integrations/blob-storage/index.ts",
            "description": "This file defines a public API endpoint for managing blob storage integrations. It allows authorized users to retrieve existing integrations for an organization's projects and to create or update a specific blob storage integration for a project.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/settings/integrations/blobstorage.tsx",
            "description": "This file implements a React page for managing project-specific blob storage integration settings. It allows users to configure and view the status of scheduled exports of trace data to services like AWS S3 or Azure Blob Storage.",
            "spof": true
          },
          {
            "path": "web/src/features/blobstorage-integration/types.ts",
            "description": "This file defines the Zod schema and TypeScript type for blob storage integration form data, including validation rules for various fields like bucket name, region, export frequency, and file type.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-exports/README.md",
            "description": "This file provides documentation and an overview for the batch exports feature within the Langfuse web application, detailing the location of its types and export logic.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-exports/components/BatchExportsSettingsPage.tsx",
            "description": "This file defines the `BatchExportsSettingsPage` React component, which displays the batch exports management interface for a project. It includes a table of batch exports and handles access control based on user permissions.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/types/blob-storage-integrations.ts",
            "description": "This file defines Zod schemas for blob storage integration types, file types, and export modes, along with the request and response structures for managing these integrations via a public API.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/blobStorageIntegrationProcessing.test.ts",
            "description": "This file contains integration tests for the blob storage processing job, ensuring that data (traces, observations, and scores) is correctly exported to S3-compatible storage based on configured blob storage integrations and frequencies.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/encryptBlobStorageSecrets.ts",
            "description": "This file defines a background migration that encrypts previously unencrypted `secretAccessKey` values in the `blob_storage_integrations` table. It identifies unencrypted secrets by attempting decryption and encrypts them if decryption fails, ensuring all such secrets are stored securely.",
            "spof": true
          },
          {
            "path": "worker/src/queues/coreDataS3ExportQueue.ts",
            "description": "This file defines a BullMQ processor responsible for exporting core database data (e.g., projects, users, organizations) to an S3 bucket. It fetches data from Prisma, formats it as JSONL, and uploads it to S3.",
            "spof": true
          },
          {
            "path": "worker/src/queues/blobStorageIntegrationQueue.ts",
            "description": "This file defines BullMQ processors for handling blob storage integration tasks. It includes a processor for scheduling integration jobs and another for processing individual project-level blob storage integration jobs.",
            "spof": true
          },
          {
            "path": "worker/src/queues/batchExportQueue.ts",
            "description": "This file defines the processor for the batch export queue, handling the execution of batch export jobs and updating their status in the database based on success or failure.",
            "spof": false
          },
          {
            "path": "worker/src/features/blobstorage/handleBlobStorageIntegrationSchedule.ts",
            "description": "This file defines a scheduled handler that identifies blob storage integrations due for synchronization and adds them to a processing queue.",
            "spof": true
          },
          {
            "path": "worker/src/features/blobstorage/handleBlobStorageIntegrationProjectJob.ts",
            "description": "This file contains the logic for handling a job to export project data (traces, observations, and scores) to a configured blob storage integration. It manages data synchronization, formatting, and uploading to cloud storage services like AWS S3 or Azure Blob Storage.",
            "spof": true
          },
          {
            "path": "worker/src/features/batchExport/handleBatchExportJob.ts",
            "description": "This file defines the handler for batch export jobs, responsible for retrieving data from the database, transforming it, uploading it to cloud storage (S3), and updating the job status and notifying the user.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/blobStorageIntegrationProcessingQueue.ts",
            "description": "This file defines a singleton class for managing a BullMQ queue specifically designed for processing blob storage integration tasks using Redis.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/batchExport.ts",
            "description": "This file defines and manages a singleton BullMQ queue specifically for handling batch export operations, including its connection, job options, and error handling.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/coreDataS3ExportQueue.ts",
            "description": "This file defines and manages a BullMQ queue responsible for scheduling and executing the daily export of core application data to S3, if enabled by environment variables.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/email/batchExportSuccess/sendBatchExportSuccessEmail.ts",
            "description": "This file defines a service function for sending a batch export success email to a user, notifying them that their data export is ready for download. It uses Nodemailer to send a rendered email template containing the download link and export details.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/email/batchExportSuccess/BatchExportSuccessEmailTemplate.tsx",
            "description": "This file defines a React component for an email template. It is used to notify users about the successful completion of a batch data export and provides a download link for the exported data.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/batchExport/types.ts",
            "description": "This file defines enums, types, and Zod schemas for batch export operations, including export status, file formats, and query parameters for creating and managing exports.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Steffen Schmitz",
            "percent": 74
          },
          {
            "name": "Max Deichmann",
            "percent": 13
          },
          {
            "name": "marliessophie",
            "percent": 3
          }
        ]
      },
      "Automation Rule Engine": {
        "files": [
          {
            "path": "web/src/__tests__/async/automations-trpc.servertest.ts",
            "description": "This file contains server-side integration tests for the TRPC API related to automations. It verifies the functionality of fetching automation configurations, ensuring sensitive data like secret keys and headers are not exposed.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/automations.tsx",
            "description": "This file serves as the page component for displaying automations within a specific project, re-exporting the main automations feature component.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/AutomationButton.tsx",
            "description": "This file defines the `AutomationButton` React component, which provides a button to navigate to the automations page for a specific project, displays the number of automations, and checks user access permissions.",
            "spof": false
          },
          {
            "path": "web/src/features/automations/components/AutomationExecutionsTable.tsx",
            "description": "This file defines a React component, `AutomationExecutionsTable`, responsible for displaying a data table of historical executions for a specific automation, including status, start time, duration, input, output, and any errors.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/AutomationFailureBanner.tsx",
            "description": "This file defines a React component `AutomationFailureBanner` that displays an alert when an automation has experienced a significant number of consecutive failures, indicating it has been automatically disabled and providing instructions for reactivation.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/AutomationDetails.tsx",
            "description": "This React component displays the details of a specific automation, allowing users to view its configuration, execution history, and provides options to edit or delete the automation.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/automations.tsx",
            "description": "This file defines the main page component for managing automations, including displaying a list of automations, showing details of a selected automation, and providing forms for creating or editing automations within a project.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/AutomationSidebar.tsx",
            "description": "This React component renders a sidebar displaying a list of automations for a specific project, allowing users to view their status and details, and select an automation from the list.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/automationForm.tsx",
            "description": "This file defines the `AutomationForm` React component, which provides a user interface for creating and editing automation rules. It handles form state, validation, and API interactions for different action types like Webhooks, Slack, and GitHub Dispatch.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/DeleteAutomationButton.tsx",
            "description": "This component provides a button or icon to delete an automation, including a confirmation popover, project access checks, and success notifications.",
            "spof": true
          },
          {
            "path": "worker/src/features/entityChange/entityChangeWorker.ts",
            "description": "This worker processes entity change events, delegating them to specific handlers based on the entity type. Currently, it dispatches events related to 'prompt-version' to the `promptVersionProcessor`.",
            "spof": false
          },
          {
            "path": "worker/src/features/entityChange/promptVersionProcessor.ts",
            "description": "This file defines a processor for prompt version change events. It evaluates configured automation triggers against these events and enqueues corresponding actions, such as webhooks or Slack notifications, for execution.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/automation-repository.ts",
            "description": "This file provides data access methods for managing automations, triggers, and actions within the application, including fetching configurations, handling secret decryption for webhook headers, and calculating consecutive automation failures.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Max Deichmann",
            "percent": 69
          },
          {
            "name": "Thorsten Spieker",
            "percent": 30
          },
          {
            "name": "Nimar",
            "percent": 1
          }
        ]
      },
      "Slack Workspace Integration": {
        "files": [
          {
            "path": "web/src/__tests__/async/slack-integration.servertest.ts",
            "description": "This file contains server-side asynchronous tests for the Slack integration features of the Langfuse application, specifically verifying the tRPC router's functionalities for managing integration status, fetching channels, and sending test messages, while ensuring sensitive data is not exposed.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/slack/install/index.ts",
            "description": "This API endpoint initiates the Slack app installation process for a specific project. It handles authentication, ensures the user has proper project access, and then delegates to the Slack OAuth handler to generate the installation URL and manage the OAuth flow.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/slack/oauth/index.ts",
            "description": "This file defines a Next.js API route that handles the Slack OAuth callback, processing the authentication flow, exchanging codes for tokens, storing the installation, and redirecting the user.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/settings/integrations/slack.tsx",
            "description": "This file implements the Slack integration settings page for a specific project, allowing users to connect/disconnect Slack, handle OAuth flow, and test sending messages to selected Slack channels.",
            "spof": true
          },
          {
            "path": "web/src/features/slack/README.md",
            "description": "This guide details the setup and testing process for the Langfuse Slack integration, primarily for local development environments, covering prerequisites, configuration, and troubleshooting.",
            "spof": true
          },
          {
            "path": "web/src/features/slack/components/SlackTestMessageButton.tsx",
            "description": "This file defines a React component, `SlackTestMessageButton`, which provides a UI button to send a test message to a specified Slack channel. It handles API calls, loading states, and toast notifications for success or failure.",
            "spof": true
          },
          {
            "path": "web/src/features/slack/components/SlackDisconnectButton.tsx",
            "description": "This file defines a React component, `SlackDisconnectButton`, which allows users to disconnect a Slack integration from a project. It includes functionality for a confirmation dialog, API calls for disconnection, and displays loading and status messages.",
            "spof": true
          },
          {
            "path": "web/src/features/slack/components/SlackConnectionCard.tsx",
            "description": "A React component that displays and manages the Slack integration status for a specific project. It allows users to connect, disconnect, and view details of their Slack workspace connection.",
            "spof": true
          },
          {
            "path": "web/src/features/slack/components/ChannelSelector.tsx",
            "description": "This React component provides a UI for selecting Slack channels within a project. It fetches, filters, and displays channels, including search functionality, status indicators, and refresh capabilities.",
            "spof": true
          },
          {
            "path": "web/src/features/slack/components/SlackConnectButton.tsx",
            "description": "This file defines a React component (`SlackConnectButton`) that facilitates connecting a project to Slack using an OAuth flow via a popup window. It manages the connection state, handles success/error callbacks, and displays appropriate UI feedback.",
            "spof": true
          },
          {
            "path": "web/src/features/slack/server/slack-webhook.ts",
            "description": "This file provides a utility function to send messages to a Slack channel using a configured webhook, primarily for team notifications or alerts.",
            "spof": false
          },
          {
            "path": "web/src/features/slack/server/oauth-handlers.ts",
            "description": "This file provides the server-side Next.js API handlers for managing the Slack OAuth installation flow. It includes functions to initiate the installation process and handle the callback from Slack, saving the integration details and logging the event.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/slack-processor.test.ts",
            "description": "This file contains unit tests for the Slack processor, verifying its functionality including message sending, template handling, and error scenarios. It ensures the Slack integration works as expected within the automation system.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/slack-message-builder.test.ts",
            "description": "This file contains unit tests for the `SlackMessageBuilder` class, verifying its ability to correctly format and construct Slack messages for different Langfuse events, such as prompt version changes and generic fallback notifications.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/SlackService.ts",
            "description": "This file implements a Slack integration service responsible for managing OAuth flows, storing and retrieving Slack installations per project, and providing methods to interact with the Slack API, such as sending messages and fetching channels.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Thorsten Spieker",
            "percent": 92
          },
          {
            "name": "Steffen Schmitz",
            "percent": 6
          },
          {
            "name": "ukasz Jerna",
            "percent": 1
          }
        ]
      },
      "LLM Tool & Adapter Framework (MCP)": {
        "files": [
          {
            "path": "web/src/pages/api/public/llm-connections/index.ts",
            "description": "This file defines a public API endpoint (`/api/public/llm-connections`) for managing LLM connections (API keys) within a project. It supports retrieving a paginated list of connections and securely creating or updating them, including encryption of sensitive credentials.",
            "spof": true
          },
          {
            "path": "web/src/utils/chatml/adapters/gemini.ts",
            "description": "This file exports the Gemini adapter for ChatML from the shared Langfuse library, providing a specific interface for Gemini within the application's utility functions.",
            "spof": true
          },
          {
            "path": "web/src/utils/chatml/adapters/langgraph.ts",
            "description": "This file re-exports the `langgraphAdapter` from the `@langfuse/shared` package, making it available for use within the Langfuse web application's ChatML utilities.",
            "spof": true
          },
          {
            "path": "web/src/utils/chatml/adapters/pydantic-ai.ts",
            "description": "This file re-exports the `pydanticAIAdapter` from the shared Langfuse library, providing an adapter for pydantic-ai integration within the ChatML utilities for the web application.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/core/define-tool.ts",
            "description": "This file provides a utility function (`defineTool`) for defining 'MCP' tools. It automates the generation of JSON schemas from Zod schemas for tool input validation and wraps tool handlers with error handling.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/server/mcpServer.ts",
            "description": "This file configures and initializes a stateless Model Context Protocol (MCP) server instance for handling tool-related requests. It dynamically loads available tools from a registry and processes calls to these tools within a fresh, per-request context.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/server/registry.ts",
            "description": "This file implements a global singleton `ToolRegistry` for MCP (Multi-Cloud Platform) features, managing the registration, discovery, and execution of tools provided by different feature modules within the application.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/chatml/adapters/pydantic-ai.test.ts",
            "description": "This file contains unit tests for the pydanticAIAdapter, ensuring it correctly normalizes and parses ChatML messages, including tool calls and thinking parts, within the Langfuse project. It verifies the adapter's ability to handle various message roles and structured content from pydantic-ai integrations.",
            "spof": true
          },
          {
            "path": "packages/shared/src/interfaces/customLLMProviderConfigSchemas.ts",
            "description": "This file defines Zod schemas and TypeScript types for configuring various custom Large Language Model (LLM) providers like AWS Bedrock and Google Cloud Vertex AI, including their authentication credentials.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/chatml/adapters/pydantic-ai.ts",
            "description": "This file provides a `ProviderAdapter` for the `pydantic-ai` framework, responsible for detecting and normalizing its unique parts-based message format, including tool calls, tool responses, and tool definitions, into a standardized structure.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Nimar",
            "percent": 83
          },
          {
            "name": "Michael Frhlich",
            "percent": 13
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 4
          }
        ]
      },
      "Asynchronous Job Processing Framework": {
        "files": [
          {
            "path": "web/src/pages/api/admin/bullmq/index.ts",
            "description": "This API route provides administrative functionalities for managing BullMQ queues, including retrieving job counts, retrying failed jobs, and removing jobs by status. It's primarily used by Langfuse Cloud for operational oversight of background tasks.",
            "spof": false
          },
          {
            "path": "web/src/features/batch-actions/server",
            "description": "This directory is intended to house server-side logic and API endpoints specifically for handling batch actions within the web application. It would contain the backend components responsible for processing multiple operations simultaneously.",
            "spof": false
          },
          {
            "path": "worker/src/backgroundMigrations/IBackgroundMigration.ts",
            "description": "This file defines the `IBackgroundMigration` interface, outlining the contract for background migration tasks within the worker service. It specifies methods for validating migration arguments, executing the migration, and aborting it.",
            "spof": false
          },
          {
            "path": "worker/src/queues/batchActionQueue.ts",
            "description": "This file defines the processor for the 'BatchActionQueue', responsible for handling and executing batch action jobs. It logs the job's progress and delegates the core logic to the 'handleBatchActionJob' function, including error handling and tracing.",
            "spof": false
          },
          {
            "path": "worker/src/queues/entityChangeQueue.ts",
            "description": "This file defines the processor for the entity change queue, responsible for handling and executing entity change events within the worker service. It processes jobs from the queue by invoking the entityChangeWorker.",
            "spof": false
          },
          {
            "path": "worker/src/queues/workerManager.ts",
            "description": "Manages and registers BullMQ workers for various queues, incorporating metric collection, error handling, and lifecycle management for worker instances.",
            "spof": true
          },
          {
            "path": "worker/src/scripts/refillQueueEvent/index.ts",
            "description": "This script reads events from a JSONL file, validates them against a schema, and then enqueues them in batches into a message queue for processing, such as for project deletion tasks.",
            "spof": true
          },
          {
            "path": "worker/src/ee/dataRetention/handleDataRetentionSchedule.ts",
            "description": "This file is responsible for scheduling data retention processing. It identifies projects with active data retention policies and adds corresponding jobs to a processing queue.",
            "spof": true
          },
          {
            "path": "worker/src/features/batchAction/handleBatchActionJob.ts",
            "description": "This file defines the handler for batch action jobs, processing various tasks such as deleting traces and scores, adding entities to annotation queues, creating evaluations, and adding observations to datasets based on specified criteria.",
            "spof": false
          },
          {
            "path": "worker/src/services/dlq/dlqRetryService.ts",
            "description": "This file defines a service that periodically retries failed jobs found in specified dead-letter queues (DLQs). It iterates through predefined queues, retrieves failed jobs, records metrics, and attempts to re-process them.",
            "spof": true
          },
          {
            "path": "packages/shared/src/interfaces/tableNames.ts",
            "description": "This file defines a centralized enumeration of database table names (`BatchTableNames`) used consistently across various batch operations (e.g., exports, actions). Its purpose is to prevent coupling between different batch operation types by providing a single source of truth for table names.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/blobStorageIntegrationQueue.ts",
            "description": "This file defines and manages a BullMQ Redis queue for handling blob storage integration tasks. It sets up a recurring job to execute these tasks hourly.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/eventPropagationQueue.ts",
            "description": "This file defines a singleton factory for a BullMQ queue named `EventPropagationQueue`. It configures the queue for event propagation, enforces sequential processing by setting global concurrency to 1, and schedules a recurring job to run every minute.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/notificationQueue.ts",
            "description": "This file defines a singleton class for managing a BullMQ-based notification queue, responsible for creating and configuring the Redis-backed queue for handling notifications.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/entityChangeQueue.ts",
            "description": "This file defines a singleton class, `EntityChangeQueue`, which provides a centralized BullMQ queue instance for processing entity change events. It handles the instantiation and configuration of this specific queue.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/dlqRetryQueue.ts",
            "description": "This file defines a singleton class `DeadLetterRetryQueue` that initializes and manages a BullMQ queue for processing dead-lettered jobs. It schedules a recurring job to run every 10 minutes, attempting to retry failed tasks.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230907204921_add_cron_jobs_table",
            "description": "This directory contains a specific Prisma migration script. Its role is to define the database schema changes required to add a 'cron_jobs' table, as indicated by the timestamped name.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230910164603_cron_add_state",
            "description": "This directory contains a specific Prisma database migration script. It is responsible for applying schema changes, likely adding a 'state' column related to cron jobs, to the database as part of a version-controlled evolution.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231119171939_cron_add_job_started_at",
            "description": "This directory contains a specific Prisma database migration script, timestamped `20231119171939`, which is responsible for adding the `job_started_at` column to a table, likely for managing cron job states. It is part of the shared Prisma migrations for the `langfuse` project.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Steffen Schmitz",
            "percent": 47
          },
          {
            "name": "Max Deichmann",
            "percent": 33
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 6
          }
        ]
      },
      "Internal Developer Automation Framework (Claude Hooks)": {
        "files": [
          {
            "path": "web/src/features/README.md",
            "description": "This README provides guidelines and instructions for developing, testing, and refactoring public API routes for the Langfuse web application, focusing on best practices for type-safety, error handling, and integration.",
            "spof": true
          },
          {
            "path": ".claude/hooks/CONFIG.md",
            "description": "This file is a configuration guide for the hooks system within a Claude project, detailing how to set up, customize, troubleshoot, and manage various automation scripts and integrations.",
            "spof": true
          },
          {
            "path": ".claude/hooks/README.md",
            "description": "This file provides documentation for Claude Code hooks, explaining their purpose, how they work, and detailing essential hooks for skill auto-activation and file change tracking, including integration instructions.",
            "spof": true
          },
          {
            "path": ".claude/hooks/error-handling-reminder.ts",
            "description": "This file is a Claude hook script that analyzes recently edited code files (TypeScript/JavaScript) and provides error handling best practice reminders based on file category (frontend, backend, database) and code patterns (e.g., try/catch, async, Prisma, API calls). It aims to prompt developers to consider error handling strategies.",
            "spof": true
          },
          {
            "path": ".claude/skills/skill-developer/ADVANCED.md",
            "description": "This document outlines advanced topics and future enhancements for the skill system, detailing potential improvements like dynamic rule updates, skill dependencies, analytics, and a testing framework.",
            "spof": true
          },
          {
            "path": ".claude/skills/skill-developer/SKILL.md",
            "description": "This document serves as a comprehensive guide for creating and managing Claude Code skills, detailing their structure, activation mechanisms, enforcement levels, and best practices for development and testing.",
            "spof": true
          },
          {
            "path": ".claude/skills/skill-developer/HOOK_MECHANISMS.md",
            "description": "This document provides a technical deep dive into Claude's hook mechanisms, specifically detailing the `UserPromptSubmit` and `PreToolUse` hooks. It covers their execution flow, input/output formats, critical exit code behavior, session state management, and performance considerations.",
            "spof": true
          },
          {
            "path": ".claude/skills/skill-developer/PATTERNS_LIBRARY.md",
            "description": "This file serves as a library of common regex and glob patterns for defining skill triggers, categorized by intent, file path, and content. It provides ready-to-use examples for developers to customize and integrate into their skill definitions.",
            "spof": true
          },
          {
            "path": ".claude/skills/skill-developer/TRIGGER_TYPES.md",
            "description": "This document provides a comprehensive guide to configuring skill triggers in Claude Code's auto-activation system, detailing various trigger types like keywords, intent patterns, file paths, and content patterns. It includes configuration examples, use cases, and best practices for each trigger.",
            "spof": true
          },
          {
            "path": ".claude/skills/skill-developer/SKILL_RULES_REFERENCE.md",
            "description": "This document serves as a complete reference guide for configuring `skill-rules.json`, detailing the schema, field explanations, and examples for defining skills and their auto-activation trigger conditions.",
            "spof": true
          },
          {
            "path": ".claude/skills/README.md",
            "description": "This file is a comprehensive guide to Claude Code skills, explaining what they are, how to integrate and configure them using `skill-rules.json`, and how to create new skills for automated context-based activation.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Max Deichmann",
            "percent": 100
          }
        ]
      },
      "Customer Support & Feedback Integration": {
        "files": [
          {
            "path": "web/src/features/support-chat/formConstants.ts",
            "description": "This file defines Zod schemas and related types for a support chat form, including constants for message types, form sections, topics, severity levels, and integration types, along with the overall form validation schema.",
            "spof": true
          },
          {
            "path": "web/src/features/support-chat/IntroSection.tsx",
            "description": "This component renders an introductory section for support and resources, dynamically displaying options like 'Ask AI', documentation, and various community/support channels based on UI customization and cloud deployment status.",
            "spof": true
          },
          {
            "path": "web/src/features/support-chat/plain/plainConstants.ts",
            "description": "This file defines client-safe constants for Plain API integration, such as the maximum allowed file size for attachments. These constants are designed to be safely imported and used in both client and server-side code.",
            "spof": true
          },
          {
            "path": "web/src/features/support-chat/plain/plainClient.ts",
            "description": "This file provides a client module for interacting with the Plain customer support API. It handles initialization, customer and tenant synchronization, attachment uploads, and error formatting for Plain API calls.",
            "spof": true
          },
          {
            "path": "web/src/features/support-chat/plain/events/supportRequestMetadataEvent.ts",
            "description": "This file defines a utility function that transforms support request metadata into a structured set of UI components, suitable for display as an event within the Plain platform's support chat interface.",
            "spof": true
          },
          {
            "path": "web/src/features/support-chat/trpc",
            "description": "This directory is intended to house the tRPC (TypeScript Remote Procedure Calls) client-side definitions or router for the 'support-chat' feature. It would facilitate type-safe communication between the web frontend and the backend API for support chat functionalities.",
            "spof": false
          },
          {
            "path": "web/src/features/feedback/server/feedbackHandler.ts",
            "description": "This file defines an API handler for collecting user feedback, processing it with CORS middleware, and sending it to a Slack channel. It primarily serves to collect feedback from users of the non-cloud version of the application.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 98
          },
          {
            "name": "Lotte Verheyden",
            "percent": 2
          },
          {
            "name": "Nimar",
            "percent": 1
          }
        ]
      },
      "Automation Action Handling": {
        "files": [
          {
            "path": "web/src/features/automations/components/WebhookSecretRender.tsx",
            "description": "This file defines a React component `WebhookSecretRender` responsible for displaying a webhook secret and providing instructions on its usage and regeneration within the UI.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/actions/index.ts",
            "description": "Exports various automation action handlers (Webhook, Slack, GitHubDispatch) and their registry. It serves as a central index for different automation action implementations.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/actions/SlackActionHandler.ts",
            "description": "This file defines the `SlackActionHandler` class, which manages the logic for Slack actions within an automation feature. It handles data schema, default values, validation, and rendering the UI for configuring Slack notifications.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/actions/GitHubDispatchActionHandler.tsx",
            "description": "This file defines the `GitHubDispatchActionHandler` class, which manages the schema, validation, form data handling, and UI rendering for GitHub Dispatch actions within an automation feature.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/actions/ActionHandlerRegistry.ts",
            "description": "This file defines a static registry for managing different types of automation action handlers. It provides methods to register, retrieve, and query specific action implementations based on their type, such as Webhook, Slack, or GitHub Dispatch.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/actions/SlackActionForm.tsx",
            "description": "This component provides a form for configuring Slack integration settings for an automation action, allowing users to connect Slack, select a channel, and test the connection.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/actions/WebhookActionHandler.tsx",
            "description": "This file defines the `WebhookActionHandler` class, which manages the lifecycle of webhook actions within an automation system. It includes schema definition, parsing, validation, and rendering logic for webhook configurations.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/actions/GitHubDispatchActionForm.tsx",
            "description": "This file defines a React component that provides a form for configuring a GitHub Repository Dispatch action. It allows users to input the repository URL, event type, and a GitHub Personal Access Token to trigger workflows.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/actions/BaseActionHandler.ts",
            "description": "This file defines the `BaseActionHandler` interface, which specifies the common methods and properties for managing different types of automation actions. It provides a standardized structure for rendering forms, validating data, and building API configurations for various actions.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/components/actions/WebhookActionForm.tsx",
            "description": "This file defines a React component, `WebhookActionForm`, which provides a user interface for configuring webhook actions, including setting the URL, API version, and managing custom and secret headers.",
            "spof": true
          },
          {
            "path": "web/src/features/automations/server/webhookHelpers.ts",
            "description": "This file contains server-side helper functions for processing and managing webhook action configurations, including URL validation, secret key generation and encryption, and intelligent handling of request headers with secret values.",
            "spof": false
          },
          {
            "path": "web/src/features/automations/server/githubDispatchHelpers.ts",
            "description": "This file provides utility functions for processing, validating, and securing configurations related to GitHub dispatch automation actions, including URL and token handling.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/signature.test.ts",
            "description": "This file contains unit tests for functions related to webhook signature generation, display, and verification, ensuring secure communication for webhooks within the Langfuse application.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/url-normalization.test.ts",
            "description": "This file contains unit tests for URL normalization and validation, specifically focusing on various edge cases and security bypass attempts for webhook URLs. It ensures the `validateWebhookURL` function correctly identifies and rejects malformed, internal, or maliciously crafted URLs.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/webhook-validation.test.ts",
            "description": "This file contains unit tests for the `validateWebhookURL` function, ensuring it correctly validates webhook URLs by accepting valid public HTTP/HTTPS URLs and rejecting invalid syntax, disallowed protocols, ports, private/reserved IP addresses, localhost, and blocked internal hostnames, while also supporting whitelisting.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/webhook-redirect.test.ts",
            "description": "This file contains functional tests for the webhook system, specifically verifying its ability to correctly follow HTTP redirects and handle related edge cases. It ensures that webhooks can follow single, multiple, and relative redirects to valid URLs.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/webhooks.test.ts",
            "description": "This file contains integration tests for the webhook execution functionality within the Langfuse application, covering scenarios like successful execution, signature validation, and error handling when dispatching webhooks.",
            "spof": false
          },
          {
            "path": "worker/src/queues/webhooks.ts",
            "description": "This file contains the core logic for processing and executing various automated actions, including webhooks, Slack notifications, and GitHub dispatches. It handles job processing, HTTP requests with retries and timeouts, and manages execution status and failure conditions.",
            "spof": true
          },
          {
            "path": "worker/src/features/slack/slackMessageBuilder.ts",
            "description": "This file defines a `SlackMessageBuilder` class responsible for constructing Slack Block Kit messages for various Langfuse event types. It currently specializes in formatting notifications for prompt version creation, updates, and deletion.",
            "spof": true
          },
          {
            "path": "packages/shared/src/domain/webhooks.ts",
            "description": "This file defines Zod schemas for various webhook structures, including base webhook outbound schemas, prompt-version webhooks, and GitHub dispatch webhooks, along with their derived TypeScript types.",
            "spof": true
          },
          {
            "path": "packages/shared/src/domain/automations.ts",
            "description": "Defines domain models for automation triggers and actions, including Zod schemas for validating different action configurations (Webhook, Slack, GitHub Dispatch) and their 'safe' counterparts without sensitive data. It also provides type guards and conversion functions for these configurations.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/webhookQueue.ts",
            "description": "This file defines a singleton class, `WebhookQueue`, which provides and manages a BullMQ queue specifically for processing webhook jobs. It handles the Redis connection and configuration for the webhook queue.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/webhooks/redirectHandler.ts",
            "description": "This file provides a secure `fetch` function that manually handles and validates redirects to prevent Server-Side Request Forgery (SSRF) attacks, ensuring each redirect target is safe before following it.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/webhooks/ipBlocking.ts",
            "description": "Provides utility functions to check if an IP address or hostname is blocked, primarily for Server-Side Request Forgery (SSRF) protection. It uses static deny-lists for private, reserved, and internal network ranges/hostnames, and supports whitelisting.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Max Deichmann",
            "percent": 75
          },
          {
            "name": "Thorsten Spieker",
            "percent": 21
          },
          {
            "name": "Marc Klingen",
            "percent": 2
          }
        ]
      },
      "User Notification Dispatch": {
        "files": [
          {
            "path": "worker/src/queues/notificationQueue.ts",
            "description": "This file defines the processor for the notification queue, responsible for handling and dispatching various types of notifications, such as comment mentions, based on incoming job data.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/email/commentMention/sendCommentMentionEmail.ts",
            "description": "This file defines a function to send an email notification to a user who has been mentioned in a comment within a project, handling email templating, environmental configuration, and input sanitization.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/email/commentMention/CommentMentionEmailTemplate.tsx",
            "description": "This file defines a React component for the email template that notifies a user when they have been mentioned in a comment within a project. It uses `@react-email/components` to construct the email's HTML structure and content.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 100
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 151,
      "spofCount": 119
    },
    "busFactor": 2,
    "authorCount": 10
  },
  "Utility": {
    "description": "",
    "functions": {
      "General Utility": {
        "files": [
          {
            "path": "web/src/components/LocalIsoDate.tsx",
            "description": "Provides utility functions and a React component for formatting and displaying dates in a local ISO-like format, with customizable accuracy and a UTC tooltip.",
            "spof": true
          },
          {
            "path": "web/src/components/useLocalStorage.tsx",
            "description": "This file provides a React hook (`useLocalStorage`) for managing state that is persisted in the browser's local storage. It includes features for safe interaction, cross-tab synchronization, and initial value handling.",
            "spof": true
          },
          {
            "path": "web/src/components/JSONSchemaEditor.tsx",
            "description": "This file defines a reusable React component, `JSONSchemaEditor`, for editing JSON Schema. It currently provides a text-based JSON editor with a prettify function, designed with future extensions for a visual schema builder.",
            "spof": true
          },
          {
            "path": "web/src/components/date-picker.tsx",
            "description": "Provides reusable React components for date and time selection, including single date picking, date range selection with time, and predefined time range picking, often used in dashboards or forms.",
            "spof": true
          },
          {
            "path": "web/src/components/PagedSettingsContainer.tsx",
            "description": "This component provides a reusable container for displaying paginated settings or content, offering both mobile-friendly dropdown navigation and a desktop sidebar navigation. It dynamically renders the content of the active page or navigates to an external link.",
            "spof": true
          },
          {
            "path": "web/src/components/DiffViewer.tsx",
            "description": "This React component, `DiffViewer`, visualizes differences between two text strings. It displays side-by-side comparisons, highlighting added, removed, and changed content at both line and word levels for clear review.",
            "spof": false
          },
          {
            "path": "web/src/components/NoDataOrLoading.tsx",
            "description": "This file defines a React component that displays a loading skeleton when data is being fetched or a 'no data' message when no data is available, optionally including a documentation popup.",
            "spof": true
          },
          {
            "path": "web/src/components/useSessionStorage.tsx",
            "description": "Provides a React hook (`useSessionStorage`) for managing and persisting state in the browser's session storage.",
            "spof": true
          },
          {
            "path": "web/src/components/Slider.tsx",
            "description": "This file defines a reusable React Slider component (a toggle switch) built using `@headlessui/react`'s `Switch` component. It provides props for controlling its checked, disabled, and loading states with Tailwind CSS for styling.",
            "spof": false
          },
          {
            "path": "web/src/components/editor/light-theme.ts",
            "description": "This file defines and exports a light theme configuration for a CodeMirror editor, specifying its base settings and styling rules for various syntax elements.",
            "spof": true
          },
          {
            "path": "web/src/components/editor/shared-theme.ts",
            "description": "This file defines shared theme settings and styling rules for a CodeMirror editor component, specifying default colors and syntax highlighting for various code elements.",
            "spof": true
          },
          {
            "path": "web/src/components/schemas/MarkdownSchema.ts",
            "description": "This file defines Zod schemas for validating markdown content, including a regex to detect various markdown patterns. It provides `MarkdownSchema` for strings containing markdown and `StringOrMarkdownSchema` which allows either a plain string or markdown.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/Codeblock.tsx",
            "description": "This file defines a reusable React component named `CodeBlock` that displays syntax-highlighted code with a copy-to-clipboard functionality, supporting various programming languages.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/button.tsx",
            "description": "This file defines a reusable React `Button` component, supporting various visual styles (variants) and sizes, including a loading state with a spinner. It uses `class-variance-authority` for flexible styling and `radix-ui/react-slot` for render customization.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/accordion.tsx",
            "description": "This file defines a reusable Accordion UI component using Radix UI primitives and Tailwind CSS for styling. It provides components for the Accordion root, individual items, triggers, and content sections.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/alert.tsx",
            "description": "This file defines reusable React components for an `Alert` UI element, including `AlertTitle` and `AlertDescription`, leveraging `class-variance-authority` for variant-based styling and Tailwind CSS for utility classes.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/badge.tsx",
            "description": "This file defines a reusable React UI component for a badge, offering various visual styles (variants) and sizes through `class-variance-authority`.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/MarkdownJsonView.tsx",
            "description": "This component intelligently renders content as either Markdown or pretty-printed JSON, depending on its format and a character limit, and provides a customizable header with copy functionality.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/MarkdownViewer.tsx",
            "description": "This component renders markdown content using `react-markdown`, providing custom components for styling and enhancing various markdown elements like links, code blocks, images, and mentions.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/checkbox.tsx",
            "description": "This file defines and exports a reusable UI Checkbox component. It uses Radix UI for accessibility and functionality, Lucide React for the check icon, and Tailwind CSS for styling.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/breadcrumb.tsx",
            "description": "This file defines a set of reusable React components for building a breadcrumb navigation UI, including components for the main container, list, item, link, current page, separator, and ellipsis. It leverages Radix UI's Slot and Tailwind CSS for styling.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/password-input.tsx",
            "description": "This file defines a React component for a password input field that includes a toggle button to show or hide the entered password. It provides a customizable UI component for secure password entry.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/radio-group.tsx",
            "description": "This file defines reusable RadioGroup and RadioGroupItem UI components, built upon Radix UI primitives and styled with Tailwind CSS, for use within the application.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/popover.tsx",
            "description": "This file defines a reusable Popover UI component for the application, wrapping and extending the Radix UI Popover with custom styling and animations.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/hover-card.tsx",
            "description": "This file defines a customizable UI component for a hover card, leveraging Radix UI's HoverCard primitive and Tailwind CSS for styling. It exports the root component, trigger, content, and a custom title for the hover card.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/IOTableCell.tsx",
            "description": "This file defines a React component, `IOTableCell`, for rendering JSON data within a table cell. It handles displaying truncated data, loading states, and provides an optional hover card to view the full JSON content.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/progress.tsx",
            "description": "This file defines a reusable UI component for a progress bar, built upon the Radix UI Progress primitive with custom styling and animation.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/resizable.tsx",
            "description": "This file defines reusable UI components for creating resizable panel layouts, built on top of 'react-resizable-panels' and styled with Tailwind CSS.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/card.tsx",
            "description": "This file defines and exports several reusable React UI components for creating cards, including the main Card container, CardHeader, CardTitle, CardDescription, CardContent, and CardFooter, all styled using Tailwind CSS.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/switch.tsx",
            "description": "This file defines a customizable UI switch component using Radix UI primitives and `class-variance-authority` for styling variations, such as size.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/scroll-area.tsx",
            "description": "This file exports custom `ScrollArea` and `ScrollBar` components built on top of Radix UI's scroll area primitives, enhanced with Tailwind CSS for styling. It provides a standardized and themed scrollable container for the application UI.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/chart.tsx",
            "description": "This file provides a set of UI components for building customizable charts using the Recharts library, including a chart container, dynamic styling, tooltip content, and legend content, with support for theming.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/calendar.tsx",
            "description": "This file defines a reusable Calendar component built upon the `react-day-picker` library, extensively customizing its appearance with Tailwind CSS for consistent UI styling within the application.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/multi-select-combobox.tsx",
            "description": "This file defines a reusable React component for a multi-select combobox. It allows users to search for and select multiple items, displaying chosen items as pills and search results in a dropdown.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/separator.tsx",
            "description": "This file defines a reusable UI component called `Separator` that renders a horizontal or vertical dividing line. It wraps the `SeparatorPrimitive` from Radix UI and applies custom styling using Tailwind CSS.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/sonner.tsx",
            "description": "This file defines and exports a customized `Toaster` component using the `sonner` library, providing a consistent UI for displaying toast notifications within the application. It configures default styles, position, and theme for the toast messages.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/label.tsx",
            "description": "This file defines a reusable 'Label' UI component using Radix UI primitives and styled with Tailwind CSS via `class-variance-authority`. It provides an accessible and consistently styled label for form elements.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/collapsible.tsx",
            "description": "Exports UI components for a collapsible section, wrapping the `Collapsible` primitive from Radix UI.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/table.tsx",
            "description": "This file defines a set of reusable React components for constructing tables, including Table, TableHeader, TableBody, TableFooter, TableRow, TableHead, TableCell, and TableCaption. These components are styled using Tailwind CSS for consistent UI presentation.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/textarea.tsx",
            "description": "This file defines and exports a reusable `Textarea` React UI component, styled with Tailwind CSS, which forwards its ref to the underlying HTML textarea element.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/input.tsx",
            "description": "This file defines a reusable React input component, styled with Tailwind CSS, which wraps a native HTML input element and offers additional control over password manager interaction.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/tabs-bar.tsx",
            "description": "This file exports a set of custom-styled tab components (TabsBar, TabsBarList, TabsBarTrigger, TabsBarContent) built upon Radix UI's Tabs primitive, integrating Tailwind CSS for styling.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/time-icon.tsx",
            "description": "This file defines a React component, `TimeIcon`, that displays different icons (Sun, Moon, or Clock) based on a given time, representing AM/PM, noon, midnight, or general time.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/skeleton.tsx",
            "description": "This file defines a reusable React component named `Skeleton` for displaying placeholder loading states. It applies basic styling for an animated, muted rectangle commonly used in UI.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/toggle-group.tsx",
            "description": "This file defines and exports a reusable `ToggleGroup` and `ToggleGroupItem` component, building on Radix UI primitives and integrating Tailwind CSS for styling. It provides a group of toggleable buttons with shared variant and size properties.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/time-picker.tsx",
            "description": "A React component that provides a customizable time picker input field, allowing users to select hours, minutes, seconds, and AM/PM, along with displaying local timezone information.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/side-panel.tsx",
            "description": "This file defines a reusable SidePanel UI component that can be used in either controlled or uncontrolled modes, with state persistence for uncontrolled mode and mobile responsiveness, along with sub-components for its header, title, and content.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/tabs.tsx",
            "description": "This file defines and exports a styled Tabs component, along with its sub-components (List, Trigger, Content), built upon Radix UI's primitives and styled with Tailwind CSS for consistent UI.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/timeline.tsx",
            "description": "This file provides reusable React components, `Timeline` and `TimelineItem`, for building a timeline UI display, including visual elements like a vertical line and item dots.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/toggle.tsx",
            "description": "This file defines a styled and customizable UI toggle component using Radix UI and Tailwind CSS. It provides various visual styles and sizes for the toggle button.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/combobox.tsx",
            "description": "This file defines a reusable Combobox UI component that allows users to select an item from a searchable dropdown list. It supports both flat and grouped options, displaying selected values, and handling user interactions.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/tooltip.tsx",
            "description": "This file defines and exports a customizable Tooltip UI component, wrapping the Radix UI tooltip primitive with Tailwind CSS styling and animations. It provides `Tooltip`, `TooltipTrigger`, `TooltipContent`, and `TooltipProvider` for consistent usage across the application.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/slider.tsx",
            "description": "This file defines a customizable React `Slider` component built on Radix UI, enhancing it with an optional input field for numerical value entry, percentage display, and decimal place control.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/dialog.tsx",
            "description": "This file defines and exports a collection of accessible dialog components, built upon Radix UI primitives and styled with Tailwind CSS, offering customizable variants and enhanced functionality.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/command.tsx",
            "description": "This file exports a set of UI components for a command palette, built using `cmdk` and integrated into a dialog. It provides styled and functional components for search input, lists, groups, items, and shortcuts within a command-style interface.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/CodeJsonViewer.tsx",
            "description": "This file defines React components, `JSONView` and `CodeView`, for rendering and interacting with structured (JSON) and unstructured (code/text) data. It includes features like syntax highlighting, collapsing, copying, and integration with media display and markdown rendering.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/drawer.tsx",
            "description": "This file defines a reusable and responsive Drawer UI component, built on top of `vaul` primitives and styled with Tailwind CSS, supporting different sizes, positions, and adaptive direction based on screen size.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/input-command.tsx",
            "description": "This file exports an adapted command palette component from `cmdk` (shadcn/ui), specifically designed for use as a form field with suggestions. It provides various sub-components for building interactive search and command input interfaces.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/time-period-select.tsx",
            "description": "This file defines a React component for selecting between 'AM' and 'PM' time periods within a time picker interface, handling the display and update logic for the selected period.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/dropdown-menu.tsx",
            "description": "This file defines a set of styled and opinionated UI components for a dropdown menu, built as wrappers around the Radix UI DropdownMenu primitives with Tailwind CSS for styling. It provides various elements like trigger, content, items, checkboxes, radio buttons, and submenus to construct rich dropdown functionalities.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/sheet.tsx",
            "description": "This file defines a reusable 'Sheet' UI component, which is a dialog or modal that slides in from a specified side of the screen, built upon Radix UI primitives and styled with Tailwind CSS.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/select.tsx",
            "description": "This file defines a set of reusable UI components for a select (dropdown) input, built on top of Radix UI primitives and styled with Tailwind CSS. It provides custom styling, scroll buttons, and icon handling for a consistent look and feel.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/alert-dialog.tsx",
            "description": "This file defines and exports a collection of styled components for building an accessible alert dialog, leveraging Radix UI primitives and Tailwind CSS for styling and animations. It provides ready-to-use components like `AlertDialog`, `AlertDialogTrigger`, `AlertDialogContent`, and action buttons.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/time-picker-input.tsx",
            "description": "This file defines the `TimePickerInput` React component, which is a specialized input field designed for entering and manipulating individual time segments (e.g., hours, minutes, seconds) within a time picker UI. It handles keyboard input for setting time values and navigation.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/form.tsx",
            "description": "This file provides a set of reusable UI components and hooks for building accessible forms with validation, integrating `react-hook-form` with Radix UI primitives for enhanced functionality and styling.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/splash-screen.tsx",
            "description": "This file defines a reusable React component named `SplashScreen`. It's designed to display initial information or feature introductions, supporting custom titles, descriptions, images/videos, action buttons, and value propositions.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/time-picker-utils.tsx",
            "description": "Provides utility functions for parsing, validating, manipulating, and formatting time values (hours, minutes, seconds) for use in UI components like a time picker. It includes conversions between 12-hour and 24-hour formats and date manipulation.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/resizable-image.tsx",
            "description": "This file defines a `ResizableImage` React component that securely loads and displays images from external sources. It includes features like security validation for image URLs, error handling, image resizing/zooming, and on-demand loading to mitigate security risks and improve performance.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/sidebar.tsx",
            "description": "This file defines a comprehensive and highly customizable sidebar component for a React application. It includes state management, responsiveness for mobile and desktop, various display variants (e.g., floating, collapsible), and a context provider to manage its state and interactions.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/PrettyJsonView.tsx",
            "description": "This file defines a React component, `PrettyJsonView`, which renders complex JSON data as an interactive, expandable, and collapsible table using `@tanstack/react-table`. It includes features like smart expansion, special rendering for ChatML, Markdown, and media content, and filtering of null/empty values.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonSection/AdvancedJsonSectionHeader.tsx",
            "description": "This component renders a header for an `AdvancedJsonSection`, including a title with an optional icon, a copy-to-clipboard button, and support for custom control buttons like expand/collapse functionality.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonSection/AdvancedJsonSection.tsx",
            "description": "A React component that serves as a feature-rich, collapsible wrapper for displaying JSON data using the AdvancedJsonViewer, including search, copy, and expansion management.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/README.md",
            "description": "This README provides comprehensive documentation for the `AdvancedJsonViewer` component, detailing its features, architecture, performance characteristics, and usage instructions for developers. It explains how the component efficiently renders large JSON datasets with virtualization and advanced interaction capabilities.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/MultiSectionJsonViewer.tsx",
            "description": "A React component that displays multiple JSON data sets as collapsible sections, featuring search functionality, line numbering, and optional virtualization for performance.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/AdvancedJsonViewer.tsx",
            "description": "This file implements the AdvancedJsonViewer React component, a self-contained and feature-rich JSON viewer with capabilities like virtualization, search, syntax highlighting, and expand/collapse functionality.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/SimpleJsonViewer.tsx",
            "description": "A React component for displaying JSON data in a non-virtualized format, suitable for small datasets. It provides features like search highlighting, expandable nodes, and customizable styling.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/VirtualizedJsonViewer.tsx",
            "description": "This React component implements a virtualized JSON viewer for efficiently displaying large JSON datasets. It uses TanStack Virtual to render only the visible rows, optimizing performance and handling search, expansion, and various display options.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/types.ts",
            "description": "This file defines all TypeScript types, interfaces, and utility configurations for the `AdvancedJsonViewer` component, covering JSON data structures, display rows, search, theming, and component properties.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/SimpleMultiSectionViewer.tsx",
            "description": "This file implements the `SimpleMultiSectionViewer` React component, designed to display structured JSON data from multiple sections. It includes features like search, expansion/collapse, line numbers, and the ability to scroll to specific sections or search matches.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/VirtualizedMultiSectionViewer.tsx",
            "description": "This React component provides a virtualized, multi-section JSON viewer capable of efficiently displaying large JSON data with features like search, customizable headers, and comment/media integration. It uses virtualization to optimize performance and handles layout calculations for different display modes.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/CopyButton.tsx",
            "description": "This file defines a React component `CopyButton` that allows users to copy a given JSON value to the clipboard. It includes visual feedback for the copy action and uses utility functions for JSON stringification and styling.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/ExpandButton.tsx",
            "description": "This file defines a React component `ExpandButton` used within an Advanced JSON Viewer. It provides a visual indicator (chevron or spinner) and functionality to expand or collapse rows, and to show a loading state when toggling.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/JsonKey.tsx",
            "description": "This component renders a JSON property key or array index, applying appropriate styling, search highlighting, and optional tooltips for comments within the key name.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/LineNumber.tsx",
            "description": "This component (`LineNumber`) displays and styles a line number for a single row within a larger JSON viewer component. It is an optional feature for showing line numbers on the left side.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/JsonValue.tsx",
            "description": "This component renders a single JSON value (string, number, boolean, null, object, or array) with type-based styling, truncation, and search highlighting capabilities. It also provides preview text for expandable values like objects and arrays.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/JsonRowFixed.tsx",
            "description": "This component renders the fixed left column of a JSON viewer row, displaying line numbers, expand/collapse buttons, and search match indicators. It provides UI chrome elements that do not scroll horizontally.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/TruncatedString.tsx",
            "description": "A React component that displays a string, truncating it if it exceeds a specified length and showing the full value in a popover on hover. It also supports text highlighting for search matches and comments, with comment previews shown in tooltips.",
            "spof": false
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/JsonRowScrollable.tsx",
            "description": "This component renders a single, scrollable row within a JSON viewer, displaying the key, value, indentation, and optional action buttons like a copy button. It also manages search highlighting and inline comments for the row's content.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/MultiSectionJsonViewerHeader.tsx",
            "description": "This file defines the `MultiSectionJsonViewerHeader` React component, which serves as the default header for a multi-section JSON viewer. It displays the section title, an expandable chevron, row count, and optional indicators for comments and media attachments.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/components/MediaButtonGroup.tsx",
            "description": "This file defines a `MediaButtonGroup` component that groups media attachments (images, audio, video, documents) by type, displaying them as interactive buttons. Clicking or hovering over a button reveals a popover containing previews of the media items within that category.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/hooks/useJsonViewPreferences.ts",
            "description": "This hook manages and persists user preferences for a JSON viewer component, specifically the string wrapping mode, by storing them in local storage.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/hooks/useSearchNavigationTree.ts",
            "description": "This file exports a React hook (`useSearchNavigationTree`) that manages search navigation within a tree-like data structure, enabling users to move between search matches, clear searches, and automatically expand tree nodes to reveal matched items.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/hooks/useJsonSearch.ts",
            "description": "This React hook (`useJsonSearch`) manages search-related calculations for JSON viewers, including building a map of search matches, identifying the current match, and calculating its index within a row.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/hooks/useTreeState.ts",
            "description": "This file defines the `useTreeState` React hook, which manages the core state for an advanced JSON tree viewer. It handles tree construction (synchronously or via Web Worker), expansion/collapse logic, and persistence of the expansion state.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/hooks/useJsonTheme.ts",
            "description": "This file defines a React hook (`useJsonTheme`) for a JSON viewer component, which resolves the visual theme by merging default light/dark themes with user-defined overrides based on the current system theme.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/hooks/useMonospaceCharWidth.ts",
            "description": "This file exports a React hook (`useMonospaceCharWidth`) that measures and caches the actual pixel width of a monospace character ('0') at a specified font size. It's used to accurately estimate text width in monospace fonts, storing the result in `sessionStorage` for performance.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/workers/tree-builder.worker.ts",
            "description": "This web worker builds a tree structure from large JSON datasets off the main thread to prevent UI blocking. It processes JSON data and configuration to generate a tree representation, reporting success or errors with performance metrics.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/highlightText.ts",
            "description": "This utility file provides a function to highlight text with multiple types of highlights (search and comments) by segmenting the text and assigning appropriate types. It also defines a constant for the comment highlight color.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/rowCount.ts",
            "description": "This file provides utility functions to count the total number of displayable rows (nodes) in a fully expanded JSON object and to check if this count exceeds a specified threshold, primarily for virtualization purposes.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/jsonTypes.clienttest.ts",
            "description": "Tests for the `jsonTypes.ts` utility file, ensuring correct identification, manipulation, and safe stringification of various JSON data types and structures.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/pathUtils.ts",
            "description": "Provides utility functions for manipulating and navigating dot-separated paths, typically used for JSON data structures, including operations like joining, splitting, comparing, and converting to JSON Path format.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/treeExpansion.ts",
            "description": "Provides utilities for managing the expansion and collapse state of nodes in a tree structure, with optimizations for efficient updates. It handles operations like toggling nodes, expanding/collapsing subtrees, and managing the overall expansion state.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/pathUtils.clienttest.ts",
            "description": "This file contains unit tests for the `pathUtils.ts` module, verifying its utility functions for manipulating and navigating paths within a tree-like data structure.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/treeNavigation.clienttest.ts",
            "description": "This file contains Jest integration tests for the tree navigation utility functions used in the `AdvancedJsonViewer` component. It verifies the correct behavior of functions related to getting visible nodes, finding nodes by index, and determining node visibility based on expansion states of a JSON tree structure.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/calculateFixedColumnWidth.ts",
            "description": "This utility calculates the pixel width for a fixed column in a UI component, such as an advanced JSON viewer, accounting for line numbers and an expand/collapse button.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/searchJson.ts",
            "description": "Provides utilities for searching flattened JSON data, including finding matches in keys and values, managing search results, expanding rows to reveal matches, and highlighting matched text.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/commentRanges.ts",
            "description": "This file provides utility functions and types for managing and retrieving inline comment ranges within a JSON viewer, categorized by sections like input, output, and metadata.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/calculateWidth.ts",
            "description": "This file provides utility functions to estimate the minimum pixel width required to display JSON data rows or tree nodes in a viewer without text wrapping. It calculates width based on content length, indentation, and approximate monospace character widths.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/treeStructure.ts",
            "description": "This file defines the data structures and algorithms for building a hierarchical, tree-based representation of JSON data, optimized for efficient just-in-time rendering and navigation in a UI component.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/treeExpansion.clienttest.ts",
            "description": "This file contains unit tests for the tree expansion utility functions, which manage the collapsed and expanded states of nodes within a tree data structure. It verifies the correct behavior of toggling, expanding to a specific node, expanding/collapsing all descendants, and persisting/restoring expansion states.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/jsonTypes.ts",
            "description": "This file provides utility functions for detecting, classifying, formatting, and traversing JSON-like data types. It supports features such as type detection, expandability checks, child counting, value preview formatting, and safe stringification, primarily for use within an advanced JSON viewer component.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/treeStructure.clienttest.ts",
            "description": "This file contains a comprehensive test suite for the `treeStructure` utility, which is responsible for building a hierarchical tree representation from JSON data. It covers basic structure, child ordering, absolute line numbering, and edge cases.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/searchJson.clienttest.ts",
            "description": "This file contains unit tests for the `searchJson` utilities, which provide functionality for searching within a JSON tree, counting matches per node, and highlighting search results.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/utils/treeNavigation.ts",
            "description": "Provides utilities for efficient, on-demand navigation and retrieval of nodes within a virtualized tree structure, optimizing for performance by avoiding full tree flattening for UI rendering.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/AdvancedJsonViewer/contexts/SectionContext.tsx",
            "description": "This file provides a React context and hooks for managing and interacting with expandable sections within a tree-like UI, typically for components like headers or footers in an Advanced JSON Viewer.",
            "spof": true
          },
          {
            "path": "web/src/components/ui/shadcn-io/dropzone/index.tsx",
            "description": "This file defines a reusable React component for file uploading (a dropzone), utilizing the 'react-dropzone' library. It includes the main Dropzone component, context for state management, and sub-components for displaying content when files are present or when the dropzone is empty.",
            "spof": true
          },
          {
            "path": "web/src/components/table/data-table-pagination.tsx",
            "description": "This file defines a reusable React component for data table pagination, providing controls for changing page size, navigating between pages (first, previous, next, last), and jumping to specific pages, along with loading indicators and analytics integration.",
            "spof": false
          },
          {
            "path": "web/src/components/table/data-table-row-height-switch.tsx",
            "description": "This file provides a React component and utilities for switching and persisting table row heights, offering small, medium, and large options with corresponding Tailwind CSS classes.",
            "spof": false
          },
          {
            "path": "web/src/components/table/data-table-toolbar.tsx",
            "description": "This file defines the `DataTableToolbar` component, which provides interactive controls for data tables, including search, filtering, column visibility, time range selection, and view presets.",
            "spof": false
          },
          {
            "path": "web/src/components/table/table-id.tsx",
            "description": "This component displays an ID or name string within a table, truncating long values with an ellipsis while showing the full content on hover.",
            "spof": true
          },
          {
            "path": "web/src/components/table/table-link.tsx",
            "description": "This file defines a reusable React component `TableLink` that renders a styled navigation link, typically for use within tables. It supports displaying either text or an icon, along with standard link behaviors and custom click handlers.",
            "spof": false
          },
          {
            "path": "web/src/components/table/data-table-refresh-button.tsx",
            "description": "This file defines a React component, `DataTableRefreshButton`, which provides functionality for manually refreshing data and configuring an auto-refresh interval using a dropdown menu.",
            "spof": true
          },
          {
            "path": "web/src/components/table/types.ts",
            "description": "This file defines custom TypeScript types for table components, extending `@tanstack/react-table`'s `ColumnDef` with application-specific properties for Langfuse tables and also defines `TableRowOptions`.",
            "spof": true
          },
          {
            "path": "web/src/components/table/peek.tsx",
            "description": "This file defines a `TablePeekView` component, which renders a side panel (peek view) to display detailed information about a selected table row item. It includes navigation options to the full detail page and an expand feature, while also managing the peek view's open and close states.",
            "spof": true
          },
          {
            "path": "web/src/components/table/data-table.tsx",
            "description": "This file implements a generic and reusable data table component using `@tanstack/react-table`, providing features such as pagination, sorting, filtering, column visibility, pinning, and resizing for displaying structured data.",
            "spof": true
          },
          {
            "path": "web/src/components/table/data-table-column-visibility-filter.tsx",
            "description": "This file defines a React component (`DataTableColumnVisibilityFilter`) that enables users to dynamically manage the visibility and order of columns in a data table, including support for grouped columns and drag-and-drop reordering.",
            "spof": true
          },
          {
            "path": "web/src/components/table/ValueCell.tsx",
            "description": "This file defines the `ValueCell` React component, which is responsible for rendering and managing the display of different data types (strings, numbers, booleans, arrays, objects, etc.) within a table cell. It includes features like text truncation, link detection, type-specific formatting, and a copy-to-clipboard button for the cell's content.",
            "spof": true
          },
          {
            "path": "web/src/components/table/hooks/useColumnSizing.ts",
            "description": "This file provides a React hook, `useColumnSizing`, which persists and manages the sizing state of a TanStack React Table's columns in local storage, with debounced saving for performance.",
            "spof": true
          },
          {
            "path": "web/src/components/table/data-table-multi-select-actions/data-table-select-all-banner.tsx",
            "description": "This component renders a banner for data tables, indicating the current multi-selection state (page-wide or all items) and providing actions to select all items or clear the selection.",
            "spof": true
          },
          {
            "path": "web/src/components/table/utils/jsonExpansionUtils.ts",
            "description": "Provides utility functions and types for transforming JSON data into a hierarchical table structure (`JsonTableRow[]`) for display, including features for lazy loading of nested data and managing expansion states.",
            "spof": true
          },
          {
            "path": "web/src/components/magicui/rainbow-button.tsx",
            "description": "This file defines a reusable React button component named `RainbowButton` which features a distinctive rainbow gradient effect. It uses `class-variance-authority` (cva) to manage style variations and sizes.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/tree-flattening.ts",
            "description": "This file provides utilities to flatten a hierarchical tree structure into a linear list for efficient virtualized rendering. It iteratively processes tree nodes, tracking their depth, tree lines for visualization, and sibling relationships, while respecting collapsed states.",
            "spof": false
          },
          {
            "path": "web/src/components/trace2/components/_shared/VirtualizedList.tsx",
            "description": "A generic React component that efficiently renders large, flat lists using virtualization with `@tanstack/react-virtual`, supporting item selection and custom rendering.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/tree-flattening.clienttest.ts",
            "description": "This file contains unit tests for the `flattenTree` utility function. It verifies that the function correctly flattens hierarchical tree structures into a linear list, handles multiple root nodes, collapsed nodes, and calculates tree line indicators for virtualized rendering.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/BreakdownToolTip.tsx",
            "description": "This file defines a React component `BreakdownTooltip` which displays a detailed breakdown of usage or cost, categorized into input, output, and other sections, within a tooltip UI element. It includes aggregation logic to sum values from an array of detail objects.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/VirtualizedTree.tsx",
            "description": "This file exports a generic virtualized tree component that efficiently renders large hierarchical data structures with dynamic row heights. It uses @tanstack/react-virtual for performance and a render prop pattern for customizable node presentation and interactivity.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/VirtualizedTreeNodeWrapper.tsx",
            "description": "This component provides a generic, reusable wrapper for rendering the visual structure, interaction (collapse/expand, selection), and layout of a single node within a virtualized tree view. It handles tree-specific UI elements like indentation and connector lines, while remaining agnostic to the actual content of the tree node.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/CopyIdsPopover.tsx",
            "description": "This component provides a UI element, either a simple button or a popover, for copying one or more IDs to the clipboard. It displays a copy icon that temporarily changes to a checkmark upon successful copy.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/JSONTableView/JSONTableViewRow.tsx",
            "description": "This file defines the `JSONTableViewRow` React component, which renders a single row within a JSON table view. It displays data in columns, handles expand/collapse functionality, and renders expanded content.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/JSONTableView/JSONTableView.tsx",
            "description": "This file defines a generic, reusable React component named `JSONTableView` that displays tabular data. It supports virtualization for performance, customizable columns, expandable rows, and a sticky header, making it suitable for displaying complex JSON or object arrays efficiently.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/JSONTableView/index.ts",
            "description": "This file serves as the main entry point for the `JSONTableView` component, a generic, virtualized table with customizable columns. It re-exports the `JSONTableView` itself, its header and row components, and their associated type definitions.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/JSONTableView/JSONTableViewHeader.tsx",
            "description": "Defines a React component `JSONTableViewHeader` that renders the header row for a JSON table view, displaying column labels and handling alignment and spacing.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/JSONTableView/json-table-view-types.ts",
            "description": "This file defines the TypeScript types and interfaces for a generic, domain-agnostic `JSONTableView` React component, which is a virtualized table with customizable columns and expandable rows.",
            "spof": true
          },
          {
            "path": "web/src/components/images",
            "description": "This directory is designated for storing image assets. Its role is to centralize and manage visual resources specifically for the UI components within the `langfuse` web application.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/markdown.clienttest.ts",
            "description": "This file contains unit tests for the `containsAnyMarkdown` function, verifying its ability to detect various Markdown syntax elements within a given string.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/orderByToPrisma.servertest.ts",
            "description": "This file contains unit tests for the `orderByToPrismaSql` function, ensuring it correctly handles invalid column names and order directions when converting ordering specifications to Prisma SQL.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/redirect.clienttest.ts",
            "description": "This file contains client-side unit tests for utility functions related to safe URL redirection and base path manipulation, including prevention of open redirect vulnerabilities.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/withMiddlewares.servertest.ts",
            "description": "This file contains unit tests for the `withMiddlewares` utility function, specifically focusing on its error handling capabilities for various types of errors including custom application errors, database errors (Prisma), validation errors (Zod), and generic exceptions within a Next.js server environment.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/zod.servertest.ts",
            "description": "This file contains unit tests for utility functions related to Zod schemas and JSON parsing, specifically for validating pagination parameters and robustly parsing JSON strings.",
            "spof": true
          },
          {
            "path": "web/src/hooks/useDebounce.tsx",
            "description": "This file provides a `useDebounce` React hook that debounces a given callback function, limiting its execution frequency. It includes a generic `debounce` utility function that the hook utilizes internally.",
            "spof": true
          },
          {
            "path": "web/src/hooks/useFormPersistence.ts",
            "description": "This file defines a React hook `useFormPersistence` that integrates with `react-hook-form` to persist form data to `sessionStorage`. It automatically saves form drafts on changes (debounced) and restores them when the component mounts.",
            "spof": true
          },
          {
            "path": "web/src/hooks/useTrpcError.tsx",
            "description": "This file defines a custom React hook `useTrpcError` that determines if a TRPC client error should be silently ignored based on its HTTP status code.",
            "spof": true
          },
          {
            "path": "web/src/hooks/use-mobile.tsx",
            "description": "This file defines a React hook, `useIsMobile`, that detects if the current viewport width is below a predefined mobile breakpoint. It provides a boolean value indicating whether the user is on a mobile device, updating dynamically on resize.",
            "spof": true
          },
          {
            "path": "web/src/hooks/use-element-visibility.tsx",
            "description": "This file provides React hooks (`useElementIsVisible`, `useElementWasVisible`) that leverage the Intersection Observer API to determine if a given DOM element is currently visible in the viewport or has ever been visible.",
            "spof": false
          },
          {
            "path": "web/src/hooks/useTableDateRange.tsx",
            "description": "This hook manages a date range state for a table, synchronizing it between URL query parameters and session storage for persistence across user sessions. It provides the current `TimeRange` and a function to update it, handling conversions between string representations and time range objects.",
            "spof": true
          },
          {
            "path": "web/src/hooks/usePreserveRelativeScroll.ts",
            "description": "This file exports a React hook `usePreserveRelativeScroll` that maintains an element's relative scroll position within its scroll container when content layout changes, preventing unexpected scroll jumps.",
            "spof": true
          },
          {
            "path": "web/src/hooks/useUniqueNameValidation.tsx",
            "description": "This React hook, designed for `react-hook-form`, validates if a given name is unique among a list of existing names, allowing for an optional whitelisted name. It sets a form error if the name is not unique and not whitelisted.",
            "spof": true
          },
          {
            "path": "web/src/utils/exceptions.ts",
            "description": "Defines utility functions to identify and check for various Prisma client exception types, facilitating error handling related to database operations.",
            "spof": true
          },
          {
            "path": "web/src/utils/constants.ts",
            "description": "This file defines constants used in the web application, specifically a character limit for rendering markdown to prevent performance issues.",
            "spof": true
          },
          {
            "path": "web/src/utils/tailwind.ts",
            "description": "This file provides a utility function (`cn`) to intelligently combine and merge Tailwind CSS class names, resolving potential conflicts for a clean and efficient styling application.",
            "spof": false
          },
          {
            "path": "web/src/utils/unicode.ts",
            "description": "This file provides a utility function, `decodeUnicodeEscapesOnly`, to decode \\uXXXX unicode escape sequences in strings, including handling surrogate pairs and various edge cases like truncation or invalid hex, with options for greedy or non-greedy decoding.",
            "spof": true
          },
          {
            "path": "web/src/utils/fill-time-series-gaps.ts",
            "description": "This file contains utilities for filling gaps in time series data and aggregating single-unit data points into multi-unit buckets, specifically designed to handle data received from ClickHouse.",
            "spof": true
          },
          {
            "path": "web/src/utils/tanstack.d.ts",
            "description": "This file defines custom filter types (e.g., SelectFilter, NumberComparisonFilter, KeyValueFilter) for extending the ColumnMeta interface of the @tanstack/table-core library, enabling enhanced filtering capabilities for TanStack tables.",
            "spof": false
          },
          {
            "path": "web/src/utils/clipboard.ts",
            "description": "This file provides a utility function for copying text to the clipboard, prioritizing the modern Clipboard API but including a fallback for non-secure contexts where the API is unavailable. The fallback uses the deprecated `document.execCommand` method.",
            "spof": true
          },
          {
            "path": "web/src/utils/string.ts",
            "description": "This file provides utility functions for common string manipulations, including extracting the last characters of a string and truncating a string to a specified length with an ellipsis.",
            "spof": false
          },
          {
            "path": "web/src/utils/markdown.ts",
            "description": "This file provides utility functions for processing markdown. Specifically, it exports a function to strip all markdown formatting from a string, converting it to plain text.",
            "spof": true
          },
          {
            "path": "web/src/utils/superjson.ts",
            "description": "This file configures the SuperJSON library to properly serialize and deserialize 'Decimal.js' objects, ensuring they are handled correctly during data transfer.",
            "spof": true
          },
          {
            "path": "web/src/utils/navigation.ts",
            "description": "This utility file provides a function to convert URLSearchParams into a Next.js router query object. It handles single and multiple values for parameters, preserving arrays where appropriate.",
            "spof": true
          },
          {
            "path": "web/src/utils/unicode.clienttest.ts",
            "description": "This file contains unit tests for the `decodeUnicodeEscapesOnly` utility function, which is responsible for decoding Unicode escape sequences within a string, including surrogate pairs for emojis and handling various edge cases like truncation and double-escaped sequences.",
            "spof": true
          },
          {
            "path": "web/src/utils/clientSideDomainTypes.ts",
            "description": "This file provides types and utilities to transform objects by stringifying their `metadata` field for safe client-side consumption, particularly when using `SuperJSON` which has limitations with certain metadata keys. It ensures data can be correctly serialized and consumed by the frontend.",
            "spof": true
          },
          {
            "path": "web/src/utils/numbers.ts",
            "description": "Provides utility functions for various number formatting needs, including compact notation, currency, latency, and token counts, as well as a helper for generating random integers.",
            "spof": false
          },
          {
            "path": "web/src/utils/trpcErrorToast.tsx",
            "description": "This file provides a utility function to display user-friendly toast notifications for tRPC client errors, customizing the error title and description based on the HTTP status code or tRPC error code.",
            "spof": false
          },
          {
            "path": "web/src/utils/map-utils.ts",
            "description": "This file provides utility functions for safely extracting and converting data from maps, records, and objects, handling undefined values and type casting for numerical data, often in the context of tRPC query responses.",
            "spof": false
          },
          {
            "path": "web/src/utils/redirect.ts",
            "description": "This file provides utility functions for securely handling redirect paths, including validating and sanitizing user-provided paths to prevent open redirect vulnerabilities, and managing base paths for Next.js routing.",
            "spof": false
          },
          {
            "path": "web/src/utils/dates.ts",
            "description": "This file provides a collection of utility functions for date and time manipulation. It includes functions for calculating date offsets, converting between UTC and local times, formatting time intervals, and retrieving timezone information.",
            "spof": false
          },
          {
            "path": "web/src/utils/api.ts",
            "description": "This file serves as the client-side entrypoint for the tRPC API in a Next.js application, configuring type-safe React Query hooks, request links (including batching and logging), and robust error handling with Sentry integration and version update notifications.",
            "spof": false
          },
          {
            "path": "web/src/server/utils/trpc-utils.ts",
            "description": "This file provides utility functions to convert HTTP status codes into tRPC error codes, defining a mapping between common HTTP status codes and their tRPC equivalents. It helps standardize error handling in a tRPC application.",
            "spof": true
          },
          {
            "path": "web/src/server/utils/cookies.ts",
            "description": "This file provides utility functions for generating secure and environment-specific cookie options and names, adapting them based on deployment environment variables like `NEXTAUTH_URL` and `VERCEL`.",
            "spof": false
          },
          {
            "path": "web/src/server/api/services/sqlInterface.ts",
            "description": "This file defines Zod schemas and types for a standardized SQL query interface, including structures for filters, aggregations, grouping, ordering, and selections, primarily used for data retrieval from various tables.",
            "spof": true
          },
          {
            "path": "web/src/features/models/utils.ts",
            "description": "This file provides utility functions for numerical operations, specifically determining the maximum number of significant decimal places in a number after scaling.",
            "spof": true
          },
          {
            "path": "web/src/features/feature-flags/types.ts",
            "description": "This file defines TypeScript types related to feature flags, specifically for a single flag's name and an object representing the boolean state of all available feature flags.",
            "spof": false
          },
          {
            "path": "web/src/features/command-k-menu/CommandMenuProvider.tsx",
            "description": "This file defines a React Context, Provider, and hook (`useCommandMenu`) for managing the open/closed state of a global command menu, enabling other components to interact with it.",
            "spof": false
          },
          {
            "path": "web/src/features/folders/components/FolderBreadcrumb.tsx",
            "description": "This file defines the `FolderBreadcrumb` React component, which renders a dynamic breadcrumb navigation for hierarchical folder paths. It allows users to navigate between folders by clicking on the links in the breadcrumb.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/server/withMiddlewares.ts",
            "description": "This file provides a `withMiddlewares` function that wraps Next.js API route handlers, applying common middlewares like CORS and centralizing robust error handling for various application-specific and generic exceptions.",
            "spof": true
          },
          {
            "path": "web/src/features/notifications/showErrorToast.tsx",
            "description": "This file defines a utility function, `showErrorToast`, responsible for displaying custom error and warning notifications using the `sonner` toast library and a custom `ErrorNotification` component.",
            "spof": false
          },
          {
            "path": "web/src/features/notifications/showSuccessToast.tsx",
            "description": "This file defines a utility function, `showSuccessToast`, which displays a customizable success notification using the 'sonner' toast library and a custom `SuccessNotification` component.",
            "spof": false
          },
          {
            "path": "web/src/features/notifications/SuccessNotification.tsx",
            "description": "This file defines a React component (`SuccessNotification`) responsible for rendering a customizable success notification, including a title, description, an optional action link, and a dismiss button.",
            "spof": false
          },
          {
            "path": "web/src/features/media/server/getFileExtensionFromContentType.ts",
            "description": "This file defines a utility function that maps media content types (MIME types) to their corresponding file extensions. It is used to determine the correct file extension based on a given content type.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/core/errors.ts",
            "description": "Defines custom error classes, `UserInputError` and `ApiServerError`, for differentiating between user-fixable client errors and internal server errors, along with type guards for these errors.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/core/validation.ts",
            "description": "This file defines core Zod validation schemas for common, cross-feature parameters like project ID, pagination limit, and page number. It provides reusable validation logic for various parts of the application.",
            "spof": true
          },
          {
            "path": "web/src/features/filters/hooks/useColumnFilterState.ts",
            "description": "A React hook for managing and persisting column-specific filter states in the URL query parameters, utilizing JSON encoding for complex objects.",
            "spof": true
          },
          {
            "path": "web/src/features/filters/hooks/useSidebarFilterState.tsx",
            "description": "This file provides a React hook (`useSidebarFilterState`) for managing the state of sidebar filters, including encoding/decoding filters from URL query parameters, normalizing filter definitions, and handling their persistence in local and session storage. It defines various UI filter types for different data representations.",
            "spof": false
          },
          {
            "path": "web/src/features/filters/hooks/useFilterState.ts",
            "description": "This file provides a React hook (`useQueryFilterState`) for managing and persisting filter states across URL query parameters and session storage, enabling filters for various data tables within the application. It includes logic for encoding and decoding filter configurations to/from query string format.",
            "spof": false
          },
          {
            "path": "web/src/features/filters/components/multi-select.tsx",
            "description": "This file defines a reusable React component named `MultiSelect` for selecting multiple items from a list of options. It supports displaying selected items as badges, custom free-text input, and includes 'select all' functionality, commonly used for filtering data.",
            "spof": false
          },
          {
            "path": "web/src/features/navigate-detail-pages/DetailPageNav.tsx",
            "description": "This component provides navigation controls, including buttons and keyboard shortcuts (J/K), to move between detail pages in a sequential list. It allows users to easily navigate to the previous or next item within a specific list context.",
            "spof": false
          },
          {
            "path": "web/src/features/table/types.ts",
            "description": "This file defines the TypeScript types for various table actions, including creation, deletion, and custom dialog actions. It specifies their properties, access checks, and execution signatures for UI tables.",
            "spof": false
          },
          {
            "path": "web/src/features/table/hooks/useSelectAll.ts",
            "description": "This file defines a React hook, `useSelectAll`, which manages a boolean 'select all' state for a table, persisting it in session storage and resetting it when the Next.js route changes. It's designed to provide a centralized way to handle selection across pages or views within a project and table context.",
            "spof": true
          },
          {
            "path": "web/src/features/table/components/TableSelectionManager.tsx",
            "description": "This file defines a React component `TableSelectionManager` that provides utilities for managing row selection within a `@tanstack/react-table` instance. It generates a column with checkboxes for selecting individual rows and a header checkbox for selecting all rows on the current page, integrating with a global selection state hook.",
            "spof": true
          },
          {
            "path": "web/src/features/table/components/TableActionMenu.tsx",
            "description": "This file defines a reusable `TableActionMenu` component that provides a dropdown menu for various table-related actions. It allows users to select an action, which can then trigger a custom callback or open a dedicated dialog for further interaction.",
            "spof": false
          },
          {
            "path": "web/src/features/theming/ThemeProvider.tsx",
            "description": "This file exports a `ThemeProvider` component that wraps `next-themes`'s `NextThemesProvider`, providing theme context and functionality to the application's components.",
            "spof": true
          },
          {
            "path": "web/src/features/theming/useMarkdownContext.tsx",
            "description": "This file defines a React Context and provider (`MarkdownContextProvider`) to manage a global `isMarkdownEnabled` state, persisting user preference for Markdown rendering in local storage. It also exports a custom hook (`useMarkdownContext`) to access this state and its setter within child components.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/chart-library/HorizontalBarChart.tsx",
            "description": "This file defines a React component for a horizontal bar chart, utilizing `recharts` to visualize data with a dimension on the Y-axis and a metric on the X-axis.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/chart-library/LineChartTimeSeries.tsx",
            "description": "This file defines a React component, `LineChartTimeSeries`, which renders a time-series line chart using `recharts`. It dynamically displays multiple lines based on unique dimensions within the provided data, grouped by a time dimension.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/chart-library/PieChart.tsx",
            "description": "This file defines a React component for rendering a customizable pie chart (donut chart) using Recharts. It displays data with a total value label in the center and supports accessibility features.",
            "spof": true
          },
          {
            "path": "web/src/features/column-visibility/hooks/useColumnOrder.ts",
            "description": "This file defines a React hook `useColumnOrder` that manages the order of table columns, persisting it to and loading it from local storage, and ensuring the order is consistent with the available columns.",
            "spof": false
          },
          {
            "path": "web/src/features/column-visibility/hooks/useColumnVisibility.ts",
            "description": "This file provides a custom React hook, `useColumnVisibility`, to manage and persist the visibility state of table columns using local storage. It integrates with `@tanstack/react-table` to store and retrieve user-defined column visibility preferences.",
            "spof": true
          },
          {
            "path": "web/src/features/orderBy/hooks/useOrderByState.ts",
            "description": "This file defines a React hook, `useOrderByState`, that manages table ordering settings by storing and retrieving them from URL query parameters. It provides a way to initialize, read, and update the ordering state.",
            "spof": true
          },
          {
            "path": "web/src/features/orderBy/hooks/useOrderByState.clienttest.tsx",
            "description": "This file contains unit tests for the `useOrderByState` custom React hook, which manages sorting state and synchronizes it with URL query parameters. The tests, currently skipped, verify the hook's behavior in setting default values, updating, and reading sorting parameters from the URL.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/periodicRunner.test.ts",
            "description": "This file contains unit tests for the `PeriodicRunner` utility class, verifying its functionality regarding execution scheduling, interval management, stopping behavior, and error handling using Vitest and fake timers.",
            "spof": true
          },
          {
            "path": "worker/src/interfaces/MessageResponse.ts",
            "description": "Defines the `MessageResponse` interface, which specifies the structure for API responses containing a single string message.",
            "spof": true
          },
          {
            "path": "worker/src/interfaces/ErrorResponse.ts",
            "description": "Defines the structure for an error response, including a message and an optional stack trace, likely used for API error handling within the worker component.",
            "spof": true
          },
          {
            "path": "worker/src/errors/UnrecoverableError.ts",
            "description": "This file defines a custom `UnrecoverableError` class, used to signify errors from which an application cannot gracefully recover. It also provides a type guard function, `isUnrecoverableError`, to safely check for this specific error type.",
            "spof": true
          },
          {
            "path": "worker/src/queues/utils/delays.ts",
            "description": "This file defines a utility function `delayInMs` which calculates a random delay duration in milliseconds, increasing with the number of attempts, likely for retry mechanisms in queues.",
            "spof": false
          },
          {
            "path": "worker/src/scripts/refillQueueEvent/README.md",
            "description": "This README documents a utility script for backfilling queues with events from local machines, including steps for preparing event data, setting environment variables, ensuring connectivity, and running the script.",
            "spof": true
          },
          {
            "path": "worker/src/utils/RedisLock.ts",
            "description": "This file implements a distributed lock using Redis, providing a `RedisLock` class to acquire, manage, and release locks for critical sections of code, with configurable behavior for Redis unavailability.",
            "spof": true
          },
          {
            "path": "worker/src/utils/PeriodicExclusiveRunner.ts",
            "description": "Defines an abstract class, `PeriodicExclusiveRunner`, which extends `PeriodicRunner` to manage periodic tasks, ensuring exclusive execution across multiple instances using Redis-based distributed locking.",
            "spof": true
          },
          {
            "path": "worker/src/utils/PeriodicRunner.ts",
            "description": "This file defines an abstract base class, `PeriodicRunner`, for implementing tasks that need to be executed periodically. It handles the scheduling, error logging, and lifecycle management (start/stop) of such recurring operations.",
            "spof": true
          },
          {
            "path": "worker/src/features/utils/utilities.ts",
            "description": "This file provides general utility functions including template string compilation, W3C Trace Context ID generation, and retention cutoff date calculation.",
            "spof": true
          },
          {
            "path": "worker/src/features/utils/retry-handler.ts",
            "description": "This file provides a utility function to handle rate limiting and retry logic for queue jobs, specifically for errors like 429/5xx. It re-queues jobs with a delay, while also checking if they are too old (over 24 hours) to prevent indefinite retries.",
            "spof": false
          },
          {
            "path": "worker/src/features/utils/index.ts",
            "description": "This file serves as an index for utility functions, re-exporting modules like `utilities` and `retry-handler` for consolidated access within the worker's features.",
            "spof": true
          },
          {
            "path": "worker/src/services/IngestionService/tests/utils.unit.test.ts",
            "description": "This file contains unit tests for the `overwriteObject` utility function. It verifies that the function correctly merges properties from a source object into a target object, handles overwriting, merges nested objects (metadata), and appends unique items to arrays (tags).",
            "spof": true
          },
          {
            "path": "packages/shared/src/index.ts",
            "description": "This file serves as a central entry point for the shared module, re-exporting a comprehensive collection of utilities, types, interfaces, constants, and domain-specific models. It consolidates common building blocks and definitions used throughout the Langfuse application.",
            "spof": false
          },
          {
            "path": "packages/shared/src/errors/ApiError.ts",
            "description": "This file defines the `ApiError` class, a custom error type used to represent failures originating from API calls, extending a base error class.",
            "spof": false
          },
          {
            "path": "packages/shared/src/errors/ConflictError.ts",
            "description": "This file defines the `LangfuseConflictError` class, a custom error type used to represent HTTP 409 Conflict errors within the Langfuse application.",
            "spof": true
          },
          {
            "path": "packages/shared/src/errors/index.ts",
            "description": "This file serves as an index for various custom error classes, re-exporting them for easier access and centralized management within the application.",
            "spof": false
          },
          {
            "path": "packages/shared/src/errors/NotFoundError.ts",
            "description": "This file defines a custom error class, LangfuseNotFoundError, which extends BaseError. It represents a 404 'Not Found' error within the Langfuse application.",
            "spof": true
          },
          {
            "path": "packages/shared/src/errors/InvalidRequestError.ts",
            "description": "Defines the `InvalidRequestError` class, a custom error type for signaling invalid client requests (HTTP 400).",
            "spof": true
          },
          {
            "path": "packages/shared/src/errors/ServiceUnavailableError.ts",
            "description": "This file defines the `ServiceUnavailableError` class, a specialized error type used to indicate that a service is temporarily unavailable, corresponding to an HTTP 503 status.",
            "spof": true
          },
          {
            "path": "packages/shared/src/errors/InternalServerError.ts",
            "description": "This file defines the `InternalServerError` class, a specialized error type extending `BaseError` for representing internal server errors (HTTP 500).",
            "spof": true
          },
          {
            "path": "packages/shared/src/errors/ForbiddenError.ts",
            "description": "This file defines the ForbiddenError class, a specific error type indicating that access to a resource is forbidden (HTTP 403 status code).",
            "spof": false
          },
          {
            "path": "packages/shared/src/errors/MethodNotAllowedError.ts",
            "description": "This file defines the `MethodNotAllowedError` class, which extends `BaseError`. It represents an HTTP 405 status code error, indicating that a requested method is not supported for a given resource.",
            "spof": false
          },
          {
            "path": "packages/shared/src/errors/BaseError.ts",
            "description": "This file defines a `BaseError` class, extending JavaScript's native `Error` to provide a standardized base for application-specific errors. It includes properties for an HTTP status code and an `isOperational` flag, facilitating robust error handling.",
            "spof": true
          },
          {
            "path": "packages/shared/src/errors/NotImplementedError.ts",
            "description": "This file defines a custom `NotImplementedError` class, extending `BaseError`. It is used to signal that a particular feature or method has not yet been implemented, typically returning a 501 status code.",
            "spof": true
          },
          {
            "path": "packages/shared/src/encryption/index.ts",
            "description": "This file serves as an entry point for encryption and signature utilities, exporting all functionalities from the 'encryption' and 'signature' modules within the shared package.",
            "spof": true
          },
          {
            "path": "packages/shared/src/encryption/signature.ts",
            "description": "This file provides utilities for generating and managing webhook secrets and creating HMAC-SHA256 signatures for webhook payloads, ensuring secure communication.",
            "spof": true
          },
          {
            "path": "packages/shared/src/encryption/encryption.ts",
            "description": "This file provides utility functions for encrypting and decrypting data using the AES-256-GCM algorithm, relying on an `ENCRYPTION_KEY` environment variable. It includes functions for key generation, encryption, and decryption of strings.",
            "spof": true
          },
          {
            "path": "packages/shared/src/interfaces/filters.ts",
            "description": "This file defines various filter types and their corresponding operators using Zod schemas, providing a structured way to apply filters based on data types and specific use cases.",
            "spof": true
          },
          {
            "path": "packages/shared/src/interfaces/orderBy.ts",
            "description": "This file defines a Zod schema and TypeScript type for specifying ordering parameters, including the column name and sort direction (ASC or DESC).",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/filterToPrisma.ts",
            "description": "This file translates structured filter objects (`FilterState`) into raw Prisma SQL clauses. It dynamically constructs SQL WHERE conditions based on column definitions, filter types, and operators for secure database query generation.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/otel/utils.ts",
            "description": "This file provides utility functions, including `isValidDateString` for validating date strings and `flattenJsonToPathArrays` for transforming nested JSON objects into flattened key-value pairs with path-based names and stringified values.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/InMemoryFilterService.ts",
            "description": "This file provides an `InMemoryFilterService` that evaluates various filter conditions (string, number, datetime, boolean, array, object properties) against in-memory data objects.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/StorageService.ts",
            "description": "This file defines an interface for a generic storage service and provides a factory for creating instances that can interact with different cloud storage providers, including AWS S3, Azure Blob Storage, and Google Cloud Storage. It abstracts common operations like uploading, downloading, listing, and deleting files.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/services/PromptService/utils.ts",
            "description": "This file provides utility functions, specifically one to escape special characters for safe use in regular expressions.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/utils/compareVersions.ts",
            "description": "This file provides a utility function to compare two semantic version strings, indicating whether the latest version is a major, minor, or patch update compared to the current version.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/utils/DatabaseReadStream.ts",
            "description": "This file defines a `DatabaseReadStream` class that provides a paginated, chunk-based streaming mechanism for database records, optimized for large datasets and designed to work around Prisma's lack of direct streaming support.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/utils/headerUtils.ts",
            "description": "Provides utility functions for managing HTTP headers, including merging, encrypting, decrypting, and masking secret header values for secure handling and display.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/utils/metadata_conversion.ts",
            "description": "This file provides a utility function to convert a flat record of string-based metadata (e.g., from a database) into a structured `MetadataDomain` object by attempting to parse string values as JSON.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/utils/rendering.ts",
            "description": "Defines utilities and properties for processing and rendering input/output data, including truncation and conditional JSON parsing, before it is returned from server-side functions.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/utils/transforms/transformStreamToCsv.ts",
            "description": "This file exports a Transform stream function that converts a stream of JavaScript objects into a CSV formatted string stream. It automatically extracts headers from the first object, escapes CSV fields, and includes periodic yielding to prevent blocking the event loop.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/utils/transforms/stringify.ts",
            "description": "This file provides a `stringify` utility function that converts data to a JSON string. It specifically handles `bigint` types and applies conditional pretty-printing for \"comments\" fields to enhance readability.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/utils/transforms/transformStreamToJson.ts",
            "description": "This file provides a Node.js Transform stream that converts a stream of JavaScript objects into a single JSON array string. It handles proper JSON array formatting, including empty arrays.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/utils/transforms/index.ts",
            "description": "This file exports a mapping that associates different batch export file formats (CSV, JSON, JSONL) with their corresponding stream transformation functions, enabling dynamic selection of the appropriate transformer.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/utils/transforms/transformStreamToJsonl.ts",
            "description": "This file defines a `Transform` stream that converts a stream of JavaScript objects into JSON Lines (JSONL) format, stringifying each object and appending a newline.",
            "spof": false
          },
          {
            "path": "packages/shared/src/utils/math.ts",
            "description": "Provides mathematical utility functions, including a function to calculate the p-th percentile of a numeric array.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/typeChecks.ts",
            "description": "This file provides utility functions and Zod schemas for common type checking and validation, such as checking for the presence of a value or defining a datetime string schema.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/jsonSchemaValidation.ts",
            "description": "This file provides utility functions for JSON schema validation using Ajv, including creating Ajv instances, checking schema validity, and validating data against compiled or ad-hoc schemas.",
            "spof": false
          },
          {
            "path": "packages/shared/src/utils/stringChecks.ts",
            "description": "This file provides utility functions and regular expressions for string manipulation, focusing on validating variable names, extracting variables from mustache-syntax strings, and converting various data types to their string representation.",
            "spof": false
          },
          {
            "path": "packages/shared/src/utils/json.ts",
            "description": "This file provides utility functions for robust and efficient deep parsing of JSON strings. It handles nested stringified JSON, attempts to parse Python dictionary/list formats, and includes optimizations for performance and safeguards against prototype pollution.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/folders/validation.ts",
            "description": "This file defines a Zod validation utility for folder paths, ensuring proper formatting (no leading/trailing slashes, no consecutive slashes, and not empty).",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/utils/clickhouse-builder.ts",
            "description": "This file defines a utility class, `ClickHouseQueryBuilder`, which is responsible for constructing and executing SQL INSERT queries for ClickHouse. It provides methods for both individual record insertion and bulk data generation to seed test data into ClickHouse tables for traces, observations, and scores.",
            "spof": true
          },
          {
            "path": "fern/apis/server/definition/utils",
            "description": "This directory likely contains utility functions or helper definitions that support the server API definitions, specifically within the Fern API generation framework. It provides common elements or abstractions used across various API endpoints or data structures.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 46
          },
          {
            "name": "Nimar",
            "percent": 19
          },
          {
            "name": "marliessophie",
            "percent": 11
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 261,
      "spofCount": 181
    },
    "busFactor": 3,
    "authorCount": 16
  },
  "Dashboards & Reporting": {
    "description": "Create and customize dashboards to visualize key metrics like cost, latency, usage, and quality scores. Offers high-level insights for monitoring application health and business impact.",
    "functions": {
      "Table View & Filter Management": {
        "files": [
          {
            "path": "web/src/components/date-range-dropdowns.tsx",
            "description": "This file defines reusable React components for selecting date ranges, specifically tailored for dashboard and table contexts. It includes a base dropdown, and specialized components that handle entitlement-based limitations for available date range options.",
            "spof": false
          },
          {
            "path": "web/src/components/BatchExportTableButton.tsx",
            "description": "This React component provides a button with a dropdown menu to export data from a specified table within a Langfuse project. It allows users to select an export format and handles the queuing of the export process, including access checks and display of export status.",
            "spof": false
          },
          {
            "path": "web/src/components/table/data-table-ai-filters.tsx",
            "description": "This component enables AI-powered natural language filtering for data tables. It allows users to describe desired filters which are then generated via an API call and applied to the table.",
            "spof": false
          },
          {
            "path": "web/src/components/table/table-view-presets/validation.ts",
            "description": "This file provides utility functions to validate and normalize table view states, specifically for `orderBy` and `filters`, ensuring they reference valid and existing columns, and handling backward compatibility for filter column naming conventions.",
            "spof": true
          },
          {
            "path": "web/src/components/table/table-view-presets/README.md",
            "description": "This module provides a flexible and robust system for managing and persisting user-defined table views. It allows users to save, load, and share specific table configurations (e.g., column visibility, ordering, filters) while gracefully handling changes to the underlying table structure.",
            "spof": true
          },
          {
            "path": "web/src/components/table/table-view-presets/hooks/useViewData.ts",
            "description": "This file defines a React hook `useViewData` that fetches table view presets for a specific table and project using an API call. It provides the retrieved presets for display or further processing within a component.",
            "spof": true
          },
          {
            "path": "web/src/components/table/table-view-presets/hooks/useViewMutations.ts",
            "description": "This file defines a React hook `useViewMutations` that provides functions for creating, updating, deleting, and generating permalinks for table view presets, handling their success states.",
            "spof": true
          },
          {
            "path": "web/src/components/table/table-view-presets/hooks/useTableViewManager.ts",
            "description": "This file defines a React hook `useTableViewManager` that manages and persists table view states (e.g., filters, sorting, column visibility) across sessions and via URL permalinks. It fetches and applies saved view presets, handling their loading, validation, and application to the table.",
            "spof": false
          },
          {
            "path": "web/src/components/table/table-view-presets/components/data-table-view-presets-drawer.tsx",
            "description": "This file implements a React component for a drawer interface that allows users to manage (create, select, update, and delete) saved table view presets within a data table, including handling system-defined and user-defined presets.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/table-view-presets.clienttest.ts",
            "description": "This file contains client-side unit tests for the validation functions related to table view presets, specifically `validateOrderBy` and `validateFilters`.",
            "spof": true
          },
          {
            "path": "web/src/hooks/useDashboardDateRange.tsx",
            "description": "This React hook manages the selected dashboard date range, synchronizing it with URL query parameters for persistence and sharing. It handles the conversion between string representations in the URL and internal TimeRange objects.",
            "spof": true
          },
          {
            "path": "web/src/utils/date-range-utils.ts",
            "description": "This file defines predefined time range presets and utility functions for managing, validating, and formatting date ranges and time aggregation intervals used in UI components like dashboards and tables.",
            "spof": false
          },
          {
            "path": "web/src/features/batch-actions/components/BatchActionsTable.tsx",
            "description": "This file defines a React component, `BatchActionsTable`, which displays a paginated table of batch actions within a project. It fetches batch action data from an API and presents details such as action type, table name, status, progress, creation/completion times, initiating user, and logs.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-exports/server/batchExport.ts",
            "description": "This file defines the tRPC router for managing batch export operations, including creating, canceling, and listing export jobs within a project. It handles database interactions, access control, and queues export tasks for background processing.",
            "spof": false
          },
          {
            "path": "web/src/features/filters/filter-integration.clienttest.ts",
            "description": "This file contains integration tests for the filter query encoding and decoding mechanism, simulating the full URL lifecycle. It verifies that filter states can be correctly converted to and from URL query parameters, ensuring robustness and backward compatibility for saved filter configurations.",
            "spof": true
          },
          {
            "path": "web/src/features/filters/lib/filter-query-encoding-decoding.clienttest.ts",
            "description": "This file contains unit tests for the filter query encoding and decoding utility functions. It verifies that various filter states can be correctly converted to and from a URL-friendly query string format.",
            "spof": true
          },
          {
            "path": "web/src/features/filters/lib/filter-transform.ts",
            "description": "This file provides utility functions to normalize and transform filter column names and IDs. It ensures consistency between frontend display names, internal column IDs, and backend-specific column keys for filtering operations.",
            "spof": true
          },
          {
            "path": "web/src/features/filters/lib/filter-query-encoding.ts",
            "description": "This file provides utility functions for encoding and decoding `FilterState` objects to and from a semicolon-delimited string format, primarily for use in URL query parameters. It includes logic for handling array values, escaping special characters like pipes, and managing different filter types.",
            "spof": true
          },
          {
            "path": "web/src/features/filters/components/filter-builder.tsx",
            "description": "This file implements React components for building and displaying filters, featuring a popover-based filter builder and an inline display of active filters.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/ModelSelector.tsx",
            "description": "This file provides a reusable React component (`ModelSelectorPopover`) and a custom hook (`useModelSelection`) for selecting multiple models from a list, commonly used for filtering data in a dashboard.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/lib/dashboard-utils.ts",
            "description": "This file provides utility functions for dashboard data processing. It includes functions for remapping time-based filters for traces and formatting monetary values for display.",
            "spof": false
          },
          {
            "path": "packages/shared/src/domain/table-view-presets.ts",
            "description": "This file defines the data structures and types for managing table view presets within the application. It includes an enum for table names and a Zod schema for a table view preset object, specifying properties like filters, column order, and visibility.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/services/TableViewService/index.ts",
            "description": "This file serves as an entry point for the TableViewService module, re-exporting its core service and associated types for easier access.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/TableViewService/TableViewService.ts",
            "description": "This file defines the `TableViewService` class, which manages CRUD operations and utility functions for table view presets, including creation, updates, deletion, retrieval, and permalink generation.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/TableViewService/types.ts",
            "description": "This file defines Zod schemas and corresponding TypeScript types for managing table view presets, including inputs for creation, updates, and listing, used within a server-side service.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Nimar",
            "percent": 42
          },
          {
            "name": "marliessophie",
            "percent": 23
          },
          {
            "name": "Leo Weigand",
            "percent": 21
          }
        ]
      },
      "Dashboard & Widget Lifecycle Management": {
        "files": [
          {
            "path": "web/src/components/LangfuseLogo.tsx",
            "description": "This file defines and exports React components for displaying the Langfuse logo and icon, including support for custom logos, dark/light modes, different sizes, and an optional version label, primarily for use in navigation or branding.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/health.ts",
            "description": "This file defines a public Next.js API route for performing health checks on the application. It verifies database connectivity (PostgreSQL), checks for recent events in Clickhouse, and returns the application's status and version.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/index.tsx",
            "description": "This file defines the project-specific dashboard page, displaying various performance metrics, costs, and user activity through charts and tables. It includes filtering capabilities by time range, environment, and other trace-related properties.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/dashboards/index.tsx",
            "description": "This file defines the main page for displaying and managing dashboards within a specific project. It renders a table of existing dashboards and provides functionality to create new ones.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/dashboards/new.tsx",
            "description": "This file provides the UI and logic for creating a new dashboard within a specific project. It handles user input for the dashboard's name and description, verifies project access, and submits the creation request to the API.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/dashboards/[dashboardId]/index.tsx",
            "description": "This file implements the `DashboardDetail` page component, responsible for displaying, editing, and managing a specific dashboard within a project. It handles fetching dashboard data, widget placement, date range selection, and filter management.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/widgets/index.tsx",
            "description": "This file defines the page component for managing dashboard widgets within a specific project. It displays a table of existing widgets and provides functionality to create new ones.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/widgets/new.tsx",
            "description": "This file defines a Next.js page component for creating new analytical widgets within a specific project. It provides a form for configuring widget properties and handles the creation process, including redirection or prompting to add the new widget to a dashboard.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/widgets/[widgetId]/index.tsx",
            "description": "This page allows users to edit an existing dashboard widget. It fetches the widget's current details, provides a form for modification, and handles the update operation.",
            "spof": true
          },
          {
            "path": "web/src/features/cloud-status-notification/types.ts",
            "description": "Defines the possible status states for a cloud service, including operational, downtime, degraded, and maintenance.",
            "spof": true
          },
          {
            "path": "web/src/features/cloud-status-notification/components/CloudStatusMenu.tsx",
            "description": "This component displays the Langfuse Cloud service status in the sidebar, showing a visual alert if there is an ongoing incident. It fetches status information from an API and links to the official status page.",
            "spof": true
          },
          {
            "path": "web/src/features/cloud-status-notification/server",
            "description": "This directory is designated for server-side logic and APIs related to managing and delivering cloud status notifications within the Langfuse web application. It would typically handle the backend processes for fetching or pushing cloud status information to users.",
            "spof": false
          },
          {
            "path": "web/src/features/widgets/utils.ts",
            "description": "This file provides utility functions for formatting metric names and constructing human-readable names and descriptions for dashboard widgets based on their configuration, metrics, dimensions, aggregations, and filters.",
            "spof": false
          },
          {
            "path": "web/src/features/widgets/index.ts",
            "description": "This file serves as an index for the widgets feature, re-exporting various UI components, data types, and utility functions. It provides a centralized entry point for accessing widget-related functionalities within the application.",
            "spof": false
          },
          {
            "path": "web/src/features/widgets/components/WidgetTable.tsx",
            "description": "This file defines components for displaying and managing dashboard widgets. It includes a table component to list widgets with pagination and sorting, and a separate component for deleting individual widgets.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/components/WidgetPropertySelectItem.tsx",
            "description": "This file defines a reusable `SelectItem` component for widget properties. It includes a `HoverCard` that displays documentation, unit, and type details when the item is hovered over.",
            "spof": false
          },
          {
            "path": "web/src/features/widgets/components/DashboardWidget.tsx",
            "description": "This React component displays a single widget within a dashboard, fetching its configuration and data, and rendering the appropriate chart. It also provides interactive features like editing, copying, or deleting the widget based on user permissions.",
            "spof": false
          },
          {
            "path": "web/src/features/widgets/components/SelectWidgetDialog.tsx",
            "description": "This component renders a dialog that allows users to select an existing dashboard widget from a list to add to a dashboard, or navigate to a page to create a new widget. It displays a table of available widgets and handles their selection.",
            "spof": false
          },
          {
            "path": "web/src/features/widgets/components/DashboardGrid.tsx",
            "description": "This file defines the `DashboardGrid` component, responsible for rendering and managing a responsive grid layout of dashboard widgets. It utilizes `react-grid-layout` for editable drag-and-drop functionality on larger screens and a simple stacked layout for smaller screens.",
            "spof": false
          },
          {
            "path": "web/src/features/widgets/components/WidgetForm.tsx",
            "description": "This file implements a React component (`WidgetForm`) that provides a user interface for creating and editing various dashboard widgets. It allows users to configure widget properties such as name, description, data view, metrics, dimensions, chart type, filters, and date ranges.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/LeftAlignedCell.tsx",
            "description": "This file defines the `LeftAlignedCell` React component, a simple UI component that renders its children left-aligned within a div element. It is likely used for consistent text alignment in dashboard displays.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/TabsComponent.tsx",
            "description": "This file defines a reusable React component for displaying tabbed content, providing different UI renditions for mobile (dropdown) and desktop (tab bar) views. It manages the active tab state and displays the corresponding content.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/DashboardTable.tsx",
            "description": "This file defines the `DashboardTable` component, which displays a paginated and sortable table of dashboards for a specific project. It includes functionalities for viewing, editing, cloning, and deleting dashboards, as well as navigating to individual dashboard detail pages.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/components/EditDashboardDialog.tsx",
            "description": "This file defines a React component that displays a dialog for editing an existing dashboard's name and description. It includes input fields for the dashboard's metadata and uses an API mutation to save the changes.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/SelectDashboardDialog.tsx",
            "description": "This file defines a React component for a dialog that allows users to select an existing dashboard to add a widget to, or to skip this action. It fetches and displays a list of project-owned dashboards for selection.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/cards/DashboardCard.tsx",
            "description": "This file defines a reusable React component, `DashboardCard`, which provides a structured UI card for dashboards. It includes features like a title, description, loading indicator, and customizable content areas.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/cards/ChevronButton.tsx",
            "description": "This file exports an `ExpandListButton` component, which provides a UI element with a chevron icon and text to toggle the expanded state of a list, appearing only when the list's total length exceeds a maximum length.",
            "spof": false
          },
          {
            "path": "web/src/features/navigation/utils/dashboard-tabs.ts",
            "description": "This file defines constants, types, and a utility function for generating navigation tabs related to dashboards and widgets within a project. It provides structured data for consistent UI navigation.",
            "spof": true
          },
          {
            "path": "worker/src/scripts/upsertLangfuseDashboards.ts",
            "description": "This script manages Langfuse dashboards and their widgets, reading definitions from a JSON file and using Prisma to upsert them into the database, skipping already up-to-date entries by default.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/DashboardService/index.ts",
            "description": "This file serves as an entry point for the DashboardService module, exporting both the service implementation and its associated types.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/DashboardService/DashboardService.ts",
            "description": "This file defines the `DashboardService` class, which provides methods for managing dashboards and their associated widgets. It handles CRUD operations, updates, and retrieval for both dashboards and individual widgets within a project context.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/DashboardService/types.ts",
            "description": "This file defines Zod schemas for data structures related to dashboards and their widgets, including chart configurations, widget properties, and dashboard layouts. It also exports derived TypeScript types for these entities, used for validation and type safety within the DashboardService.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Steffen Schmitz",
            "percent": 59
          },
          {
            "name": "Thorsten Spieker",
            "percent": 21
          },
          {
            "name": "Marc Klingen",
            "percent": 10
          }
        ]
      },
      "Data Visualization & Charting": {
        "files": [
          {
            "path": "web/src/components/stats-cards.tsx",
            "description": "This React component renders a collection of statistics in a card-based layout, typically used to display information like model configuration details.",
            "spof": true
          },
          {
            "path": "web/src/components/table/utils/joinTableCoreAndMetrics.ts",
            "description": "This file exports a utility function that merges core data objects with corresponding metric data objects based on a common 'id' property, preparing the combined data for display in a table.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/pivot-table.clienttest.tsx",
            "description": "This file contains unit tests for the `PivotTable` React component, ensuring its correct rendering, styling, data handling (including empty and various data types), column header formatting, responsiveness, and accessibility features. It uses Jest and React Testing Library to verify component functionality under various scenarios.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/prompts/metrics.tsx",
            "description": "This file implements a React component that displays a data table of prompt versions for a given project, including their key metrics like latency, token usage, cost, generation count, and score aggregates. It fetches prompt version data and associated metrics from an API and presents them in a sortable, paginated table.",
            "spof": false
          },
          {
            "path": "web/src/features/comments/CommentCountIcon.tsx",
            "description": "This React component (`CommentCountIcon`) displays a message circle icon with an overlaid comment count. It provides a visual indicator for the number of comments, showing '99+' for counts greater than 99.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/chart-library/VerticalBarChart.tsx",
            "description": "This file defines a React component for a vertical bar chart, utilizing `recharts` to display data with configurable styles and accessibility features.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/chart-library/chart-props.ts",
            "description": "Defines interfaces for data points and properties used to configure and render charts within the application's chart library.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/chart-library/Chart.tsx",
            "description": "This file defines a `Chart` React component that acts as a universal renderer for various chart types based on the `chartType` prop. It handles data processing, renders the appropriate chart component, and includes a warning for large datasets to prevent performance issues.",
            "spof": false
          },
          {
            "path": "web/src/features/widgets/chart-library/BigNumber.tsx",
            "description": "This React component, `BigNumber`, displays a single large numerical value, dynamically formatting it with units (K, M, B, T) and adjusting its font size and decimal places to fit responsively within its container.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/chart-library/HistogramChart.tsx",
            "description": "This component renders a histogram chart using Recharts, capable of displaying data from various formats, including a specific ClickHouse histogram output. It visualizes the distribution of numerical data into bins.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/chart-library/utils.ts",
            "description": "This file provides utility functions for processing chart data, grouping it by time dimensions, extracting unique dimensions, determining chart types, and formatting chart labels and display names within a chart library context.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/chart-library/PivotTable.tsx",
            "description": "This file implements a React component for a configurable pivot table, displaying grouped and aggregated data in a tabular format with support for dimensions, metrics, subtotals, grand totals, and interactive sorting. It transforms raw chart data into a structured pivot table for visualization.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/chart-library/VerticalBarChartTimeSeries.tsx",
            "description": "This file defines a React component, `VerticalBarChartTimeSeries`, which renders a time-series vertical bar chart using Recharts. It displays grouped and potentially stacked bar data over time, supporting multiple dimensions.",
            "spof": true
          },
          {
            "path": "web/src/features/widgets/utils/pivot-table-utils.ts",
            "description": "Provides utility functions and type definitions for transforming flat query results into a nested pivot table structure. It supports configurable dimensions, metrics, subtotals, grand totals, and row limiting for display.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/components/RightAlignedCell.tsx",
            "description": "This file defines a React component, `RightAlignedCell`, which is used to render content right-aligned within a cell, typically for display in a dashboard table or grid.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/components/LatencyChart.tsx",
            "description": "This component visualizes the latency percentiles of LLM generations over time, allowing users to select specific models for analysis within a dashboard.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/ChartScores.tsx",
            "description": "This component fetches score data and displays it as a time series chart within a dashboard card, showing the moving average of scores over a specified period.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/TotalMetric.tsx",
            "description": "This file defines the `TotalMetric` React component, which displays a key metric with an optional descriptive text. It is designed for use in dashboards to present single, prominent data points.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/components/ModelCostTable.tsx",
            "description": "This file defines the ModelCostTable React component, which displays a table summarizing model costs and token usage for a given project within a specified time range on a dashboard.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/components/BaseTimeSeriesChart.tsx",
            "description": "This component provides a reusable base for rendering time series data using either an area or line chart from the Tremor library. It handles data transformation, date formatting based on aggregation, dynamic Y-axis scaling, and custom tooltips for displaying time-based metrics.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/UserChart.tsx",
            "description": "This file defines the `UserChart` React component, which visualizes and displays user consumption metrics on a dashboard, including token cost and trace counts, presented in a tabbed bar list.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/components/ModelUsageChart.tsx",
            "description": "This file implements the ModelUsageChart component, which visualizes model usage and cost data over time within the dashboard. It fetches, processes, and displays time series data for total cost and tokens, broken down by model and type, with options for model selection and filtering.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/ScoresTable.tsx",
            "description": "This component (`ScoresTable.tsx`) displays an aggregated table of scores for a dashboard, showing metrics like total count, average value, and counts for specific values (0 and 1) for each score based on user-defined filters.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/Tooltip.tsx",
            "description": "This file defines a custom React component for displaying a chart tooltip, built on Tremor's `CustomTooltipProps`. It shows categorized data points with their names, formatted values, and corresponding colors, handling data filtering and sorting.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/components/TabTimeSeriesChart.tsx",
            "description": "This component renders a tabbed interface where each tab displays a total metric and its corresponding time series chart. It combines a `TotalMetric` component with a `BaseTimeSeriesChart` within a Tremor tab group.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/hooks.ts",
            "description": "This file contains hooks and utility functions for fetching, processing, and transforming data for dashboard components, primarily focusing on time-series charts and extracting model usage statistics from database query results.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/score-analytics/NumericScoreHistogram.tsx",
            "description": "This React component fetches and displays a numeric or boolean score histogram for specific score analytics, utilizing a bar chart to visualize the distribution of scores within a project, based on various filters.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/cards/DashboardTable.tsx",
            "description": "This file defines the `DashboardTable` React component, a reusable UI element for displaying tabular data within the dashboard. It supports features like collapsible rows, loading states, and a message display for when no data is available.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/utils/getColorsForCategories.tsx",
            "description": "This file provides utility functions for assigning a set of predefined or randomly selected colors to a given list of categories, ensuring each category can have a distinct color.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Thorsten Spieker",
            "percent": 41
          },
          {
            "name": "Steffen Schmitz",
            "percent": 22
          },
          {
            "name": "Max Deichmann",
            "percent": 9
          }
        ]
      },
      "Backend Data Aggregation & Querying": {
        "files": [
          {
            "path": "web/src/__tests__/pivot-table-utils.servertest.ts",
            "description": "This file contains comprehensive unit tests for the pivot table data transformation utilities. It covers various scenarios, edge cases, and configuration validation for functions related to pivot table generation, data grouping, and metric calculations.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/queryBuilderDashboards.servertest.ts",
            "description": "This file contains server-side integration tests for the dashboard query builder. It verifies that queries correctly retrieve and filter trace data based on various criteria like environment and time from the ClickHouse database.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/repositories/dashboard-repository.servertest.ts",
            "description": "This file contains server-side tests for dashboard repository functions, specifically verifying the `orderByTimeSeries` utility for generating ClickHouse time-series queries and `getObservationUsageByTypeByTime` for retrieving grouped observation usage data.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/metrics/index.ts",
            "description": "This file defines a public API endpoint for retrieving project-specific metrics. It handles authentication, validates query parameters, executes the metric query, and returns the results.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/server/dailyMetrics.ts",
            "description": "This file provides server-side functions to query and aggregate daily metrics from a ClickHouse database, including detailed usage statistics for LLM traces and observations, and the count of unique metric days.",
            "spof": true
          },
          {
            "path": "web/src/features/query/dashboardUiTableToViewMapping.ts",
            "description": "This file provides mappings to convert UI table column names to their internal API/database view names for different data views (traces, observations, scores). It includes a function to translate legacy UI table filters into view-specific filters based on these mappings.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/server",
            "description": "This directory is intended to house server-side logic, API endpoints, or data fetching utilities specifically for the dashboard feature within the Langfuse web application. It handles the backend responsibilities required to power the dashboard's functionality and data presentation.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/repositories/dashboards.ts",
            "description": "This file provides server-side repository functions for fetching and aggregating various dashboard-related analytics data (e.g., scores, observation costs, usage) from ClickHouse, including time-series data aggregation and filter handling.",
            "spof": false
          },
          {
            "path": "packages/shared/src/tableDefinitions/mapDashboards.ts",
            "description": "This file defines the mappings between user interface column names and IDs, and their corresponding ClickHouse database table names and select statements, primarily used for dashboards. It serves as a central configuration for displaying data fields from the database in the UI.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Steffen Schmitz",
            "percent": 59
          },
          {
            "name": "Thorsten Spieker",
            "percent": 20
          },
          {
            "name": "Max Deichmann",
            "percent": 14
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 95,
      "spofCount": 53
    },
    "busFactor": 3,
    "authorCount": 9
  },
  "Prompt Management": {
    "description": "A centralized hub for versioning, managing, and collaborating on prompts. Enables teams to track changes, manage production vs. staging prompts via labels, and integrate them dynamically into their applications.",
    "functions": {
      "Prompt Metadata Management UI": {
        "files": [
          {
            "path": "web/src/components/TruncatedLabels.tsx",
            "description": "This component displays a list of labels, truncating them if they exceed a specified maximum and providing a hover card to view all labels. It prioritizes 'PRODUCTION_LABEL' and 'LATEST_PROMPT_LABEL' in the display order.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/utils.ts",
            "description": "This utility file provides a function to determine if a given prompt label is a reserved label (e.g., 'production' or 'latest'). It helps manage special prompt labels within the application's prompt features.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/server/utils/updatePromptLabels.ts",
            "description": "This file defines a utility function to remove specific labels from previous versions of a prompt within a given project in the database. It finds prompts by project ID and name, then updates them by filtering out the specified labels.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/server/utils/checkHasProtectedLabels.ts",
            "description": "This utility function checks if any of the provided prompt labels are designated as protected for a specific project by querying the database. It returns whether protected labels are present and lists them.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/components/delete-prompt.tsx",
            "description": "This file defines a React component that provides a UI for deleting a prompt, including a confirmation popover, access control checks, and handling of the deletion API call.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/components/auto-complete.tsx",
            "description": "This file defines a reusable React `AutoComplete` component that provides an input field with auto-completion capabilities, allowing users to select from a list of options or create a new one. It uses `cmdk` for the command menu functionality.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/components/duplicate-prompt.tsx",
            "description": "This file provides React components and logic for duplicating a prompt within a project, including a form for user input (new name, copy single or all versions) and a button to trigger the duplication dialog.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/components/ProtectedLabelsSettings.tsx",
            "description": "This component provides a user interface for managing 'protected labels' within a project, allowing authorized users to add or remove labels that are shielded from modification by other users. It integrates with API calls for fetching, adding, and removing these labels, and enforces access control based on user roles and entitlements.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/components/delete-prompt-version.tsx",
            "description": "This file defines a React component that allows users to delete a specific version of a prompt. It includes a confirmation popover, handles the API call for deletion, manages UI state, and performs redirects or invalidates cache upon success or failure.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/components/SetPromptVersionLabels/LabelCommandItem.tsx",
            "description": "This component renders a selectable label item used for assigning or managing labels for prompt versions. It allows users to toggle the selection state of an individual label.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/components/SetPromptVersionLabels/index.tsx",
            "description": "This component provides a UI for managing and assigning labels to a specific prompt version, including custom labels and a special 'production' label, within a popover interface.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/components/SetPromptVersionLabels/AddLabelForm.tsx",
            "description": "This file defines a React component, `AddLabelForm`, which provides a form for users to add new labels to prompt versions. It includes client-side validation to prevent adding reserved labels like 'latest' or 'production' and integrates analytics tracking for label additions.",
            "spof": false
          },
          {
            "path": "web/src/features/tag/components/TagPromptDetailsPopover.tsx",
            "description": "This component manages and displays tags for a specific prompt, allowing users with appropriate project access to update them.",
            "spof": false
          },
          {
            "path": "web/src/features/tag/components/TagButton.tsx",
            "description": "This file defines the `TagButton` React component, which displays a tag with an associated icon. It supports loading states, view-only mode, and adjusts its appearance based on context (e.g., table cell).",
            "spof": false
          },
          {
            "path": "web/src/features/tag/components/TagPromptPopover.tsx",
            "description": "This file defines a React component, `TagPromptPopover`, which provides a UI for managing and updating tags associated with a specific prompt within a project. It handles tag display, editing, and integration with a backend API for persistence.",
            "spof": true
          },
          {
            "path": "web/src/features/tag/components/TagCreateItem.tsx",
            "description": "This component renders a 'Create new tag' suggestion item within a command palette, appearing when a user types a tag name that doesn't already exist in the available options.",
            "spof": true
          },
          {
            "path": "web/src/features/tag/components/TagList.tsx",
            "description": "This component (`TagList`) displays a list of tags using `TagButton` components. It can render either selectable/interactive tag buttons or a placeholder icon if no tags are present.",
            "spof": false
          },
          {
            "path": "web/src/features/tag/components/TagCommandItem.tsx",
            "description": "This file defines the `TagCommandItem` component, which represents a selectable tag within a command palette or list. It allows users to add a tag to a collection and tracks the selection event.",
            "spof": false
          },
          {
            "path": "web/src/features/tag/components/TagInput.tsx",
            "description": "This React component provides a tag input field, displaying selected tags as removable buttons and integrating with a command primitive input for adding new tags. It also includes analytics for tag removal actions.",
            "spof": true
          },
          {
            "path": "web/src/features/tag/components/TagManager.tsx",
            "description": "This file defines the `TagManager` React component, which provides a UI for viewing, adding, and removing tags associated with an item like a prompt or trace, typically within a popover or table cell.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "marliessophie",
            "percent": 34
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 21
          },
          {
            "name": "Nimar",
            "percent": 17
          }
        ]
      },
      "Prompt Content Editor and Renderer": {
        "files": [
          {
            "path": "web/src/components/editor/index.ts",
            "description": "This file serves as an entry point for the editor component, re-exporting the CodeMirrorEditor. It provides a unified import for the CodeMirror-based editor functionality.",
            "spof": true
          },
          {
            "path": "web/src/components/editor/PromptLinkingEditor.tsx",
            "description": "This component provides a CodeMirror editor augmented with the ability to link and insert references to existing prompts by opening a selection dialog.",
            "spof": true
          },
          {
            "path": "web/src/components/editor/dark-theme.ts",
            "description": "This file defines the dark theme for the CodeMirror editor, specifying styling for various syntax elements and exporting the complete theme configuration.",
            "spof": true
          },
          {
            "path": "web/src/components/editor/CodeMirrorEditor.tsx",
            "description": "This file defines a reusable CodeMirror editor component for React applications, providing syntax highlighting and linting for JSON, plain text, and a custom 'prompt' mode with specialized variable and tag validation.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/compileChatMessages.servertest.ts",
            "description": "This test file verifies the functionality of `compileChatMessages` and `extractPlaceholderNames`, ensuring that chat message templates are correctly processed, placeholders are substituted, and placeholder names can be extracted.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/components/PromptVariableListPreview.tsx",
            "description": "This component renders a preview list of prompt variables, displaying each variable as a badge. It shows a message indicating the available variables if the list is not empty.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/components/PromptVersionDiffDialog.tsx",
            "description": "This component renders a dialog that displays the differences between two versions of a prompt, showing changes in both content and configuration.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/components/prompt-content-utils.tsx",
            "description": "This file provides React components and a utility function to parse and render rich prompt content, highlighting prompt variables and clickable prompt dependencies within a given text string.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/components/prompt-history.tsx",
            "description": "This file defines React components for displaying and interacting with the version history of a prompt. It renders a timeline of prompt versions, allowing users to view details, compare versions, manage labels, and navigate through the history.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/components/NewPromptForm/ReviewPromptDialog.tsx",
            "description": "This file defines a React component `ReviewPromptDialog` which provides a dialog for users to review changes between an existing prompt and a new draft prompt. It displays a diff of the prompt's content and configuration, allowing users to confirm and save a new version.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/components/NewPromptForm/PromptChatMessages.tsx",
            "description": "This component manages and renders a list of chat messages within a prompt form, providing functionality to add, update, delete, and replace messages. It integrates with a form controller to update message changes and allows users to reference existing prompts.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/llm/compileChatMessages.ts",
            "description": "This file provides utilities for compiling and transforming chat messages. It handles the expansion of placeholder messages into concrete message arrays and the substitution of text variables within message content.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/prompts.ts",
            "description": "This file defines the `PromptMessage` interface and provides client-safe utility functions for handling prompt messages, such as extracting placeholder names.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Nimar",
            "percent": 46
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 19
          },
          {
            "name": "marliessophie",
            "percent": 19
          }
        ]
      },
      "Prompt Management UI": {
        "files": [
          {
            "path": "web/src/components/onboarding/PromptsOnboarding.tsx",
            "description": "This file defines the `PromptsOnboarding` React component, which displays an onboarding splash screen introducing users to Langfuse's prompt management features, detailing its benefits and providing actions to get started or learn more.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/_shared/PromptBadge.tsx",
            "description": "This component fetches details for a specific prompt by ID within a project and displays them as a clickable badge. It provides a link to the prompt's detail page.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/prompts/prompt-detail.tsx",
            "description": "This file serves as a page component responsible for displaying the detailed view of a specific prompt within a project in the web application.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/prompts/new.tsx",
            "description": "This file defines the page component for creating a new prompt within a specific project. It re-exports the `NewPrompt` component from the features directory.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/prompts/[[...folder]].tsx",
            "description": "This Next.js page renders the main interface for managing prompts within a project, handling navigation between prompt folders, individual prompt details, and prompt metrics based on the URL structure. It also includes an onboarding flow for new projects and actions for creating new prompts.",
            "spof": false
          },
          {
            "path": "web/src/hooks/useCollapsibleSystemPrompt.ts",
            "description": "This React hook manages the display of long system prompts, automatically collapsing them if they exceed a certain character threshold. It also allows users to manually toggle the collapsed state and persists this preference in local storage.",
            "spof": true
          },
          {
            "path": "web/src/features/filters/config/prompts-config.ts",
            "description": "This file defines the filter configuration for prompts, specifying the table name, column definitions, and available facets for filtering such as type, labels, tags, and version.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/components/prompt-new.tsx",
            "description": "This file defines the page for creating a new prompt or a new version of an existing prompt within the Langfuse application. It handles fetching an initial prompt if specified by a query parameter and renders the `NewPromptForm` component.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/components/prompts-table.tsx",
            "description": "This file defines the `PromptTable` React component, which displays a paginated and sortable table of prompts and folders. It supports filtering, full-text search, and navigating through prompt folders, fetching data and metrics from the Langfuse API.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/components/PromptSelectionDialog.tsx",
            "description": "This file defines the `PromptSelectionDialog` component, which allows users to select a prompt by name and then specify either a version or a label to generate an inline prompt reference tag. This tag can then be copied to the clipboard or inserted into content, enabling dynamic resolution of prompts.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/components/prompt-detail.tsx",
            "description": "This file defines the `PromptDetail` React component, which displays a comprehensive view of a specific prompt within the Langfuse application. It allows users to browse different prompt versions, view its content, generate SDK code snippets, and manage related features like experiments, tags, and comments.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/components/NewPromptForm/validation.ts",
            "description": "This file defines Zod validation schemas for forms related to creating and updating prompts, distinguishing between chat and text prompt types, and their content and metadata.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/components/NewPromptForm/index.tsx",
            "description": "This file defines the `NewPromptForm` React component, which provides a comprehensive form for creating new prompts or editing existing ones in the Langfuse application. It handles prompt types (text or chat), variable extraction, configuration, validation, and submission to the API.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/hooks/usePromptNameValidation.tsx",
            "description": "This file defines a React hook `usePromptNameValidation` that validates if a given prompt name is unique among a list of existing prompts. It sets a form error if the name already exists and clears it otherwise.",
            "spof": false
          },
          {
            "path": "web/src/features/navigation/utils/prompt-tabs.ts",
            "description": "This file defines constants for prompt-related tabs (versions and metrics) and provides a utility function to generate navigation links for these tabs based on a given project and prompt name.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/SaveToPromptButton.tsx",
            "description": "This component provides a button that allows users to save the current state of a playground (model parameters, messages, and output) as a new prompt or a new version of an existing chat prompt. It integrates with prompt management and navigation features within the application.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Nimar",
            "percent": 31
          },
          {
            "name": "marliessophie",
            "percent": 23
          },
          {
            "name": "Leo Weigand",
            "percent": 21
          }
        ]
      },
      "Prompt Schema and Storage": {
        "files": [
          {
            "path": "web/src/components/schemas/ChatMlSchema.ts",
            "description": "This file re-exports ChatML message and array schemas from a shared library, providing standard definitions for ChatML structured data within the web application.",
            "spof": false
          },
          {
            "path": "web/src/features/llm-schemas/validation.ts",
            "description": "This file defines Zod schemas for validating data related to LLM schemas, including their names, input structures, and operations like creation, update, and deletion.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/features/prompts/validation.ts",
            "description": "This file defines Zod validation schemas specifically for parameters related to the 'prompts' feature, such as prompt names, labels, versions, and commit messages.",
            "spof": true
          },
          {
            "path": "web/src/features/natural-language-filters/server/validation.ts",
            "description": "This file defines Zod schemas and TypeScript types for validating input related to creating natural language filter completions on the server side, ensuring data integrity for projectId and prompt.",
            "spof": true
          },
          {
            "path": "packages/shared/src/domain/prompts.ts",
            "description": "This file defines the Zod schema and TypeScript type for a prompt domain object, including its properties, validation rules, and default values. It serves as a shared data model for prompt entities within the application.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/PromptService/types.ts",
            "description": "Defines the data structures and types used by the PromptService, including prompt results, parameters, metrics, and graph representations for managing prompt versions and dependencies.",
            "spof": false
          },
          {
            "path": "packages/shared/src/utils/IORepresentation/index.ts",
            "description": "This file serves as a barrel export for utilities related to input/output representation, including functions for parsing I/O and type definitions for the ChatML format.",
            "spof": true
          },
          {
            "path": "packages/shared/src/tableDefinitions/promptsTable.ts",
            "description": "This file defines the column structure for a 'prompts' table, including static definitions and functions to dynamically add options for 'tags' and 'labels' columns.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/prompts/validation.ts",
            "description": "Defines validation schemas and rules for prompt names, ensuring they adhere to specific formatting, character restrictions, and reserved name constraints.",
            "spof": false
          },
          {
            "path": "packages/shared/src/features/prompts/types.ts",
            "description": "This file defines Zod schemas and TypeScript types for managing prompts, including their creation, retrieval, and validation. It supports both text and chat-based prompts and handles metadata, labels, and commit messages.",
            "spof": false
          },
          {
            "path": "packages/shared/src/features/prompts/constants.ts",
            "description": "This file defines constants and validation rules for prompt-related features, including prompt names, labels, and commit messages. It centralizes shared configuration for prompts within the application.",
            "spof": true
          },
          {
            "path": "packages/shared/prisma/migrations/20231230151856_add_prompt_table",
            "description": "This directory contains a specific Prisma database migration. Its purpose is to add a new 'prompt' table to the shared database schema within the application.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240214232619_prompts_add_indicies",
            "description": "This directory represents a specific database migration script for the `langfuse` project, likely using Prisma. It is responsible for adding indices to the 'prompts' table in the database schema, as indicated by the timestamped name and common migration patterns.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240219162415_add_prompt_config",
            "description": "This directory represents a specific database migration within the Prisma schema for the `shared` package. It was created on February 19, 2024, and is responsible for adding 'prompt_config' related changes to the database schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240405124810_prompt_to_json",
            "description": "This directory contains a specific Prisma database migration script. It is responsible for a schema change related to converting or managing a 'prompt' field as JSON data within the shared package.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240408134328_prompt_table_add_tags",
            "description": "This directory contains a specific Prisma migration file. Its purpose is to define the database schema changes for adding a 'tags' field to the 'prompt' table. This migration ensures the database can store tags associated with prompts.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "marliessophie",
            "percent": 35
          },
          {
            "name": "Michael Frhlich",
            "percent": 27
          },
          {
            "name": "Nimar",
            "percent": 23
          }
        ]
      },
      "Prompt Lifecycle and Caching Service": {
        "files": [
          {
            "path": "web/src/__tests__/promptCache.servertest.ts",
            "description": "This file contains unit tests for the `PromptService`'s caching mechanisms, verifying its interactions with Redis for prompt storage, retrieval, locking, invalidation, and error handling.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/prompts-trpc.servertest.ts",
            "description": "This file contains asynchronous server-side integration tests for the `prompts` TRPC router. It verifies the functionality of prompt label setting, tag updating across versions, and prompt deletion, including their interactions with database operations and automation triggers.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/README.md",
            "description": "This README describes the caching strategy for prompts within the Langfuse application, detailing how Redis is used for cache management, including key structure, and how prompt creation, updates, and reads interact with the cache.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/server/promptChangeEventSourcing.ts",
            "description": "This file defines a function to queue prompt change events for asynchronous processing, recording modifications to prompts in a system for later handling or auditing.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/server/utils/updatePromptTags.ts",
            "description": "This file contains a utility function to update the tags for all versions of a specific prompt within a project in the database. It ensures the tags are unique for each prompt version.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/server/actions/getPromptsMeta.ts",
            "description": "This file defines a server-side action to retrieve metadata for prompts, including their versions, labels, tags, and latest configurations, with support for pagination and various filtering options.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/server/actions/updatePrompts.ts",
            "description": "This file defines a server-side action to update a specific version of a prompt, primarily by adding new labels to it. It also includes logic to prevent the removal of labels that are dependencies for other prompts and handles cache invalidation and event sourcing for the updated prompts.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/server/actions/README.md",
            "description": "This README.md file documents the prompt mutation actions, explaining the rules for using functions in this directory instead of direct Prisma calls. It details the reasons behind these rules, such as cache invalidation and event sourcing, and lists available functions.",
            "spof": true
          },
          {
            "path": "web/src/features/prompts/server/actions/getPromptByName.ts",
            "description": "This file defines a server action to retrieve a prompt by its name within a specific project, supporting lookup by version, label, or the production label by default. It can fetch raw prompt data or resolve dependencies via a dedicated service.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/server/actions/createPrompt.ts",
            "description": "This file contains server-side actions for creating new prompt versions and duplicating existing prompts within a project. It manages prompt versioning, labels, tags, dependencies, and cache invalidation.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/server/actions/deletePrompt.ts",
            "description": "This file defines a server action to delete specific versions of a prompt, including dependency checks to prevent breaking other prompts, managing the 'latest' label, and invalidating the cache.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/promptVersionProcessor.test.ts",
            "description": "This file contains unit tests for the `promptVersionProcessor` function, which handles entity change events related to prompt versions. It verifies that automations (like webhooks) are correctly triggered based on prompt creation, update, and specific filtering conditions.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/PromptService/index.ts",
            "description": "This file defines the PromptService class, responsible for retrieving, caching, and resolving prompts, including handling their dependencies and managing cache invalidation.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/prompts/parsePromptDependencyTags.ts",
            "description": "This file defines utilities for parsing and extracting Langfuse prompt dependency tags from strings. It identifies tags containing either a specific version or a label for a prompt, validating them against a Zod schema.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Max Deichmann",
            "percent": 47
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 26
          },
          {
            "name": "Nimar",
            "percent": 14
          }
        ]
      },
      "Prompt Public API": {
        "files": [
          {
            "path": "web/src/__tests__/prompts.v1.servertest.ts",
            "description": "This file contains integration tests for the `/api/public/prompts` API endpoint, verifying its functionality for creating, retrieving, and managing prompts, including scenarios with versioning, labels, and activation status.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/async/prompts.v2.servertest.ts",
            "description": "This file contains asynchronous server-side integration tests for the `/api/public/v2/prompts` endpoint, verifying prompt creation, retrieval by name, version, and labels, and access control.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/prompts.ts",
            "description": "This Next.js API route provides public endpoints for retrieving and creating prompts within a project, including authentication, authorization, and rate limiting.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/v2/prompts/index.ts",
            "description": "This file defines the public API endpoint for prompt-related operations under `/v2/prompts`, re-exporting the main handler from the prompts feature.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/v2/prompts/[promptName]/versions/[promptVersion].ts",
            "description": "This file defines an API endpoint for retrieving a specific version of a named prompt. It re-exports the `promptVersionHandler` to manage requests for a particular prompt's version.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/v2/prompts/[promptName]/index.ts",
            "description": "This file defines a public API endpoint for a specific prompt by re-exporting its handler. It acts as the entry point for requests to '/api/public/v2/prompts/[promptName]'.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/server/utils/authorizePromptRequest.ts",
            "description": "This file provides a utility function to authorize API requests for prompt-related operations. It verifies authentication headers, ensures a valid secret key, and confirms project-level access before proceeding.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/server/handlers/promptVersionHandler.ts",
            "description": "This file defines an API handler for updating a specific version of a prompt, allowing modification of its labels. It includes authentication, input validation, and audit logging for prompt updates.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/server/handlers/promptsHandler.ts",
            "description": "This file defines the API handlers for managing prompts, specifically for retrieving prompt metadata (GET) and creating new prompts (POST), including authorization, rate limiting, and data validation.",
            "spof": false
          },
          {
            "path": "web/src/features/prompts/server/handlers/promptNameHandler.ts",
            "description": "This file defines a Next.js API handler for managing prompt resources by name. It provides functionality to retrieve prompt details via a GET request and delete specific prompt versions or labels via a DELETE request, including authorization, rate limiting, and audit logging.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 28
          },
          {
            "name": "Domakonda SaiSharan",
            "percent": 25
          },
          {
            "name": "Nimar",
            "percent": 21
          }
        ]
      },
      "Prompt Tooling Protocol (MCP)": {
        "files": [
          {
            "path": "web/src/__tests__/async/mcp-tools-write.servertest.ts",
            "description": "This file contains server-side integration tests for the Managed Prompt Component (MCP) write tools, specifically testing the creation of text and chat prompts and their various attributes like labels, configuration, and versioning.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/mcp-tools-read.servertest.ts",
            "description": "This file contains asynchronous server-side integration tests for the read operations (get and list) of the MCP (Multi-Configuration Prompts) prompt management tools. It verifies functionalities like fetching prompts by various criteria, error handling, and tenant isolation.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/mcp/index.ts",
            "description": "This file defines a Next.js API endpoint for the Model Context Protocol (MCP), enabling AI assistants to interact with Langfuse prompts and resources via a streamable HTTP transport, including authentication and rate limiting.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/README.md",
            "description": "This README documents the Langfuse Model Context Protocol (MCP) server, which enables AI assistants to programmatically interact with Langfuse prompts. It covers setup instructions, available tools, architectural details, and client connection guides.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/server/bootstrap.ts",
            "description": "This file bootstraps and registers all Multiple Choice Platform (MCP) features, such as prompts, with the application's tool registry during server startup.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/features/prompts/index.ts",
            "description": "This file defines and registers the 'prompts' feature module for the MCP server. It provides tools to manage Langfuse prompts, including creating, retrieving, and updating prompt versions.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/features/prompts/tools/createTextPrompt.ts",
            "description": "This file defines an MCP (Multi-Cloud Platform) tool for Langfuse that allows creating a new version of a text prompt. It includes schema definitions for input validation and an asynchronous handler that orchestrates the prompt creation, audit logging, and result reporting.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/features/prompts/tools/listPrompts.ts",
            "description": "This file defines the 'listPrompts' MCP (Multi-Cloud Platform) tool, which enables listing and filtering of prompts within a project, providing metadata such as versions, labels, and tags. It is a read-only operation.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/features/prompts/tools/updatePromptLabels.ts",
            "description": "Defines and implements an MCP (Managed Control Plane) tool for updating labels on a specific version of a prompt. It provides the sole mechanism for modifying prompt labels, handling validation, database updates, and audit logging.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/features/prompts/tools/getPromptUnresolved.ts",
            "description": "This file defines an MCP (Modular Component Platform) tool that fetches a specific prompt by name, label, or version, returning its raw content with dependency tags intact for analysis without resolving those dependencies.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/features/prompts/tools/getPrompt.ts",
            "description": "This file defines a read-only tool (`getPrompt`) for the MCP (Multi-Cloud Platform) that fetches a specific prompt by its name, optionally filtering by label or version.",
            "spof": true
          },
          {
            "path": "web/src/features/mcp/features/prompts/tools/createChatPrompt.ts",
            "description": "This file defines and implements an MCP (Multi-Cloud Platform) tool for creating new chat prompt versions in Langfuse, including their name, messages, and optional metadata like labels, configuration, and tags.",
            "spof": true
          },
          {
            "path": ".claude/hooks/skill-activation-prompt.ts",
            "description": "This script acts as a Claude AI hook to analyze user prompts against predefined skill rules. It identifies and reports potential skill activations based on keywords or intent patterns, categorizing them by priority (critical, high, medium, low).",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 96
          },
          {
            "name": "Max Deichmann",
            "percent": 4
          },
          {
            "name": "Valery Meleshkin",
            "percent": 0
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 102,
      "spofCount": 57
    },
    "busFactor": 3,
    "authorCount": 13
  },
  "Model Evaluation & Scoring": {
    "description": "Measure the quality of LLM outputs through manual annotations, automated model-based evaluations (LLM-as-a-judge), and in-depth score analytics and comparisons.",
    "functions": {
      "Score Management & Annotation": {
        "files": [
          {
            "path": "web/src/components/grouped-score-badge.tsx",
            "description": "This file contains React components for displaying a collection of scores, grouped by name, as interactive badges. It shows score values directly and provides hover cards for additional details like comments, metadata, and links to execution traces.",
            "spof": false
          },
          {
            "path": "web/src/components/scores-table-cell.tsx",
            "description": "This file defines the `ScoresTableCell` React component, which displays aggregated score data within a table cell, handling various score types (numeric, categorical) and offering interactive features like comments, metadata, and copy functionality via hover cards.",
            "spof": false
          },
          {
            "path": "web/src/components/onboarding/ScoresOnboarding.tsx",
            "description": "This file defines a React component, `ScoresOnboarding`, which displays a splash screen. It introduces users to the 'Scores' feature in Langfuse, explaining its purpose for evaluating LLM application quality through various methods like user feedback and model-based evaluations.",
            "spof": true
          },
          {
            "path": "web/src/components/table/use-cases/score-configs.tsx",
            "description": "This file defines and renders the `ScoreConfigsTable` component, which displays a paginated and sortable table of score configurations for a given project. It provides functionalities to view, create, edit, and archive these score configurations.",
            "spof": true
          },
          {
            "path": "web/src/components/table/use-cases/scores.tsx",
            "description": "This file defines a React component that displays a comprehensive table of scores, providing features such as filtering, sorting, pagination, date range selection, and score deletion, often scoped by project, user, trace, or observation IDs.",
            "spof": false
          },
          {
            "path": "web/src/components/table/peek/hooks/usePeekEvalConfigData.ts",
            "description": "This file defines a React hook, `usePeekEvalConfigData`, for fetching evaluation configuration data by its ID within a given project, typically used for displaying peek information.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/hooks/useCorrectionData.ts",
            "description": "This file provides a React hook `useCorrectionData` that merges server-side correction data with client-side cached data. It prioritizes cached data for optimistic updates, handles deleted states, and returns the effective correction object and its value.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/mergeScoresWithCache.clienttest.ts",
            "description": "This file contains client-side unit tests for the score merging utility functions, ensuring they correctly combine server scores with cached scores and handle deletions for individual scores, aggregated scores, and annotation scores.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/transformScores.clienttest.ts",
            "description": "This file contains unit tests for the `transformToAnnotationScores` utility function. It verifies that the function correctly converts individual and aggregated score data into a standardized annotation score format, handling various data types, sources, and filtering conditions.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/score-configs.servertest.ts",
            "description": "This file contains server-side integration tests for the /api/public/score-configs API endpoint. It verifies the functionality for creating, retrieving, and handling various types of score configurations, including error cases.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/scores-trpc.servertest.ts",
            "description": "This file contains server-side tests for the TRPC scores deletion endpoint, verifying its behavior for deleting scores by ID and via batch actions by checking interactions with background queues.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/evals-trpc.servertest.ts",
            "description": "This file contains asynchronous server-side tests for the TRPC API related to evaluation job configurations. It verifies the functionality for retrieving, updating, and deleting evaluation configurations, including their execution statuses.",
            "spof": false
          },
          {
            "path": "web/src/__tests__/async/scores-api-v1.servertest.ts",
            "description": "This file contains asynchronous server-side integration tests for the '/api/public/scores' API endpoint (v1). It verifies the functionality of creating, retrieving, updating, and deleting scores, including various data configurations and associations.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/scores-api-v2.servertest.ts",
            "description": "This file contains server-side asynchronous integration tests for the Langfuse public API's /v2/scores endpoint, verifying the functionality for retrieving individual scores and filtered lists of scores.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/score-configs/[configId].ts",
            "description": "This file defines the API routes for retrieving and updating a specific score configuration within a project. It handles authenticated requests to fetch or modify score configurations identified by their unique ID.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/score-configs/index.ts",
            "description": "This file defines public API endpoints for managing score configurations within a project, allowing creation of new configurations and retrieval of existing ones with pagination.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/scores/index.ts",
            "description": "This file implements the public API endpoint for 'scores', allowing authenticated users to create new scores via POST requests and retrieve existing scores based on various filters via GET requests.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/scores/[scoreId].ts",
            "description": "This file defines a public API endpoint for authenticated projects, allowing retrieval of a specific score by its ID via a GET request and queuing a score deletion request by its ID via a DELETE request.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/v2/scores/[scoreId].ts",
            "description": "This file defines an authenticated public API endpoint for retrieving a specific score by its ID within a project, handling data validation and error cases.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/v2/scores/index.ts",
            "description": "This file defines the public API endpoint for retrieving a list of scores (v2), including filtering, field selection, and pagination capabilities. It handles request validation, fetches scores from the database, and returns them along with pagination metadata.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/evals/configs/[configId].tsx",
            "description": "This file serves as a redirect page for deprecated evaluation configuration URLs, forwarding requests to the new evaluation page for backward compatibility. It fetches evaluation configuration details to construct the correct redirect destination.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/evals/configs/index.tsx",
            "description": "This file provides a redirect from a deprecated URL path for evaluation configurations (`/evals/configs`) to the main evaluations page (`/evals`) for backward compatibility within a specific project.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/evals/configs/new.tsx",
            "description": "This file provides a server-side redirect from a deprecated URL (`/project/[projectId]/evals/configs/new`) to the new evaluation creation page (`/project/[projectId]/evals/new`) for backward compatibility.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/scores/index.tsx",
            "description": "This file defines the main page component for a project's scores, displaying either an onboarding screen for new projects or a table of existing scores. It integrates with the Langfuse API to check for score existence and provides navigation within the scores section.",
            "spof": false
          },
          {
            "path": "web/src/server/api/definitions/evalConfigsTable.ts",
            "description": "Defines column configurations for displaying and filtering evaluation configurations (eval configs) in a table within the web application. It specifies column properties like name, ID, type, and options for various fields such as status, target, and timestamps.",
            "spof": true
          },
          {
            "path": "web/src/server/api/definitions/scoresTable.ts",
            "description": "This file defines the column definitions for a scores table, including static and dynamically-set options for filtering and display. It also provides a function to inject runtime options into these column definitions.",
            "spof": false
          },
          {
            "path": "web/src/features/evals/components/maintainer-tooltip.tsx",
            "description": "This file provides a React component `MaintainerTooltip` that displays an icon representing a maintainer (e.g., Ragas, Langfuse, or a generic user) and shows the maintainer's name in a tooltip on hover.",
            "spof": false
          },
          {
            "path": "web/src/features/evals/components/eval-form-descriptions.tsx",
            "description": "This file provides reusable React components for displaying descriptive text and help popups within evaluation forms. It includes components for explaining variable mapping and defining the time scope (new, existing, or all) for evaluation configurations.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/hooks/useEvalTargetCount.ts",
            "description": "This file defines a React hook that fetches the total count of evaluation targets (either traces or dataset items) based on the provided project ID, item type, and filters.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/hooks/useEvalConfigMappingData.ts",
            "description": "This React hook fetches trace and observation data, optionally using form inputs to determine the relevant trace. It processes the observations to map observation types to their respective names, primarily for evaluation configuration.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/types/score-configs.ts",
            "description": "This file defines the Zod schemas for the Langfuse public API endpoints that manage score configurations. It specifies the data structures for creating, retrieving, and updating various types of score configuration objects (numeric, categorical, boolean).",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/server/scores-api-service.ts",
            "description": "This file defines the ScoresApiService, which provides version-aware methods for retrieving individual scores, lists of scores, and score counts for the public API. It handles different score types and scopes based on whether the API version is v1 or v2.",
            "spof": true
          },
          {
            "path": "web/src/features/filters/config/scores-config.ts",
            "description": "This file defines the filter configuration for the 'scores' table, specifying how filter columns map to backend keys and listing all available filterable facets for score data.",
            "spof": false
          },
          {
            "path": "web/src/features/scores/types.ts",
            "description": "Defines TypeScript types and interfaces for managing scores, annotations, their targets (sessions, traces), charting data, and related UI components within the Langfuse application. It centralizes data structures for score configuration, display, and user input forms.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/components/multi-select-key-values.tsx",
            "description": "This file defines a reusable React component, `MultiSelectKeyValues`, which provides a multi-select dropdown with search functionality. It allows users to select multiple key-value pairs or values from a list, supporting both flat and grouped options, and displays selected items as badges.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/components/ScoreRow.tsx",
            "description": "This React component, `ScoreRow`, displays a single aggregated score with its name and value. It provides detailed information, including source, comments, and metadata, via an interactive hover card.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/filterScoresByTarget.ts",
            "description": "This file provides a utility function to filter a list of scores based on a specified target (session or trace/observation) and a filtering mode, allowing for either exact target matches or the inclusion of all scores associated with the target.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/mergeScoreColumns.ts",
            "description": "This file provides a utility function to merge server-fetched score columns with cached score columns, prioritizing server data in case of conflicts, and returns a sorted, deduplicated list.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/useMergedAggregates.ts",
            "description": "This file defines a React hook that merges server-side score aggregates with locally cached score data, incorporating additions, updates, and deletions for optimistic display in a compare view.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/useMergedAnnotationScores.ts",
            "description": "This file defines a React hook `useMergedAnnotationScores` that combines annotation scores from a server with local cached scores, applying optimistic updates and deletions to provide a unified view.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/getDefaultScoreData.ts",
            "description": "This file defines a utility function to generate default annotation score data for a given trace or session. It combines existing annotation scores with placeholders for selected score configurations that currently lack data.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/helpers.ts",
            "description": "This file provides utility helper functions for managing, categorizing, and formatting score-related data and targets (trace, session) within the application's scoring features.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/annotationFormHelpers.ts",
            "description": "This file provides helper functions for score annotations, including formatting configuration values, validating numeric scores, and managing category options, particularly when handling outdated selections.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/mergeScoresWithCache.ts",
            "description": "This file provides utility functions to merge server-fetched score data (individual scores, aggregates, and annotations) with locally cached scores. It enables optimistic UI updates by applying cached changes (updates, additions, deletions) over the server data.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/transformScores.ts",
            "description": "This file provides utility functions to transform various score data types (flat or aggregated) into a standardized `AnnotationScore` format. It handles different contexts like detail views and comparison views, primarily focusing on scores originating from annotations.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/useMergedScores.ts",
            "description": "This file defines the `useMergedScores` React hook, which merges server-fetched scores with local cached scores, applying updates, additions, and deletions from the cache to provide a comprehensive and up-to-date list of scores.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/hooks/useScoreColumns.ts",
            "description": "This file provides a React hook (`useScoreColumns`) to dynamically fetch score column metadata from an API and generate corresponding table column definitions for displaying score data, including aggregation and formatting options.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/hooks/useScoreConfigSelection.ts",
            "description": "This file defines a React hook `useScoreConfigSelection` for managing the selection and deselection of score configurations within a form. It provides selection options and handles adding new, empty score fields to the form or removing deselected ones, while preserving alphabetical order and preventing the deselection of existing, populated scores.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/hooks/useEmptyConfigs.ts",
            "description": "This file defines a React hook, `useEmptyScoreConfigs`, which manages and persists a list of 'empty selected configuration IDs' using local storage for the application's scores feature.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/contexts/ScoreCacheContext.tsx",
            "description": "This file provides a React context and provider for client-side caching of scores, enabling optimistic updates and managing the state of individual scores and score columns within a web application. It includes functions for adding, retrieving, deleting, and rolling back changes to cached scores.",
            "spof": true
          },
          {
            "path": "web/src/features/corrections/utils/getMostRecentCorrection.ts",
            "description": "This file provides a utility function to find and return the most recent correction from an array of score domain objects, based on their timestamps.",
            "spof": true
          },
          {
            "path": "web/src/features/navigation/utils/evals-tabs.ts",
            "description": "Defines constants for evaluation-related navigation tabs and a utility function to generate tab configurations, including their labels and hrefs, for a given project.",
            "spof": true
          },
          {
            "path": "web/src/features/score-configs/components/ScoreConfigDetails.tsx",
            "description": "This file defines a React component (`ScoreConfigDetails`) responsible for displaying the detailed properties of a score configuration, such as its description, numeric range, and full name.",
            "spof": false
          },
          {
            "path": "web/src/features/score-configs/components/ScoreConfigSettings.tsx",
            "description": "This file defines a React component, `ScoreConfigSettings`, which displays and manages score configurations for a project. It includes access control, a descriptive header, and a table of immutable score configurations.",
            "spof": false
          },
          {
            "path": "web/src/features/score-configs/components/ArchiveScoreConfigButton.tsx",
            "description": "This component provides a button within a popover to allow users to archive or restore a specific score configuration, including access control checks and analytics tracking.",
            "spof": true
          },
          {
            "path": "web/src/features/score-configs/components/UpsertScoreConfigDialog.tsx",
            "description": "This file defines a React component, `UpsertScoreConfigDialog`, which provides a modal dialog for users to create new score configurations or update existing ones within a project. It handles form management, data validation, and API interactions for both creation and update operations.",
            "spof": true
          },
          {
            "path": "web/src/features/score-configs/lib/validateScoreConfigUpsertFormInput.ts",
            "description": "This file defines and exports a utility function for validating form inputs when creating or updating score configurations, using Zod schemas to ensure data integrity and type correctness.",
            "spof": true
          },
          {
            "path": "web/src/features/score-configs/lib/upsertFormTypes.ts",
            "description": "This file defines Zod schemas and TypeScript types for validating data when creating or updating 'score configurations' in the Langfuse web application. It specifies the structure and validation rules for these configuration forms.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/fetchObservationEvalConfigs.ts",
            "description": "This file provides a function to fetch active observation evaluation configurations for a given project, utilizing a cache to optimize database queries.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/tableMappings/mapScoresTable.ts",
            "description": "This file defines the mapping between UI column definitions and their corresponding ClickHouse table and column selections for the 'scores' data, including joined fields from the 'traces' table. It specifies how 'scores' data should be presented in a user interface by linking UI-friendly names and IDs to backend database fields.",
            "spof": false
          },
          {
            "path": "packages/shared/src/features/scoreConfigs/index.ts",
            "description": "This file serves as the main entry point for the 'scoreConfigs' feature, re-exporting all functionalities related to validation for score configurations.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "marliessophie",
            "percent": 64
          },
          {
            "name": "Max Deichmann",
            "percent": 10
          },
          {
            "name": "Nimar",
            "percent": 7
          }
        ]
      },
      "LLM-as-a-Judge Orchestration": {
        "files": [
          {
            "path": "web/src/components/onboarding/EvaluatorsOnboarding.tsx",
            "description": "This file defines a React component, `EvaluatorsOnboarding`, which displays an onboarding splash screen for setting up LLM-as-a-judge evaluations. It presents value propositions and calls to action for users to create evaluators and learn more about the feature.",
            "spof": true
          },
          {
            "path": "web/src/components/table/peek/peek-evaluator-config-detail.tsx",
            "description": "This component displays the detailed view of a specific evaluator configuration, including its status, referenced evaluator template, and provides functionality to edit or deactivate it within a peek view.",
            "spof": true
          },
          {
            "path": "web/src/components/table/peek/hooks/usePeekEvalTemplateData.ts",
            "description": "Defines a React hook `usePeekEvalTemplateData` for fetching a specific evaluation template by ID and project ID, primarily used for 'peek' or preview functionalities.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/admin/evals.ts",
            "description": "This Next.js API endpoint provides administrative functionality to manage evaluation jobs. Specifically, it allows an authenticated administrator to retry failed evaluation jobs by re-adding them to the processing queue based on a creation timestamp cutoff and status.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/evals/default-model.tsx",
            "description": "This file serves as a page entry point, re-exporting the default evaluation model component for a specific project.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/evals/[evaluatorId].tsx",
            "description": "This file serves as a page component that displays the detailed information for a specific evaluator within a project, leveraging the `EvaluatorDetail` component.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/evals/new.tsx",
            "description": "This file serves as a page component for creating new evaluators within a specific project, re-exporting the `new-evaluator` feature.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/evals/index.tsx",
            "description": "This file serves as the entry point for the 'evals' section within a specific project page, re-exporting the main evaluators component.",
            "spof": true
          },
          {
            "path": "web/src/server/api/definitions/evalExecutionsTable.ts",
            "description": "This file defines the column configurations for filtering and displaying evaluation execution data within the Langfuse web application. It specifies column names, IDs, types, and internal database references for a table or API.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/CloneModelButton.tsx",
            "description": "This file defines a React component, `CloneModelButton`, which provides a button to initiate the cloning of an existing model. It opens a form dialog (`UpsertModelFormDialog`) pre-filled with the model's data for cloning, with access control based on user permissions.",
            "spof": true
          },
          {
            "path": "web/src/features/models/components/DeleteModelButton.tsx",
            "description": "This file defines a React component, `DeleteModelButton`, which provides a UI for deleting a specific model. It includes a confirmation popover, handles the API call for deletion, and incorporates access control and analytics.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/components/steps/EvaluatorsStep.tsx",
            "description": "This component renders a step in an experiment configuration wizard, allowing users to select and configure automated evaluators for scoring experiment results. It includes a template selector and a dialog-based form for creating or editing evaluator instances.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/hooks/useExperimentEvaluatorSelection.ts",
            "description": "This file defines a React hook `useExperimentEvaluatorSelection` that manages the selection state and lifecycle of experiment evaluators (templates) within a project. It handles toggling evaluator status between active and inactive, and interacts with an API to persist these changes.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/utils/evaluatorMappingUtils.ts",
            "description": "This file provides utility functions for creating default variable mappings for evaluation templates in Langfuse. It maps common template variable names (like 'input', 'output', 'ground_truth') to specific Langfuse objects and their data fields to streamline the evaluation setup.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/components/ragas-logo.tsx",
            "description": "This file defines a React component `RagasLogoIcon` that displays the Ragas logo image. It constructs the image source path using environment variables and renders it as an `<img>` tag.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/components/deactivate-config.tsx",
            "description": "This component provides a UI for activating or deactivating an evaluation configuration (evaluator) within a project, including a confirmation popover before applying the change.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/components/run-evaluator-form.tsx",
            "description": "This component renders a form for running or configuring a specific evaluator within the application's evaluation feature. It acts as a wrapper for the `EvaluatorForm` component.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/components/evaluator-form.tsx",
            "description": "This file defines the `EvaluatorForm` React component, which serves as a wrapper to prepare data and render the `InnerEvaluatorForm` for creating or editing evaluators based on specific evaluation templates within the Langfuse application.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/components/execution-count-tooltip.tsx",
            "description": "This file defines a React component `ExecutionCountTooltip` that displays a formatted count of evaluation targets (traces or dataset run items), potentially capped by a global configuration, for a given project and filter.",
            "spof": false
          },
          {
            "path": "web/src/features/evals/components/default-eval-model-setup.tsx",
            "description": "This file defines a React component for setting up and managing the default evaluation model configuration within a project. It allows users with appropriate access to view, edit, and delete the default model, including its parameters and provider settings.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/components/select-evaluator-list.tsx",
            "description": "This React component displays a list of evaluation templates (evaluators) for a given project, allowing users to select an existing one or create a new custom evaluator through a dialog. It handles the fetching, selection, and creation flow for evaluation templates.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/components/evaluator-detail.tsx",
            "description": "This file defines the `EvaluatorDetail` React component, which displays the comprehensive details for a specific LLM-as-a-Judge evaluator. It fetches and presents evaluator configuration, status, job execution metrics, and a log table of associated evaluations.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/components/evaluator-selector.tsx",
            "description": "This component provides a searchable selector for evaluation templates, categorizing them into custom and Langfuse-managed evaluators. It allows users to select a template, view its details, and indicates validation issues.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/components/set-up-default-eval-model-card.tsx",
            "description": "This file defines a React component that displays a card prompting users to set up a default evaluation model for a project, which is required for evaluators to function.",
            "spof": false
          },
          {
            "path": "web/src/features/evals/components/evaluation-prompt-preview.tsx",
            "description": "This file defines a React component that displays a preview of an evaluation prompt, replacing variable placeholders with actual values extracted from a trace, and applying distinct colors to highlight these variables.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/components/manage-default-eval-model.tsx",
            "description": "This file defines a React component that displays the current default evaluation model for a project and provides an editable link to manage it. It includes access control for reading and writing the default model configuration.",
            "spof": false
          },
          {
            "path": "web/src/features/evals/components/eval-log.tsx",
            "description": "This component (`EvalLogTable`) displays a paginated and filterable table of evaluation logs for a specific project, including details like status, scores, timestamps, and links to associated traces, sessions, and templates. It provides features for column visibility, ordering, and row height customization.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/components/evaluator-table.tsx",
            "description": "This file defines a React component that displays a comprehensive table of evaluator configurations for a project. It includes features like pagination, filtering, sorting, column visibility, and actions such as viewing logs, editing, and deleting evaluator configurations.",
            "spof": false
          },
          {
            "path": "web/src/features/evals/components/inner-evaluator-form.tsx",
            "description": "This file defines the `InnerEvaluatorForm` React component, which provides a comprehensive form for creating or editing evaluation configurations in Langfuse. It allows users to specify an evaluator's target (traces or datasets), define filters, map variables from traces/datasets to evaluation templates, and preview matching traces.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/hooks/useSingleTemplateValidation.ts",
            "description": "This file defines a React hook `useSingleTemplateValidation` for validating evaluation templates. It checks if a template requires a default LLM model and if such a model is available for the given project.",
            "spof": false
          },
          {
            "path": "web/src/features/evals/hooks/useTemplatesValidation.ts",
            "description": "This file defines a React hook `useTemplatesValidation` that validates selected evaluation templates based on the availability of a default LLM model for a given project.",
            "spof": false
          },
          {
            "path": "web/src/features/evals/hooks/useEvaluationModel.ts",
            "description": "This file defines a React hook `useEvaluationModel` that manages the selection and formatting of an LLM model (either a default model fetched from an API or a custom one) for use in evaluations. It transforms model parameters into a UI-specific format.",
            "spof": false
          },
          {
            "path": "web/src/features/evals/hooks/useExtractVariables.ts",
            "description": "This React hook (`useExtractVariables`) is responsible for dynamically extracting values for a list of specified variables from a given trace object, based on a provided mapping configuration. It manages loading states, errors, and efficiently updates extracted variables by fetching additional observation data when needed.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/hooks/useTemplateValidation.ts",
            "description": "This file defines a React hook, `useTemplateValidation`, which validates an evaluation template to ensure it has a model provider and model, either explicitly set or inherited from a project's default model. It manages the validation state and triggers a callback upon valid selection.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/pages/default-evaluation-model.tsx",
            "description": "This file defines a React page component that allows users to configure the default evaluation model for a specific project, including access control checks. It renders the `DefaultEvalModelSetup` component for this configuration.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/pages/evaluators.tsx",
            "description": "This file defines the main page for managing LLM-as-a-Judge evaluators within a project, displaying a table of existing evaluators, handling onboarding for new projects, and providing options to set up new evaluators or manage default evaluation models.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/pages/new-evaluator.tsx",
            "description": "This file defines a multi-step page for setting up and running evaluators within a project. It guides the user through steps like configuring a default model, selecting an evaluator, and finally running it.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/utils/job-execution-utils.ts",
            "description": "Provides utility functions and types for managing and displaying job execution states and their counts, specifically for pending, error, and succeeded statuses.",
            "spof": false
          },
          {
            "path": "web/src/features/evals/server/addDatasetRunItemsToEvalQueue.ts",
            "description": "This file defines a function to add dataset run items to a Redis-backed queue for asynchronous processing or evaluation, ensuring data consistency and eventual propagation.",
            "spof": true
          },
          {
            "path": "web/src/features/filters/config/evaluators-config.ts",
            "description": "This file defines the configuration for filtering evaluators within the application, specifying table name, column definitions, default expanded states, and available categorical facets like status and target.",
            "spof": false
          },
          {
            "path": "worker/src/initialize.ts",
            "description": "This file initializes the Langfuse worker by upserting default model prices, managed evaluators, and Langfuse dashboards. It serves as a setup script for the worker's initial state.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/evalService.test.ts",
            "description": "This file contains unit tests for the evaluation service within the Langfuse worker, focusing specifically on the `compileTemplateString` utility function used for prompt compilation.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/evalService.filtering.test.ts",
            "description": "This file contains integration tests for the evaluation service's trace filtering functionality, ensuring that evaluation jobs are created correctly based on various trace attributes like environment, name, ID, timestamp, and user ID.",
            "spof": true
          },
          {
            "path": "worker/src/queues/evalQueue.ts",
            "description": "This file defines processors for BullMQ queues responsible for creating, executing, and managing evaluation jobs, including LLM-as-a-judge evaluations, handling error conditions and retries.",
            "spof": false
          },
          {
            "path": "worker/src/queues/__tests__/llmAsJudgeExecutionQueueProcessor.test.ts",
            "description": "This file contains unit tests for the `llmAsJudgeExecutionQueueProcessor`, verifying its functionality, including successful job processing, and robust error handling for various scenarios such as LLM rate limits, LLM completion failures, unrecoverable errors, and unexpected system errors.",
            "spof": true
          },
          {
            "path": "worker/src/scripts/upsertManagedEvaluators.ts",
            "description": "This script synchronizes predefined managed evaluators from a JSON file into the database. It validates evaluators, checks for updates based on timestamps, and then upserts them into the `eval_templates` table.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/evalExecutionUtils.test.ts",
            "description": "This file contains unit tests for utility functions in `evalExecutionUtils.ts` that support the evaluation execution process, such as compiling prompts, building score schemas, and validating LLM responses.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/retryObservationNotFound.ts",
            "description": "This file implements a retry mechanism with exponential backoff for 'observation not found' errors. It re-queues jobs that fail due to missing observations, up to a maximum number of attempts or a defined time limit, to allow eventual processing.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/executeLLMAsJudgeEvaluation.test.ts",
            "description": "This file contains unit tests for the `executeLLMAsJudgeEvaluation` function. It uses mocked dependencies to verify the function's orchestration logic for various scenarios, including successful evaluation and handling of configuration and LLM response errors.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/evalExecutionUtils.ts",
            "description": "This file provides utility functions for executing and evaluating LLM-based evaluation templates. It handles prompt compilation, schema building for LLM outputs, response validation, and the construction of score events and execution metadata.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/evalExecutionDeps.ts",
            "description": "This file defines an interface (`EvalExecutionDeps`) for the external dependencies required during evaluation job execution, such as database updates, storage operations, queueing, and LLM calls. It provides both a production implementation and a mock implementation for testing purposes.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/evalService.ts",
            "description": "Manages the creation and queuing of evaluation jobs based on incoming events from live traces, dataset run items, or historical data, fetching and filtering job configurations, performing validations, and scheduling evaluation execution.",
            "spof": false
          },
          {
            "path": "worker/src/features/evaluation/observationEval/index.ts",
            "description": "This file serves as an entry point for the observation evaluation feature, exporting functions for scheduling, processing, and managing observation evaluations, along with their related types and dependencies.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/shouldSampleObservation.ts",
            "description": "This file defines a utility function, `shouldSampleObservation`, that determines whether a given observation should be sampled based on a specified sampling rate.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/createSchedulerDeps.ts",
            "description": "This file defines and provides concrete production implementations for dependencies used by the observation evaluation scheduler, including database operations (Prisma), S3 storage interactions, and job queuing (BullMQ).",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/observationEvalProcessor.ts",
            "description": "This file defines the core logic for processing and executing LLM-as-a-judge evaluations on individual observations within the Langfuse platform. It handles fetching job configurations, downloading observation data from S3, extracting relevant variables, and orchestrating the evaluation process.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/extractObservationVariables.ts",
            "description": "This file provides utility functions to extract and format specific variable values from observation data based on a mapping, including support for JSONPath selectors, primarily for use in LLM-as-a-judge evaluations.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/scheduleObservationEvals.ts",
            "description": "This file defines the logic for scheduling observation evaluations. It filters evaluation configurations based on a given observation, samples them, uploads the observation to S3, and then creates and enqueues evaluation jobs for the matching configurations.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/__tests__/extractObservationVariables.test.ts",
            "description": "This file contains unit tests for the `extractObservationVariables` function, verifying its ability to correctly extract various data points from an observation object based on defined mappings and JSON selectors.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/__tests__/scheduleObservationEvals.test.ts",
            "description": "This file contains unit tests for the `scheduleObservationEvals` function, which is responsible for scheduling evaluation jobs for observations. It verifies the function's behavior regarding configuration processing, S3 uploads, filtering, sampling, and job enqueuing.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/__tests__/observationEvalProcessor.test.ts",
            "description": "This file contains unit tests for the `processObservationEval` function. It tests various scenarios including database lookups, S3 interactions, error handling, and successful evaluation processing using mocked dependencies.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/__tests__/observationEval.e2e.test.ts",
            "description": "This file contains end-to-end tests for the observation evaluation pipeline, covering the scheduling and processing of evaluation jobs. It simulates the full workflow including filtering, sampling, and execution of LLM-as-a-judge evaluations.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/__tests__/shouldSampleObservation.test.ts",
            "description": "Contains unit tests for the `shouldSampleObservation` function, verifying its probabilistic sampling logic under various conditions, including edge cases and default random value generation.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/__tests__/productionDeps.integration.test.ts",
            "description": "This file contains integration tests for production dependency factories related to evaluation job scheduling and execution. It verifies the correct interaction of these dependencies with a PostgreSQL database (via Prisma) and S3 storage (MinIO) for tasks like job execution management, observation data upload, and score event upload.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/evalJobConfigCache.ts",
            "description": "This module provides Redis caching utilities to optimize performance by storing and retrieving whether a project currently has no active evaluation job configurations, reducing unnecessary database queries.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/llm/testModelCall.ts",
            "description": "This file defines a utility function `testModelCall` that sends a test prompt to an LLM, verifying its ability to extract structured data such as a score and reasoning. It utilizes `fetchLLMCompletion` with a predefined input and expected Zod output schema.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/evalExecutionQueue.ts",
            "description": "This file defines a singleton class, `EvalExecutionQueue`, which provides a BullMQ queue specifically for managing 'EvaluationExecution' jobs within the application. It handles queue initialization, connection to Redis, job options, and error logging.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/llmAsJudgeExecutionQueue.ts",
            "description": "This file defines a singleton class for managing a BullMQ Redis queue specifically designed for 'LLM as Judge' executions, handling its creation, configuration, and error logging.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/createEvalQueue.ts",
            "description": "This file defines a singleton class `CreateEvalQueue` that provides a configured BullMQ queue instance for processing evaluation-related jobs. It sets up Redis connection, job retry options, and error handling for this specific queue.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/DefaultEvaluationModelService/index.ts",
            "description": "This file re-exports the `DefaultEvalModelService`, serving as a central entry point for default evaluation model related services within the package.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/DefaultEvaluationModelService/DefaultEvalModelService.ts",
            "description": "This service manages default LLM evaluation model configurations for projects. It provides functionalities to fetch, create, update, and validate these models, ensuring associated API keys are present and functional.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/evals/utilities.ts",
            "description": "This file provides utility functions for robustly extracting and processing values from objects, including handling multi-encoded JSON strings and JSONPath selections, then converting them to a string representation.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "marliessophie",
            "percent": 47
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 38
          },
          {
            "name": "Steffen Schmitz",
            "percent": 6
          }
        ]
      },
      "Score Analytics & Visualization": {
        "files": [
          {
            "path": "web/src/__tests__/aggregateScores.clienttest.ts",
            "description": "This file contains client-side unit tests for the `aggregateScores` function, which is responsible for grouping and calculating statistics for various types of scores (numeric, categorical, boolean) based on their name, source, and data type.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/statistics-utils.clienttest.ts",
            "description": "This file contains client-side unit tests for various statistical utility functions, including Cohen's Kappa, Weighted F1 Score, and Overall Agreement calculations, along with their interpretation functions for different correlation metrics.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/heatmap-utils.clienttest.ts",
            "description": "This file contains unit tests for heatmap utility functions. It verifies the correct generation of numeric heatmap data, confusion matrix data, and the filling of missing data bins for visualization.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/score-comparison-analytics.servertest.ts",
            "description": "This file contains integration tests for the `scoreAnalytics.getScoreComparisonAnalytics` tRPC endpoint. It verifies the endpoint's functionality, data aggregation, and handling of various input scenarios for comparing scores.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/scores/analytics.tsx",
            "description": "This page provides a comprehensive dashboard for analyzing scores within a specific project, allowing users to select and compare scores, apply filters, and view various analytical visualizations like trends, distributions, and heatmaps.",
            "spof": true
          },
          {
            "path": "web/src/features/score-analytics/README.md",
            "description": "This README documents the architecture, components, data flow, and key principles of the Score Analytics feature. It provides an overview of how score data is analyzed and displayed in the dashboard.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/SamplingDetailsHoverCard.tsx",
            "description": "This component renders a hover card displaying details about data sampling and query optimizations for analytics, including estimated score counts and sampling rates.",
            "spof": true
          },
          {
            "path": "web/src/features/score-analytics/components/ScoreAnalyticsDashboard.tsx",
            "description": "This file defines the ScoreAnalyticsDashboard component, which orchestrates and displays various score analytics cards (statistics, timeline, distribution, and heatmap) in a responsive grid layout, dynamically rendering the appropriate distribution card based on data type.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/ScoreAnalyticsProvider.tsx",
            "description": "This file defines a React Context Provider (`ScoreAnalyticsProvider`) and a consumer hook (`useScoreAnalytics`) for managing and providing score analytics data, including color schemes and estimation results, throughout a React component tree.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/ScoreAnalyticsHeader.tsx",
            "description": "This file defines the ScoreAnalyticsHeader React component, which provides UI controls (score selectors, object type filter, time range picker) for configuring and filtering data within the score analytics feature, synchronizing its state with URL query parameters.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/ScoreAnalyticsNoticeBanner.tsx",
            "description": "This component displays informational banners for score analytics, indicating when data is loading/estimating (potentially with a large dataset or sampling) or when the displayed results are based on sampled data.",
            "spof": true
          },
          {
            "path": "web/src/features/score-analytics/components/charts/HeatmapCell.tsx",
            "description": "This component renders a single cell within a heatmap, displaying its value, color, and handling interactive features like hover effects, clicks, and tooltips. It can render either an empty cell or a cell with data based on the provided props.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/HeatmapPlaceholder.tsx",
            "description": "This file defines the `HeatmapPlaceholder` React component, which displays a skeleton grid and a message prompting the user to select a second score to enable the comparison heatmap feature.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/ObjectTypeFilter.tsx",
            "description": "This file defines a React component called `ObjectTypeFilter` that provides a dropdown select menu. It allows users to filter analytics data by different object types such as traces, sessions, or observations.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/HeatmapSkeleton.tsx",
            "description": "This component provides a visual loading skeleton for a heatmap, designed to match the real heatmap's dimensions and layout with a dynamic diagonal pattern and animated placeholders for cells and labels.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/ScoreCombobox.tsx",
            "description": "This file defines a `ScoreCombobox` React component that provides a specialized combobox for selecting score-related options. It filters and groups these options by data type (e.g., numeric, boolean, categorical) and allows users to search and clear their selection.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/Heatmap.tsx",
            "description": "This React component renders a customizable heatmap, displaying a grid of cells with data, labels, and interactive features like tooltips and hover effects. It handles responsive sizing, label truncation, and adaptive thinning for complex data visualizations.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/ScoreDistributionNumericChart.tsx",
            "description": "This component renders a bar chart visualizing the distribution of numeric scores, capable of displaying either a single score's distribution or comparing two score distributions side-by-side with an interactive legend.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/MetricCard.tsx",
            "description": "This file defines the `MetricCard` React component, a reusable UI element for displaying individual statistical metrics. It presents a label, a value, and optionally includes interpretation badges, help tooltips, and warning messages for enhanced data context.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/ScoreDistributionCategoricalChart.tsx",
            "description": "This React component renders a bar chart to visualize the distribution of categorical scores. It supports both single-score distributions and stacked distributions to compare two categorical scores, handling special cases like unmatched categories.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/ScoreDistributionBooleanChart.tsx",
            "description": "A React component that renders a bar chart visualizing the distribution of boolean scores, supporting both single score display and comparison between two score distributions.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/ScoreTimeSeriesNumericChart.tsx",
            "description": "This component renders a numeric time series line chart, capable of displaying one or two scores over time for comparison, with interactive legend and tooltip functionalities.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/ScoreTimeSeriesChart.tsx",
            "description": "This file defines a React component that acts as a router for displaying various types of score time series charts (numeric, boolean, or categorical) based on the provided data type, delegating to specific chart components for rendering.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/ScoreTimeSeriesCategoricalChart.tsx",
            "description": "This file defines a React component that renders a time-series line chart to visualize counts for different categories over time, with each category represented by a distinct line. It processes raw categorical data into a pivot format suitable for charting and includes interactive legend and tooltip features.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/charts/ScoreTimeSeriesBooleanChart.tsx",
            "description": "This React component renders a line chart to display the time-series distribution of boolean score counts across different categories. It transforms raw timestamped categorical data into a format suitable for charting and includes interactive legend functionality.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/cards/TimelineChartCard.tsx",
            "description": "This React component, `TimelineChartCard`, displays score trends over time using time series charts. It manages different views (single score, two scores, all, matched) and data types (numeric, categorical) based on user selections and data from the ScoreAnalyticsProvider.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/cards/StatisticsCard.tsx",
            "description": "This component (`StatisticsCard`) displays various statistical metrics for one or two scores, handling numeric and categorical data types, as well as loading and empty states within the score analytics feature.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/components/cards/DistributionBooleanCard.tsx",
            "description": "This React component renders a card displaying distribution charts for boolean scores. It manages tab selections (e.g., individual scores, combined, or matched) and dynamically prepares the data and colors for the `ScoreDistributionBooleanChart`.",
            "spof": true
          },
          {
            "path": "web/src/features/score-analytics/components/cards/DistributionNumericCard.tsx",
            "description": "This React component displays a distribution chart for numeric scores, managing different views (individual scores, all, or matched) via tabs. It dynamically selects and formats the appropriate distribution data, bin labels, and colors for the chart.",
            "spof": true
          },
          {
            "path": "web/src/features/score-analytics/components/cards/DistributionCategoricalCard.tsx",
            "description": "This file defines a React component, `DistributionCategoricalCard`, responsible for displaying categorical score distributions. It provides interactive tabs to view individual score distributions (score1, score2) or comparisons (all, matched) using a categorical chart.",
            "spof": true
          },
          {
            "path": "web/src/features/score-analytics/components/cards/HeatmapCard.tsx",
            "description": "This file defines the `HeatmapCard` React component, which displays a heatmap or confusion matrix to visualize the comparison between two scores within the score analytics feature. It handles different data types (numeric, categorical) and manages loading, empty, and single-score placeholder states.",
            "spof": true
          },
          {
            "path": "web/src/features/score-analytics/server/buildEstimateQuery.ts",
            "description": "This file defines a function to build and execute an estimation query for comparing two scores in ClickHouse. It uses a 1% hash sample to quickly approximate counts for each score and their matched pairs, serving as a preflight check for further analysis.",
            "spof": true
          },
          {
            "path": "web/src/features/score-analytics/server/queryHelpers.ts",
            "description": "This file provides shared utility functions for building ClickHouse SQL query fragments for score analytics. It includes helpers for filtering scores by object type and for generating deterministic, hash-based sampling expressions.",
            "spof": true
          },
          {
            "path": "web/src/features/score-analytics/server/buildScoreComparisonQuery.ts",
            "description": "This file builds a comprehensive ClickHouse SQL query for score comparison analytics, generating various metrics like heatmaps, confusion matrices, statistical comparisons, and time series distributions for single or dual scores.",
            "spof": true
          },
          {
            "path": "web/src/features/score-analytics/lib/clickhouse-time-utils.ts",
            "description": "This module provides utility functions for generating ClickHouse time-based SQL queries, specifically for normalizing time intervals and constructing appropriate ClickHouse time bucketing functions for score analytics.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/lib/chart-formatters.ts",
            "description": "Provides utility functions for dynamically formatting timestamps for chart X-axis labels and tooltips, adapting the format based on the time interval and range.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/lib/heatmap-utils.ts",
            "description": "Provides utility functions for preprocessing data from ClickHouse into a format suitable for displaying numeric heatmaps and confusion matrices.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/lib/analytics-url-state.ts",
            "description": "This file defines a React hook (`useAnalyticsUrlState`) for managing and synchronizing the state of score analytics filters (scores, date range, and object type) with the URL query parameters. It allows components to read and update these filters, with changes reflected in the URL.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/lib/statistics-utils.ts",
            "description": "This file provides utility functions for calculating and interpreting statistical metrics related to score comparison analytics, including Cohen's Kappa, F1 Score, overall agreement, and correlation coefficients.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/lib/color-scales.ts",
            "description": "Provides utilities for generating and managing color scales for score analytics visualizations, including perceptually uniform OKLCH gradients for heatmaps and consistent CSS variable-based colors for charts.",
            "spof": true
          },
          {
            "path": "web/src/features/score-analytics/lib/ScoreChartTooltip.tsx",
            "description": "This file defines the `ScoreChartTooltip` React component, a custom tooltip for Score Analytics charts that provides consistent styling, sorts and formats data entries, and dynamically formats timestamps.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/lib/score-analytics-transformers.ts",
            "description": "This file provides pure transformation and utility functions for processing and preparing score analytics data (numeric, categorical, boolean) for display in the UI. It handles tasks like extracting categories, filling distribution gaps, calculating mode metrics, and transforming heatmap data for visualization.",
            "spof": false
          },
          {
            "path": "web/src/features/score-analytics/hooks/useScoreAnalyticsQuery.ts",
            "description": "This file defines a React hook, `useScoreAnalyticsQuery`, responsible for fetching raw score analytics data from an API, transforming it, and providing structured data for UI consumption, including statistics, distributions, time series, and heatmap data for one or two scores.",
            "spof": false
          },
          {
            "path": "web/src/features/scores/components/TimeseriesChart.tsx",
            "description": "This file defines the `TimeseriesChart` React component, which acts as a wrapper to render either a categorical or numeric timeseries chart based on provided data and type.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/components/ScoreChart.tsx",
            "description": "This file provides React components for displaying categorical (bar chart) and numeric (line chart) data, typically for scores or metrics, using Tremor charts with custom formatting and data handling for empty states.",
            "spof": false
          },
          {
            "path": "web/src/features/scores/adapters/index.ts",
            "description": "This file defines data adapters for converting score-related data into a standardized chart data format. It includes adapters for dashboard categorical scores and comparison view metrics, preparing data for visualization.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/aggregateScores.ts",
            "description": "This file provides utility functions for normalizing, composing, and decomposing keys for scores, and includes the core logic for aggregating lists of scores based on their data type (numeric or categorical).",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/scoreColumns.ts",
            "description": "This file provides utility functions for generating filter conditions for various types of score data (traces, sessions, observations, datasets) and for transforming score column metadata into a format suitable for UI display and analytics.",
            "spof": true
          },
          {
            "path": "web/src/features/dashboard/components/score-analytics/NumericScoreTimeSeriesChart.tsx",
            "description": "This component fetches and displays time-series data for numeric or boolean scores, rendering it as a line chart within a dashboard. It aggregates score values over time based on user-defined filters and time granularities.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/score-analytics/CategoricalScoreChart.tsx",
            "description": "This component fetches and displays categorical score data for a specific project and score type, transforming the raw query results into a format suitable for a categorical chart.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/components/score-analytics/ScoreAnalytics.tsx",
            "description": "This file implements a React component for displaying and analyzing different types of scores (numeric, boolean, categorical) within a dashboard. It fetches score data, allows users to select scores, and renders appropriate charts (histograms, time series, categorical charts) for visualization.",
            "spof": false
          },
          {
            "path": "web/src/features/dashboard/lib/score-analytics-utils.ts",
            "description": "This file contains utility functions for processing and transforming score data (both numeric and categorical) and resource metrics into a format suitable for dashboard charting and analysis, including histogram generation and aggregation.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/lib/computeScoreDiffs.ts",
            "description": "This file provides a utility function to compute the differences between current and baseline score aggregates across various metrics within a dataset. It iterates through scores and uses `calculateScoreDiff` to determine individual score changes.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/hooks/useDatasetRunCompareChartData.ts",
            "description": "This hook fetches and processes aggregated metrics and score data for selected dataset runs, preparing it for display in a comparison chart. It provides chart-ready data, score analytics options, and score key mappings.",
            "spof": true
          },
          {
            "path": "web/src/features/navigation/utils/scores-tabs.ts",
            "description": "Defines constants and a utility function for generating navigation tabs related to project scores and analytics, including their labels and respective URLs.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 88
          },
          {
            "name": "marliessophie",
            "percent": 9
          },
          {
            "name": "Steffen Schmitz",
            "percent": 2
          }
        ]
      },
      "Core Scoring Data Layer": {
        "files": [
          {
            "path": "web/src/__tests__/async/repositories/score-repository.servertest.ts",
            "description": "This file contains server-side asynchronous tests for the ClickHouse scores repository. It verifies the repository's ability to retrieve and group various types of scores (trace, observation, session, dataset run) based on different filters and IDs.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/types.ts",
            "description": "This file defines types, enums, and Zod schemas for evaluation-related features in the web application, including evaluator statuses, partial job configurations, and constants for RAGAS templates.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/hooks/useValidateCustomModel.ts",
            "description": "This file provides a React hook (`useValidateCustomModel`) to validate whether a custom model configuration is valid by checking if its provider is among the available providers.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/utils/typeHelpers.ts",
            "description": "This file contains utility functions for determining the maintainer of an evaluation template, distinguishing between Langfuse, partners, and user-maintained templates based on provided identifiers.",
            "spof": true
          },
          {
            "path": "web/src/features/evals/utils/evaluator-form-utils.ts",
            "description": "This file defines the Zod schema for evaluation configuration forms within the application. It includes utility functions for target validation and type definitions for evaluation-related objects and variables.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/server/scores.ts",
            "description": "This file handles the retrieval and formatting of score data for a public API. It queries scores from a Clickhouse database, applies filtering based on provided parameters, and converts the raw data into an API-compatible format.",
            "spof": false
          },
          {
            "path": "web/src/features/scores/schema.ts",
            "description": "This file defines Zod schemas for validating annotation score data and the structure of an annotation form. It specifies the expected types and properties for individual scores and arrays of scores.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/lib/types.ts",
            "description": "This file defines TypeScript types for score-related data structures, including a union type for various table rows that can display individual scores and a type for score data attributes, used across different features like observations, traces, and datasets.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/scoreDeletion.test.ts",
            "description": "This file contains unit tests for the score deletion functionality, verifying that scores are correctly removed from ClickHouse and associated S3 event files are deleted.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/inMemoryFilterService.test.ts",
            "description": "This file contains unit tests for the `InMemoryFilterService`, verifying its ability to correctly evaluate various filter types (string, datetime, number) against in-memory data.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/batchAction.test.ts",
            "description": "This file contains unit tests for the `handleBatchActionJob` function, verifying its ability to perform various batch operations. These operations include scheduling trace and score deletions with different filters, and creating evaluation jobs for historic traces and datasets based on specified criteria.",
            "spof": false
          },
          {
            "path": "worker/src/backgroundMigrations/migrateScoresFromPostgresToClickhouse.ts",
            "description": "This file defines a background migration task to transfer 'scores' data from a PostgreSQL database to a ClickHouse database in batches.",
            "spof": true
          },
          {
            "path": "worker/src/queues/scoreDelete.ts",
            "description": "This file defines the BullMQ processor responsible for deleting scores from ClickHouse, identified by their IDs and project ID.",
            "spof": true
          },
          {
            "path": "worker/src/queues/__tests__/otelToObservationForEval.test.ts",
            "description": "This file contains a test suite that validates the conversion of OpenTelemetry (OTEL) events into the `ObservationForEval` schema within the ingestion pipeline. It ensures that OTEL events are correctly mapped and conform to the expected schema for evaluation purposes.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/s3StorageClient.ts",
            "description": "This file provides a singleton S3 storage client specifically for evaluation-related operations, handling its initialization and configuration using environment variables.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/traceFilterUtils.ts",
            "description": "Provides utility functions for filtering traces, including mapping filter column names to trace object fields and determining if a filter necessitates a database lookup based on an allow-list of filterable columns.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/types.ts",
            "description": "This file defines types and interfaces for configuring, scheduling, and executing observation evaluations within a worker process. It includes the configuration schema for evaluation jobs, and dependencies for managing job executions like database updates and S3 uploads.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/__tests__/fixtures.ts",
            "description": "This file provides utility functions for creating test data and mock dependencies, such as observations, evaluation configurations, and mocked service clients, to facilitate testing of the observation evaluation feature.",
            "spof": true
          },
          {
            "path": "worker/src/features/evaluation/observationEval/__tests__/observationForEvalSchema.test.ts",
            "description": "This file contains unit tests for the `observationForEvalSchema` to ensure it correctly validates and parses observation data structures. It also verifies the alignment of this schema with predefined filter and variable column definitions used in evaluations.",
            "spof": true
          },
          {
            "path": "worker/src/features/scores/processClickhouseScoreDelete.ts",
            "description": "This file contains a function to process the deletion of specific scores from Clickhouse and potentially S3 for a given project. It ensures that score data is removed from both the database and associated blob storage.",
            "spof": false
          },
          {
            "path": "packages/shared/src/domain/score-configs.ts",
            "description": "This file defines Zod schemas and validation logic for various types of score configurations, including numeric, boolean, and categorical, used across the application. It ensures data consistency and validation rules for score definitions.",
            "spof": true
          },
          {
            "path": "packages/shared/src/domain/scores.ts",
            "description": "This file defines the Zod schemas and TypeScript types for various score-related entities, including score sources, data types (numeric, categorical, boolean, correction), and the comprehensive Score object structure. It also provides utilities for working with aggregatable score types.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/scoreDelete.ts",
            "description": "This file defines a singleton class `ScoreDeleteQueue` responsible for creating and managing a BullMQ queue dedicated to handling 'ScoreDelete' operations. It ensures a single instance of the queue is available throughout the application for processing score deletion jobs.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/ingestion/validateAndInflateScore.ts",
            "description": "This file validates and inflates score data received for ingestion, optionally using a predefined score configuration, and transforms it into a complete score object suitable for database storage.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/scores.ts",
            "description": "This file defines the server-side repository for managing and querying 'scores' data, primarily interacting with ClickHouse to perform operations like searching, retrieving, and upserting scores related to traces, sessions, and dataset runs.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/repositories/scores_converters.ts",
            "description": "This file provides utility functions for converting score data retrieved from Clickhouse or other aggregated forms into domain-specific data structures. It handles different data types and includes metadata parsing.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/scores-utils.ts",
            "description": "This file provides internal utility functions for fetching score data by ID or IDs from a Clickhouse database, applying various filters, and converting the results into domain-specific score objects.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/tableMappings/mapScoresColumnsTable.ts",
            "description": "This file defines the mappings between UI column definitions and their corresponding ClickHouse table and select expressions for score-related data. It includes mappings for native score columns and columns requiring joins with other tables.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/scores.ts",
            "description": "This file provides a Zod validation utility to ensure that exactly one of `traceId`, `sessionId`, or `datasetRunId` is provided for score-related data, with specific constraints on `observationId`.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/index.ts",
            "description": "This file serves as an entry point, re-exporting all score-related interfaces from the 'interfaces.ts' file to make them easily accessible.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/README.md",
            "description": "This README documents the type definitions, schemas, and validation logic for Langfuse scores, detailing their structure, API versioning, usage, and type flow across different application layers.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/index.ts",
            "description": "This file serves as a central re-export point for various interfaces, types, and validation schemas related to the 'scores' feature within the shared package.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/shared.ts",
            "description": "Defines the foundational Zod schema for posting score data, supporting traces, observations, and sessions, for both ingestion and public API usage.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/api/index.ts",
            "description": "This file serves as an API index, exporting schemas, validation, and endpoint definitions for 'scores' features across different API versions (v1 and v2).",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/api/shared.ts",
            "description": "This file defines Zod schemas for the API request and response structures related to managing scores, including fetching, filtering, creating, and deleting score data across various data types.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/api/v1/schemas.ts",
            "description": "Defines the Zod schemas for version 1 of the Scores API, specifically for trace and observation scores. It combines a foundational score structure with discriminated unions for numeric, categorical, and boolean data types.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/api/v1/endpoints.ts",
            "description": "This file defines the API endpoints and their corresponding request and response schemas for the 'scores' feature, specifically for version 1 of the API. It uses Zod to define data validation for GET, DELETE, and POST operations related to scores.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/api/v1/validation.ts",
            "description": "This file provides a utility function for filtering and validating a list of score data, ensuring type safety before exposing it via the legacy v1 API, specifically for scores associated with traces.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/api/v2/endpoints.ts",
            "description": "This file defines Zod schemas for version 2 of the Langfuse scores API endpoints, specifying the structure for requests and responses when fetching individual scores or a list of scores.",
            "spof": false
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/api/v2/validation.ts",
            "description": "This file provides a utility function for validating and filtering a list of score objects according to a V2 API schema. It ensures type safety and data integrity before scores are exposed via the public API.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/api/v2/schemas.ts",
            "description": "This file defines the Zod schema for version 2 of the API score data model, used across traces, observations, and sessions. It encompasses numeric, categorical, boolean, and correction data types, along with common properties and entity references.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/application/validation.ts",
            "description": "This file provides utility functions for validating and filtering score data retrieved from a database, ensuring type safety before its use in the application. It includes functions for single score validation and filtering lists of scores by data type, handling potential parsing errors.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/ingestion/validation.ts",
            "description": "This file defines Zod schemas for validating score ingestion data. It includes validation rules for various score data types (numeric, categorical, boolean, correction), both independent of and against defined score configurations.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scores/interfaces/ui/types.ts",
            "description": "This file defines TypeScript interfaces and types for representing and aggregating score data within the UI, including simplified individual scores and various forms of aggregated scores (categorical and numeric).",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/scoreConfigs/validation.ts",
            "description": "This file provides utility functions to validate and type-check ScoreConfig objects retrieved from the database against a Zod schema, ensuring type safety within the application's domain model. It offers methods for validating single objects or lists, with options for error handling.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/evals/observationForEval.ts",
            "description": "This file defines the `ObservationForEval` data schema used for evaluating observations, specifying its structure and identifying which fields are available for filtering and variable extraction within the evaluation system.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/evals/types.ts",
            "description": "Defines Zod schemas and types for evaluation configuration in Langfuse, including target objects, variable mappings for trace and observation-based evaluations, and available data columns for evaluation.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230523084523_rename_to_score",
            "description": "This directory contains a specific Prisma database migration script for the `shared` package. The migration, dated 2023-05-23, is responsible for renaming database elements related to 'score'.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230710200816_scores_add_comment",
            "description": "This directory contains a specific database migration script generated by Prisma. The migration, named '20230710200816_scores_add_comment', is responsible for modifying the database schema, likely by adding a comment field to a table related to scores.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231104004529_scores_add_index",
            "description": "This directory contains a specific Prisma database migration script for the 'langfuse/shared' package. Its purpose is to add an index to the 'scores' table, as indicated by its timestamped name.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230523082455_rename_metrics_to_gradings",
            "description": "This directory represents a specific Prisma database migration script. Its role is to facilitate a schema evolution that renames 'metrics' related database entities to 'gradings', identified by the timestamp '20230523082455'. This ensures consistency with updated terminology within the shared package's database schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231116005353_scores_unique_id_projectid",
            "description": "This directory contains a specific Prisma database migration script, timestamped '20231116005353', for the 'shared' package. Its purpose is to implement changes related to ensuring unique 'scores' based on a combination of 'id' and 'projectId' in the database schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240118204639_add_models_table",
            "description": "This directory contains the specific Prisma migration files responsible for adding the 'models' table to the database schema. It represents a single, versioned change in the database structure for the shared package. These files define how the database should be updated to include this new table.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240304222519_scores_add_index",
            "description": "This directory contains a specific database migration script for the shared Prisma schema. It is responsible for adding an index to the 'scores' table, as indicated by its name and timestamp.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240307185725_backfill_score_source",
            "description": "This directory contains a specific Prisma database migration script. The migration, named '20240307185725_backfill_score_source', is responsible for backfilling data related to a score source within the shared database schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240130160110_claude_models",
            "description": "This directory represents a specific Prisma database migration within the shared Langfuse package. It is responsible for applying schema changes related to the integration or management of Claude AI models, identified by its timestamp and descriptive name.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240312195727_score_source_drop_default",
            "description": "This directory contains a specific Prisma database migration. It holds the schema changes for the `20240312195727_score_source_drop_default` migration within the shared package.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230731162154_score_value_float",
            "description": "This directory represents a specific database migration within the Prisma schema for the shared package. Named `20230731162154_score_value_float`, it denotes a change intended to alter a 'score value' field to a float data type. Although currently empty, it serves as a placeholder or historical marker for this particular schema evolution step.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240307185544_score_add_name_index",
            "description": "This directory contains a specific Prisma database migration for the shared `langfuse` package. It defines the schema changes necessary to add a new index, likely to a 'name' field within a scoring-related table, as indicated by its timestamped name.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240307185543_score_add_source_nullable",
            "description": "This directory contains a specific Prisma database migration. Its role is to define the schema changes for adding a nullable 'source' field to the 'score' table or similar data structure. The timestamp in its name indicates when this migration was created.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240131184148_add_finetuned_and_vertex_models",
            "description": "This directory contains a specific Prisma database migration identified by its timestamp and descriptive name. Its primary role is to house the necessary schema changes to integrate support for finetuned and Vertex AI models within the application's database. It ensures the database structure is updated to accommodate these new model types.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Hassieb Pakzad",
            "percent": 36
          },
          {
            "name": "marliessophie",
            "percent": 33
          },
          {
            "name": "Steffen Schmitz",
            "percent": 16
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 249,
      "spofCount": 158
    },
    "busFactor": 2,
    "authorCount": 12
  },
  "Dataset & Experiment Management": {
    "description": "Create, manage, and version datasets for testing and evaluation. Run experiments to compare different model versions or prompts against curated data to find the best-performing configurations.",
    "functions": {
      "Dataset & Item Management UI": {
        "files": [
          {
            "path": "web/src/components/onboarding/DatasetsOnboarding.tsx",
            "description": "This file defines the `DatasetsOnboarding` component, which displays a splash screen to introduce users to Datasets & Experiments in Langfuse. It provides an overview, value propositions, and actions to create a dataset or learn more.",
            "spof": true
          },
          {
            "path": "web/src/components/onboarding/DatasetItemsOnboarding.tsx",
            "description": "This component provides an onboarding experience for adding items to a dataset, offering various methods such as CSV upload, manual entry, and links to code-based integration.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/datasets-ui-table.servertest.ts",
            "description": "This file contains server-side integration tests for the `getDatasetRunItemsCountCh` function, verifying its ability to correctly count dataset run items with and without dataset filters.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/datasets.tsx",
            "description": "This file defines the page component for displaying and managing datasets within a specific project. It shows an onboarding experience for new projects without datasets and lists existing datasets in a table.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/datasets/[datasetId]/items.tsx",
            "description": "This file implements the dataset items page, displaying a table of items for a specific dataset, along with options to add new items, manage the dataset, view version history, and onboard new users.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/datasets/[datasetId]/items/[itemId]/index.tsx",
            "description": "This file defines the Next.js page for viewing a specific dataset item, displaying its details, version history, and allowing users to compare different versions or view an older version.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/datasets/[datasetId]/index.tsx",
            "description": "This file implements the detail page for a specific dataset within a project. It displays dataset information, runs, analytics, and provides actions such as running experiments, configuring evaluators, and managing the dataset.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/datasets/[datasetId]/runs/[runId].tsx",
            "description": "This file defines a React page that displays the details of a specific dataset run within a project, including its associated items, version, description, and metadata. It also provides navigation, comparison, and deletion functionalities for the dataset run.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/DatasetChoiceStep.tsx",
            "description": "This component presents two options to the user: either select an existing dataset or create a new one to add observations to. It serves as a step in a larger dialog for adding observations to a dataset.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/DatasetCreateStep.tsx",
            "description": "This file defines a React component, `DatasetCreateStep`, which renders a form for creating a new dataset. It serves as a step within a larger dialog that likely involves adding observations, allowing users to define a new dataset before proceeding.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/DatasetSelectStep.tsx",
            "description": "This file defines a React component (`DatasetSelectStep`) that provides a UI step for selecting an existing dataset from a searchable list, typically used within a dialog to add observations to a chosen dataset.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/StatusStep.tsx",
            "description": "This component displays the real-time status and progress of a batch operation to add observations to a dataset. It polls for updates, shows counts of processed/failed items, and provides navigation based on the operation's completion status.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/components/SourceFieldSelector.tsx",
            "description": "This component provides a UI select input for choosing a source field (Input, Output, or Metadata). It is used within a dialog for adding observations to a dataset, allowing users to specify which part of an observation to refer to.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/utils/extractSchemaFields.ts",
            "description": "Provides utility functions to extract structured field information from a JSON Schema, including nested properties, and generate default key-value entries for UI consumption.",
            "spof": true
          },
          {
            "path": "web/src/features/feature-flags/README.md",
            "description": "This README file provides documentation for the feature flag system, explaining how to configure and use feature flags, and the conditions under which a feature flag is considered enabled.",
            "spof": true
          },
          {
            "path": "web/src/features/feature-flags/available-flags.ts",
            "description": "This file defines and exports a list of all available feature flags used within the application. It acts as a central registry for managing feature toggles.",
            "spof": false
          },
          {
            "path": "web/src/features/folders/utils.ts",
            "description": "This file provides utility functions for manipulating folder paths, specifically for generating breadcrumb items from a given path and constructing full paths from a parent folder and item name.",
            "spof": true
          },
          {
            "path": "web/src/features/folders/components/FolderBreadcrumbLink.tsx",
            "description": "This React component (`FolderBreadcrumbLink`) renders a clickable link displaying a folder icon and its name. It is likely used within breadcrumbs or tables to navigate or reference specific folders.",
            "spof": true
          },
          {
            "path": "web/src/features/folders/hooks/useFolderPagination.ts",
            "description": "This file defines a React hook (`useFolderPagination`) that manages pagination and folder navigation state using URL query parameters, providing utilities to navigate folders and reset pagination.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetItemVersionedContent.tsx",
            "description": "This component renders a dataset item at a specific historical version, providing options to view it in a diff mode compared to the latest version. It also manages various loading states and scenarios where the item may not exist at a particular version.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetItemFieldSchemaErrors.tsx",
            "description": "This React component displays schema validation errors for dataset items, providing a structured and visually distinct way to present error messages to the user.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetItemField.tsx",
            "description": "This file defines a React component `DatasetItemField` for displaying and editing dataset item fields (e.g., input, output). It includes features for code editing, schema display, and validation error reporting.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetItemSchemaErrors.tsx",
            "description": "This file defines a React component called `DatasetItemSchemaErrors` which displays schema validation errors for dataset items. It groups and formats these errors by dataset and field (input/expectedOutput) within an alert component.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetActionButton.tsx",
            "description": "This component renders a button that, when clicked, opens a dialog containing a form to create, update, or delete a dataset. It includes access control checks and analytics tracking.",
            "spof": false
          },
          {
            "path": "web/src/features/datasets/components/DatasetItemDiffView.tsx",
            "description": "This component displays the differences between two versions of a dataset item, specifically comparing their input, expected output, and metadata using a diff viewer within accordion sections.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetForm.tsx",
            "description": "This file defines a React component for managing datasets, providing a form to create, update, or delete datasets with schema validation and integration with a backend API.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetIOCells.tsx",
            "description": "This file contains React components for displaying input/output (IO) data from dataset items, traces, and observations within a table cell, handling data fetching and loading states.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetVersionWarningBanner.tsx",
            "description": "This component displays a banner informing the user that they are viewing an older version of a dataset, showing the version's timestamp and optionally the number of changes since that version, with an option to return to the latest version.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetRunItemsByItemTable.tsx",
            "description": "This file defines a React component that displays a paginated table of dataset run items associated with a specific dataset item, including their inputs, outputs, trace links, and scores. It manages table state such as column visibility, order, and row height.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetItemDetailPage.tsx",
            "description": "This component renders the detail page for a specific dataset item. It displays item information, provides navigation, and offers actions such as editing, deleting, archiving, and creating new items from the current one.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/NotFoundCard.tsx",
            "description": "This file defines a React component, `NotFoundCard`, which displays a customizable 'Not found' message for data items like traces or observations, indicating they are either processing or deleted. It offers two display modes: a compact single-line version or a more prominent card.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DuplicateDatasetButton.tsx",
            "description": "This file defines a React component, `DuplicateDatasetButton`, which allows users to duplicate an existing dataset and its items. It includes access control checks and navigates to the new dataset upon successful duplication.",
            "spof": false
          },
          {
            "path": "web/src/features/datasets/components/DatasetSchemaInput.tsx",
            "description": "This component provides a form input for defining a dataset's JSON schema, allowing users to enable/disable schema enforcement and edit the schema using a JSON editor.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetItemViewModeContent.tsx",
            "description": "This component renders the read-only details of a single dataset item, displaying its input, expected output, and metadata. It includes UI for loading states and when a dataset item is not found.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/EditDatasetItem.tsx",
            "description": "This component provides a form for editing an existing dataset item, allowing users to modify its input, expected output, and metadata, with real-time JSON and schema validation.",
            "spof": false
          },
          {
            "path": "web/src/features/datasets/components/NewDatasetItemFromExistingObject.tsx",
            "description": "This component provides a UI for creating new dataset items, either by extracting data from existing traces/observations or by copying an existing dataset item. It handles different UI states based on whether the item is already associated with datasets or is a new entry.",
            "spof": false
          },
          {
            "path": "web/src/features/datasets/components/DatasetItemFields.tsx",
            "description": "This React component displays and allows editing of dataset item fields (input, expected output, and metadata). It integrates with `react-hook-form` for editable forms and provides validation against a dataset schema.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/UploadDatasetCsv.tsx",
            "description": "This file defines a React component `UploadDatasetCsv` that enables users to upload a single CSV file for dataset creation. It includes functionality for file validation, size checking, client-side parsing, and displaying a preview of the CSV data, utilizing a drag-and-drop interface.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/NewDatasetItemButton.tsx",
            "description": "This component renders a button that, when clicked, opens a dialog containing a form to create a new item for a dataset. It includes access control and analytics tracking for the action.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetSchemaHoverCard.tsx",
            "description": "This component renders a hover card that displays a JSON schema (either for input or expected output) and an automatically generated example object based on that schema. It also allows copying the example object to the clipboard.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetsTable.tsx",
            "description": "This file defines the `DatasetsTable` component, which fetches and displays a list of datasets for a given project. It provides functionalities like folder navigation, search, pagination, and actions to manage individual datasets and their schemas.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetRunItemsByRunTable.tsx",
            "description": "This file defines a React component that displays a data table of run items associated with a specific dataset run. It fetches and presents details such as trace information, scores, metrics, and input/output for each item, with features like pagination, filtering, and column management.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetItemsTable.tsx",
            "description": "This file defines a React component, `DatasetItemsTable`, responsible for displaying and managing a table of items within a specific dataset. It includes functionalities for pagination, filtering, searching, editing, archiving, and deleting dataset items.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DiffLabel.tsx",
            "description": "This component, `DiffLabel`, displays and color-codes differences between values (numeric or categorical), often used for metrics like scores, latency, or costs in comparison views. It leverages a Badge component to visually represent the direction and magnitude of the difference.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DeleteDatasetRunButton.tsx",
            "description": "This file defines a React component that renders a button to delete a specific dataset run, including a confirmation dialog, access control, and analytics tracking.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetRunsTable.tsx",
            "description": "This file implements a React component `DatasetRunsTable` that displays a paginated and filterable table of dataset runs. It includes functionality for viewing run details, managing (comparing and deleting) multiple selected runs, and displaying associated scores.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetSchemaValidationError.tsx",
            "description": "This React component displays a destructive alert for dataset schema validation errors. It summarizes the number of errors and allows users to expand the alert to view detailed validation messages for each failed dataset item, including links to the respective items.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/EditDatasetItemDialog.tsx",
            "description": "This component defines a dialog for editing an existing dataset item. It provides a form for input, expected output, and metadata, including validation and interaction with an API to update the dataset item.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetAggregateTableCell.tsx",
            "description": "This React component displays aggregated data for a single cell within a dataset, showing trace/observation output, scores, and resource metrics, with support for comparing against a baseline and interactive features like annotation and peeking.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetVersionHistoryPanel.tsx",
            "description": "This component displays and manages the version history for a specific dataset, grouping versions by time (e.g., today, last 7 days) and allowing users to select a version or view related actions.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/NewDatasetItemForm.tsx",
            "description": "This file defines a React component for a form that allows users to create new dataset items, featuring input validation, schema-based example generation, and submission to the API.",
            "spof": false
          },
          {
            "path": "web/src/features/datasets/lib/convertRunItemDataToUiTableRow.ts",
            "description": "This file provides utility functions to convert `EnrichedDatasetRunItem` objects into UI table row data formats for displaying dataset run items, specifically for 'by item' and 'by run' views. It extracts and formats relevant data points like ID, timestamp, costs, and latency for UI presentation.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/hooks/useDatasetItemValidation.ts",
            "description": "This file defines a React hook, `useDatasetItemValidation`, that validates input and expected output JSON strings against the schemas defined for multiple datasets. It returns a validation result including any errors found and an indication of whether any schemas were present.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/hooks/useDatasetVersion.tsx",
            "description": "This file defines a React hook (`useDatasetVersion`) that manages and synchronizes the selected dataset version with URL query parameters, allowing it to be set, retrieved, and reset to the latest.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/utils/datasetItemUtils.ts",
            "description": "This file provides utility functions for handling dataset item data, including stringifying JSON and transforming dataset objects into a consistent schema for validation purposes.",
            "spof": true
          },
          {
            "path": "web/src/features/navigation/utils/dataset-tabs.ts",
            "description": "This file defines constants for dataset navigation tabs and provides a utility function to generate an array of tab objects with their labels, values, and corresponding routes for 'Runs' and 'Items' within a dataset view.",
            "spof": true
          },
          {
            "path": "web/src/features/navigation/utils/dataset-item-tabs.ts",
            "description": "This file defines constants, types, and a utility function for generating navigation tabs related to a specific dataset item within the application. It provides tab configurations for viewing dataset item details and its associated runs, including their respective URLs.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/dataset-items-columns.ts",
            "description": "This file defines the column definitions and metadata used for filtering and displaying dataset items, mapping user-friendly names to internal database fields.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/tableMappings/mapDatasetRunItemsTable.ts",
            "description": "This file defines the UI column mappings for dataset run items, translating between user interface identifiers and ClickHouse database columns. It also provides a utility function for mapping filter columns for dataset run items.",
            "spof": true
          },
          {
            "path": "packages/shared/src/tableDefinitions/datasetItemsTable.ts",
            "description": "This file defines column definitions for filtering operations related to dataset items, specifically the 'Metadata' column. It provides a standardized structure for how these columns are represented and used.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "marliessophie",
            "percent": 63
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 28
          },
          {
            "name": "Marc Klingen",
            "percent": 5
          }
        ]
      },
      "Data Ingestion & Mapping": {
        "files": [
          {
            "path": "web/src/components/session/NewDatasetItemFromTrace.tsx",
            "description": "This component fetches a specific trace by ID and provides its input, output, and metadata to another component for creating a new dataset item. It enables adding a trace's data to a dataset.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/useAddToDatasetWizard.ts",
            "description": "This file defines a React hook `useAddToDatasetWizard` that manages the state and logic for a multi-step wizard dialog used to add observations to a dataset. It orchestrates user interactions, data fetching, and API calls for selecting or creating a dataset and mapping observation fields.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/types.ts",
            "description": "This file defines the TypeScript types and interfaces for the \"Add Observations to Dataset\" dialog. It includes types for dialog steps, mapping configurations, wizard state, and props used across its components.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/FinalPreviewStep.tsx",
            "description": "This component provides a final preview step in a dialog for adding observations to a dataset. It displays how input, output, and metadata will be mapped and integrated, allowing users to review the configuration before confirmation.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/index.tsx",
            "description": "This file defines a multi-step wizard dialog that enables users to add selected observations to a dataset. It provides options to select an existing dataset, create a new one, map observation fields to dataset schema, and track the submission status.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/MappingStep.tsx",
            "description": "This React component defines a step within a dialog for adding observations to a dataset. It allows users to configure and preview how incoming observation data fields are mapped to specific dataset item fields, supporting both full and custom mapping modes based on an optional schema.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/wizardReducer.ts",
            "description": "This file defines a reducer for managing the state and transitions of a multi-step wizard, specifically for the dialog used to add observations to a dataset. It handles navigation between steps, dataset selection/creation, data mapping configuration, validation, and submission status.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/components/JsonPathInput.tsx",
            "description": "This file defines a React component, `JsonPathInput`, which provides an input field for JSON paths with syntax highlighting and real-time validation against provided source data. It uses CodeMirror for the editor and a custom language mode for JSON path highlighting.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/components/MappingModeSelector.tsx",
            "description": "This file defines a React component (`MappingModeSelector`) that allows users to select a data mapping mode (e.g., full, custom, or none) for observation fields. It is used within a dialog for adding observations to a dataset.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/components/MappingPreviewPanel.tsx",
            "description": "This component provides a preview panel for data mapping configurations. It displays the original source data, the transformed result data, and validates the result against an optional JSON schema, showing any validation errors.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/components/AddObservationsToDatasetDialog/components/CustomMappingEditor.tsx",
            "description": "This file defines a React component (`CustomMappingEditor`) that allows users to configure custom data mappings for observations. It enables mapping data either as a single root value or as a key-value map, using source fields and JSON paths.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/CsvImportValidationError.tsx",
            "description": "This component displays detailed validation errors encountered during the CSV import process for a dataset. It allows users to view a summary of errors and expand to see specific issues per row and field.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/CsvColumnsCard.tsx",
            "description": "This file defines a React component that displays a card containing a list of draggable CSV columns, along with their inferred types, typically used for mapping purposes in a dataset feature.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/CsvUploadDialog.tsx",
            "description": "This file defines a React component, `CsvUploadDialog`, which provides a modal dialog for users to upload and preview CSV files. It orchestrates the process of selecting a CSV, displaying a preview, and then importing it into a specified dataset within a project.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/ImportCard.tsx",
            "description": "This file defines a React component, `ImportCard`, which facilitates the import and mapping of CSV columns using drag-and-drop functionality, supporting both freeform column management and schema-driven mapping.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/PreviewCsvImport.tsx",
            "description": "This component provides an interface for users to preview a CSV file, map its columns to a dataset's input/output schemas or metadata using drag-and-drop, and initiate the import process into a dataset.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/MappingCard.tsx",
            "description": "Provides a drag-and-drop interface within a card component for mapping CSV columns to specific fields for dataset input, expected output, and metadata.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/UploadDatasetCsvButton.tsx",
            "description": "This component provides a button that, when clicked, opens a dialog for uploading CSV data to a specific dataset. It includes access control checks and analytics tracking for the upload action.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/lib/findDefaultColumn.ts",
            "description": "This file defines a utility function `findDefaultColumn` that attempts to find the most suitable column name from a list based on a given title, using exact matches and fuzzy string matching (Levenshtein distance).",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/lib/csv/types.ts",
            "description": "This file defines TypeScript types for CSV parsing, column previewing, data type inference, and flexible field mapping configurations, likely used for handling dataset imports or transformations.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/lib/csv/helpers.ts",
            "description": "This file provides client-side utilities for parsing CSV data, including functions for configuring the parser, handling file reading, inferring column types, and mapping CSV columns to structured objects or JSON values.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/hooks/useCsvDragAndDrop.ts",
            "description": "This React hook (`useCsvDragAndDrop`) manages drag-and-drop interactions for mapping CSV columns to various target areas like input, expected, metadata, or specific schema keys within a UI, handling both starting and ending drag events.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/hooks/useCsvMapping.ts",
            "description": "This React hook provides state management and actions for mapping CSV columns to 'input', 'expected output', and 'metadata' fields, supporting both freeform and schema-defined structures. It initializes default mappings and offers functions to add, remove, and reset column assignments.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/hooks/useCsvImport.ts",
            "description": "This file defines a React hook, `useCsvImport`, responsible for client-side CSV parsing, data mapping, and chunked upload to import dataset items into the application. It manages import progress, handles validation errors, and interacts with the API for bulk item creation.",
            "spof": true
          },
          {
            "path": "worker/src/features/batchAction/processAddObservationsToDataset.ts",
            "description": "This file contains the logic for processing a batch action to add observations to a specified dataset. It maps observation data, creates dataset items in chunks, and updates the status and progress of the batch action in the database.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/batchAction/addToDatasetTypes.ts",
            "description": "Defines Zod schemas and TypeScript types for configuring how observation data (input, output, metadata) can be mapped and added to a dataset, including various mapping modes and target types.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/batchAction/applyFieldMapping.ts",
            "description": "This file provides utilities for evaluating and testing JSON paths, setting nested object values, and applying flexible field mapping configurations to transform observation data (input, output, metadata) into a structured dataset format. It also includes functionality for generating JSON path autocomplete suggestions.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/load-seed-clickhouse.ts",
            "description": "This script seeds project and API key data into the database and then prepares or loads seed data into ClickHouse for those projects, typically used for testing or development environments. It parses configuration from command-line arguments to specify the number of projects, days, and observations.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/utils/README.md",
            "description": "This README describes the Langfuse Seeder system, a tool designed to generate realistic test data in both ClickHouse and PostgreSQL databases for Langfuse development and testing purposes.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/utils/types.ts",
            "description": "This file defines types and utility functions related to data seeding, including different seeding modes, options for generation, and interfaces for dataset items and file content structures.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/utils/seeder-orchestrator.ts",
            "description": "This file defines the `SeederOrchestrator` class, which orchestrates the generation and insertion of various types of seed data (e.g., synthetic, evaluation, dataset experiment) into ClickHouse and PostgreSQL databases. It's used for testing, performance analysis, and demonstration purposes.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Hassieb Pakzad",
            "percent": 50
          },
          {
            "name": "marliessophie",
            "percent": 46
          },
          {
            "name": "Michael Frhlich",
            "percent": 2
          }
        ]
      },
      "AI Model Configuration Management": {
        "files": [
          {
            "path": "web/src/components/table/use-cases/models.tsx",
            "description": "This file defines a React component that displays a data table for managing AI models within a project. It fetches model data, displays their configuration and pricing, and provides actions like editing, cloning, and deleting models.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/models/[modelId]/index.ts",
            "description": "This file defines a public API endpoint for managing specific models. It allows authenticated users to retrieve a model's definition (including pricing tiers) or delete a project-specific model by its ID.",
            "spof": false
          },
          {
            "path": "web/src/pages/project/[projectId]/settings/models/[modelId].tsx",
            "description": "This file implements a Next.js page component that displays the detailed configuration and pricing information for a specific model within a project's settings, allowing users to view model properties, tokenizer details, and manage pricing tiers, along with actions to edit, delete, clone, or test the model.",
            "spof": true
          },
          {
            "path": "web/src/features/feature-flags/utils.ts",
            "description": "This utility file provides a function to parse an array of raw feature flag strings into a structured object, where each flag's status (enabled/disabled) is determined by its presence in the input array. It helps in preparing feature flag data for application use.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20231106213824_add_openai_models",
            "description": "This directory contains a specific Prisma database migration for the shared package of the Langfuse project. Its role is to define the schema changes made on 2023-11-06 to integrate OpenAI models into the database structure.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Hassieb Pakzad",
            "percent": 77
          },
          {
            "name": "marliessophie",
            "percent": 10
          },
          {
            "name": "Marc Klingen",
            "percent": 6
          }
        ]
      },
      "Dataset Persistence & Versioning": {
        "files": [
          {
            "path": "web/src/__tests__/async/experiments-versioning.servertest.ts",
            "description": "This test file verifies the dataset versioning capabilities of the Langfuse application, specifically how experiment configuration validation and temporal queries for dataset items behave with different versions.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/datasets-schema-validation.servertest.ts",
            "description": "This file contains unit tests for schema validation utilities, including functions to check if an object is a valid JSON schema and to validate data against a given schema, as well as a validator for dataset items' input and expected output schemas.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/datasets-api.servertest.ts",
            "description": "This file contains server-side Jest tests for the public API endpoints related to managing datasets and dataset items in Langfuse. It covers creation, retrieval, updates, and various scenarios for both V1 and V2 API versions, including handling archived items and error cases.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/repositories/dataset-items-repository.servertest.ts",
            "description": "This file contains integration tests for the dataset items repository, specifically focusing on the versioning functionality of dataset items, including creation, updates, deletions, and retrieval of version history and changes.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/datasets.ts",
            "description": "This file defines the API endpoints for creating, updating, and retrieving datasets within a project. It handles both POST requests to create/update a dataset and GET requests to fetch a list of datasets with their associated items and runs.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/dataset-run-items.ts",
            "description": "This file defines a public API endpoint for managing dataset run items. It allows for the creation of new dataset run items, associating them with traces and dataset items, and retrieving existing dataset run items based on dataset and run details.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/dataset-items/index.ts",
            "description": "This file defines the API endpoint for managing dataset items, allowing users to create, update (upsert), and retrieve dataset items for a given project. It supports both POST requests for upserting and GET requests for fetching items, including pagination.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/dataset-items/[datasetItemId].ts",
            "description": "This file defines the public API endpoints for retrieving and deleting a specific dataset item. It handles authentication, data retrieval, deletion, and audit logging for dataset items within a project.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/media/[mediaId].ts",
            "description": "This file defines API endpoints for retrieving signed URLs for media assets and updating their upload status and metadata within a project. It handles fetching media details and finalizing the upload process by updating database records.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/v2/datasets/index.ts",
            "description": "This file defines a public API endpoint for managing datasets. It allows clients to create new datasets via a POST request and retrieve a paginated list of existing datasets via a GET request.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/v2/datasets/[datasetName]/index.ts",
            "description": "This file defines a public API route (`GET /v2/datasets/[datasetName]`) for retrieving a specific dataset by its name for an authenticated project. It fetches the dataset from the database and transforms it into the API response format.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/datasets/[name]/index.ts",
            "description": "This file defines a public API endpoint to retrieve a specific dataset by its name, including its items and associated run names, within an authenticated project.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/datasets/[name]/runs/[runName].ts",
            "description": "This file defines an API endpoint for retrieving and deleting a specific dataset run within a given dataset. It handles GET requests to fetch run details and items, and DELETE requests to remove a dataset run and trigger related cleanup.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/datasets/[name]/runs/index.ts",
            "description": "This file defines a public API endpoint to retrieve a paginated list of runs associated with a specific dataset, identified by its name, for an authenticated project.",
            "spof": true
          },
          {
            "path": "web/src/features/batch-actions/validation.ts",
            "description": "This file defines Zod schemas for validating various batch action related operations, including creating batch actions to add observations to datasets, validating dataset mappings, and fetching or listing batch actions.",
            "spof": true
          },
          {
            "path": "web/src/features/models/server/isValidPostgresRegex.ts",
            "description": "This file provides a utility function to validate if a given string is a syntactically valid PostgreSQL regular expression by attempting to execute a test query.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/types/datasets.ts",
            "description": "This file defines Zod schemas for public API data models related to datasets, dataset runs, and dataset items, including their transformations from database types and schemas for various API endpoint requests and responses.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/server/dataset-runs.ts",
            "description": "This file provides a utility function to create or fetch a dataset run, handling concurrent requests gracefully to ensure uniqueness and prevent race conditions. It is specifically designed for public API endpoints that might receive simultaneous requests for the same resource.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/server/dataset-run-items.ts",
            "description": "This file defines server-side functions for the public API to retrieve and count dataset run items associated with a specific dataset and run ID. It handles data fetching, pagination, and transformation for external API consumption.",
            "spof": true
          },
          {
            "path": "web/src/features/media/validation.ts",
            "description": "This file defines enums for supported media types, file extensions, and where media can be enabled. It also provides Zod schemas for validating API requests and responses related to media uploads and retrieval.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/server/service.ts",
            "description": "This file provides server-side services for fetching, filtering, and enriching dataset runs and their associated items within the Langfuse application. It includes functions for data validation, retrieval of dataset items, and enrichment with trace scores, observation metrics, and recursive calculations.",
            "spof": false
          },
          {
            "path": "web/src/features/datasets/server/actions/createDataset.ts",
            "description": "This file provides server-side actions for creating, updating, and upserting datasets in the database. It handles data validation, especially for dataset names and schemas, ensuring data integrity before persistence.",
            "spof": false
          },
          {
            "path": "web/src/features/datasets/server/actions/README.md",
            "description": "This README documents the guidelines and purpose of dataset mutation functions within the server-side actions, emphasizing the use of dedicated functions for validation, upsert logic, and null handling instead of direct Prisma calls. It outlines the rules for interacting with dataset data.",
            "spof": true
          },
          {
            "path": "worker/src/__tests__/backfillValidToForDatasetItems.test.ts",
            "description": "This file contains unit tests for the `backfillValidToForDatasetItems` utility function, ensuring it correctly populates the `validTo` timestamp for dataset item versions during a background migration process. It verifies the logic for version chaining, project-based processing, and final state consistency.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/migrateDatasetRunItemsFromPostgresToClickhouseRmt.ts",
            "description": "This file defines a background migration task to transfer dataset run items from a PostgreSQL database to a ClickHouse database in batches, including validation and state management for the migration process.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/migrateDatasetRunItemsFromPostgresToClickhouse.ts",
            "description": "Defines a background migration class for moving dataset run items from PostgreSQL to ClickHouse, though the migration itself is skipped in favor of an 'RMT migration'.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/backfillSysIdForDatasetItems.ts",
            "description": "Defines a background migration class that was originally intended to backfill the `sys_id` field for dataset items. However, this migration is now deprecated and always skips its operation, as the underlying requirement has been addressed by newer system features.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/backfillValidToForDatasetItems.ts",
            "description": "This file defines and executes a background migration to backfill `valid_to` timestamps for `dataset_items` in the database. It ensures historical dataset item versions are properly marked with an end time, enabling accurate temporal queries.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/backfillExperimentsHistoric.ts",
            "description": "This file defines a background migration class responsible for backfilling historical experiment data. It fetches dataset run items (DRIs) and their associated traces and spans, enriches them with experiment information, and stores the updated data.",
            "spof": true
          },
          {
            "path": "worker/src/backgroundMigrations/utils/datasetItems.ts",
            "description": "This file contains a background migration utility to backfill the 'valid_to' column for 'dataset_items' in the database. It calculates and sets the 'valid_to' timestamp based on the 'valid_from' of the subsequent version of each dataset item, for entries where 'valid_to' is currently null.",
            "spof": true
          },
          {
            "path": "worker/src/queues/datasetDelete.ts",
            "description": "This file defines a BullMQ processor for handling dataset deletion jobs. It orchestrates the deletion process by invoking `processClickhouseDatasetDelete` with the job's payload.",
            "spof": true
          },
          {
            "path": "worker/src/features/datasets/processClickhouseDatasetDelete.ts",
            "description": "This file processes requests to delete dataset run items from ClickHouse. It supports deleting all run items for a given dataset or specific run items based on their IDs.",
            "spof": true
          },
          {
            "path": "packages/shared/src/domain/dataset-items.ts",
            "description": "This file defines TypeScript domain types for dataset items, including a full representation and a version optimized for listing without large input/output payloads.",
            "spof": true
          },
          {
            "path": "packages/shared/src/domain/dataset-run-items.ts",
            "description": "This file defines the Zod schema and TypeScript type for a 'Dataset Run Item', which represents an individual record or execution within a dataset run. It includes details such as identifiers, timestamps, input/output, and metadata related to both the dataset run and the specific item.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/dataset-run-items/addToDeleteQueue.ts",
            "description": "This file defines a function to add dataset or dataset-run deletion jobs to a Redis queue. It ensures that specified datasets or dataset runs are queued for removal based on their type and associated IDs.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/datasets/schemaTypes.ts",
            "description": "Defines Zod schemas and TypeScript types for validating dataset-related JSON schemas (Draft 2020-12), handling schema validation errors, and typing the results of dataset mutations.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/datasets/schemaValidation.ts",
            "description": "This file provides a utility function `validateAllDatasetItems` designed to efficiently validate existing dataset items against new or updated schemas in batches, preventing schema changes that would invalidate current data.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/datasets/executeWithDatasetServiceStrategy.ts",
            "description": "This file provides a strategy pattern implementation for dataset service operations. It dynamically selects between stateful and versioned data storage implementations based on the operation type (read/write) and environment variable configurations.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/datasetDelete.ts",
            "description": "This file defines a singleton class, `DatasetDeleteQueue`, responsible for creating and managing a BullMQ Redis queue dedicated to processing dataset deletion tasks. It handles queue instantiation, connection, job options, and error logging.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/redis/datasetRunItemUpsert.ts",
            "description": "This file defines a singleton class for managing a BullMQ queue specifically designed for upserting dataset run items, configuring its connection, default job options, and error handling.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/services/DatasetService/index.ts",
            "description": "This file serves as an index for the server-side dataset service, re-exporting validators for dataset items and schemas. It aggregates validation utilities related to datasets.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/DatasetService/DatasetItemValidator.ts",
            "description": "Provides a utility class for validating and normalizing dataset item payloads, handling JSON parsing, control character sanitization, and schema validation against predefined input/output schemas.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/services/DatasetService/DatasetSchemaValidator.ts",
            "description": "Provides a utility class for efficiently validating dataset inputs and expected outputs against JSON schemas using AJV, compiling schemas once per operation for performance.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/dataset-items.ts",
            "description": "This file implements a repository for managing dataset items, including CRUD operations. It ensures data integrity by validating dataset items against defined schemas during creation and updates, using an optimized validation process.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/dataset-run-items-converters.ts",
            "description": "This file contains utility functions for converting data structures related to dataset run items and their associated metrics. It facilitates bidirectional conversion between the application's domain objects and the format used for storage in ClickHouse.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/dataset-run-items.ts",
            "description": "This file defines types and functions for querying and managing dataset run items, their associated metrics, and metadata. It primarily interacts with a ClickHouse database to retrieve, filter, and order dataset run data.",
            "spof": true
          },
          {
            "path": "packages/shared/src/tableDefinitions/index.ts",
            "description": "This file serves as a central index, re-exporting various table and view definitions from different modules within the application.",
            "spof": false
          },
          {
            "path": "packages/shared/src/features/batchAction/types.ts",
            "description": "This file defines enums, types, and Zod schemas for managing various batch actions (e.g., delete, add to queue) within the application, including their status, query parameters, and creation payloads.",
            "spof": false
          },
          {
            "path": "packages/shared/src/features/datasets/validation.ts",
            "description": "This file defines validation schemas for dataset names and data, and types for bulk dataset item validation errors within the Langfuse application's shared features.",
            "spof": false
          },
          {
            "path": "packages/shared/scripts/seeder/seed-dataset-versions.ts",
            "description": "This script seeds a database with test data for dataset versioning. It creates a test dataset and populates it with multiple versions of dataset items, including bulk inserts and mixed operations, managing their historical validity.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/utils/seed-helpers.ts",
            "description": "This file provides utility functions for generating unique identifiers for various data entities, such as dataset items, dataset run items, traces, observations, and scores. These helpers are likely used for seeding data within the application.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/utils/postgres-seed-constants.ts",
            "description": "This file defines constant data structures for various datasets, including their names, descriptions, metadata, and data items. These constants are used to seed a PostgreSQL database, likely for demo, testing, or initial setup purposes within the Langfuse application.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240106195340_drop_dataset_status",
            "description": "This directory contains a specific Prisma migration script named '20240106195340_drop_dataset_status'. Its role is to define and execute the database schema changes required to drop elements related to 'dataset status'.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230924232620_datasets_continued",
            "description": "This directory contains a specific Prisma database migration. It represents a schema change related to the 'datasets' feature, likely a continuation of previous work, applied on September 24, 2023.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240325212245_dataset_runs_add_metadata",
            "description": "This directory contains a specific Prisma migration script. Its role is to define database schema changes, particularly adding metadata fields to dataset runs. It ensures the database structure is updated to support new data requirements for dataset management within the application.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240326114337_dataset_run_item_backfill_trace_id",
            "description": "This directory contains a specific database migration script for the Prisma schema. It is responsible for backfilling the `trace_id` column for `dataset_run_item` records, ensuring data consistency or enrichment.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240326115136_dataset_run_item_traceid_non_null",
            "description": "This directory contains a specific database migration script for the shared Prisma schema. It's responsible for applying the schema change that makes the 'traceId' field non-nullable for 'dataset_run_item' entries.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240404210315_dataset_add_descriptions",
            "description": "This directory contains a specific Prisma migration file responsible for updating the database schema. It implements the change to add description fields to the 'dataset' tables, ensuring version control for database structure within the `shared` package.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240404203640_dataset_item_source_trace_id",
            "description": "This directory contains a specific database migration script, identified by its timestamp and purpose. It defines the schema changes necessary to introduce or modify a 'source_trace_id' field within 'dataset_item' records for the `langfuse` application, managed via Prisma.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240328065738_dataset_item_input_nullable",
            "description": "This directory contains a specific database migration script for the Prisma schema within the `langfuse` project's shared package. It defines the changes necessary to make the `dataset_item_input` field nullable, identified by its timestamp and name.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240326115424_dataset_run_item_index_trace",
            "description": "This directory contains a specific Prisma database migration script. It is responsible for defining schema changes, likely adding an index for dataset run items or traces, as part of the `shared` package's database evolution.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240326114211_dataset_run_item_bind_to_trace",
            "description": "This directory represents a specific Prisma database migration. It contains the necessary files to apply a schema change, identified by its timestamp and name, which aims to bind dataset run items to traces.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20240404232317_dataset_items_backfill_source_trace_id",
            "description": "This directory contains a specific Prisma database migration script identified by its timestamp and purpose. Its role is to apply a schema change related to backfilling the 'source_trace_id' for 'dataset_items' within the shared database schema.",
            "spof": false
          },
          {
            "path": "packages/shared/prisma/migrations/20230924232619_datasets_init",
            "description": "This directory contains a specific Prisma database migration for the 'shared' package of the 'langfuse' project. Named `20230924232619_datasets_init`, its purpose is to initialize or modify the database schema specifically related to datasets. It ensures the database structure supports dataset functionalities within the application.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "marliessophie",
            "percent": 81
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 9
          },
          {
            "name": "Steffen Schmitz",
            "percent": 4
          }
        ]
      },
      "Experiment Analytics & Comparison": {
        "files": [
          {
            "path": "web/src/__tests__/async/dataset-service.servertest.ts",
            "description": "This file contains asynchronous server-side tests for the dataset service, verifying its functionality to fetch and aggregate dataset run metrics and scores for UI presentation.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/datasets/[datasetId]/compare/charts.tsx",
            "description": "This page component visualizes and compares different runs of a specific dataset within a project using various charts and metrics. It allows users to select runs, view time-series charts, and manage experiments related to the dataset.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/datasets/[datasetId]/compare/index.tsx",
            "description": "This page component provides a user interface for comparing different runs (experiments) within a specific dataset, allowing users to select runs for comparison, create new experiments, and annotate individual data points.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/datasets/[datasetId]/items/[itemId]/runs.tsx",
            "description": "This Next.js page displays a detailed view of a specific dataset item, focusing on the runs associated with that item. It renders a table showing all runs related to the given dataset item within the project.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/hooks/useExperimentEvaluatorData.ts",
            "description": "This React hook manages the state and logic for selecting, configuring, and displaying evaluators associated with a specific experiment dataset. It handles partitioning evaluators into active/paused and preparing data for evaluator forms.",
            "spof": false
          },
          {
            "path": "web/src/features/datasets/components/DatasetAnalytics.tsx",
            "description": "This component provides a multi-select interface for users to choose various metrics and scores related to datasets, which are then used to display analytical charts. It captures user interactions for adding or removing chart views.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetCompareRunsTable.tsx",
            "description": "This component renders a data table that compares the results of multiple runs for a given dataset, displaying dataset items, their inputs, expected outputs, metadata, and aggregate metrics from different runs side-by-side. It provides filtering, column visibility, and pagination capabilities.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/DatasetRunAggregateColumnHelpers.tsx",
            "description": "This file provides helper functions and components for constructing and rendering columns in a dataset run comparison table, including features like run filtering, baseline selection, and aggregated data display within cells.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/lib/costCalculations.ts",
            "description": "This file provides utility functions for calculating and aggregating costs related to observations in a dataset. It includes functions to find observation descendants, sum individual observation costs, and calculate recursive costs for an observation and its entire lineage.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/lib/calculateScoreDiff.ts",
            "description": "Calculates and formats the difference between a current aggregated score and a baseline aggregated score, handling both numeric and categorical score types. It returns null if a meaningful difference cannot be determined.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/lib/calculateBaselineDiff.ts",
            "description": "This file provides utility functions to calculate the difference between current and baseline values, particularly for aggregated numeric and categorical scores, indicating if a change has occurred and quantifying numeric differences.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/lib/types.ts",
            "description": "Defines TypeScript types, `DatasetRunItemByItemRowData` and `DatasetRunItemByRunRowData`, used for representing detailed data rows within dataset run analyses in the web application. These types structure information such as run details, I/O, scores, latency, and cost for UI display.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/hooks/useDatasetRunAggregateColumns.ts",
            "description": "This file provides a React hook to fetch and construct aggregate column data for multiple runs within a dataset, including run-specific metadata, filter options, and score columns, to be used in UI components like tables.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/hooks/useDatasetRunsCompare.ts",
            "description": "This React hook manages the selection and comparison of runs within a specific dataset. It fetches dataset and run data, uses URL query parameters to persist selected run IDs, and allows adding new runs for comparison.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/hooks/useResourceMetricsDiff.ts",
            "description": "This hook calculates and provides the latency and total cost of a dataset run item, along with their differences compared to an optional baseline item.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/server/utils.ts",
            "description": "This file provides utility functions for calculating recursive metrics, specifically total cost and latency, for dataset run items based on their associated observations grouped by trace ID.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/contexts/DatasetCompareFieldsContext.tsx",
            "description": "This file defines a React Context (`DatasetCompareFieldsContext`) and related provider/hook (`DatasetCompareFieldsProvider`, `useDatasetCompareFields`) to manage the selection of fields for comparing dataset runs. It allows components to access, set, and toggle the comparison fields across the application.",
            "spof": true
          },
          {
            "path": "web/src/features/navigation/utils/dataset-run-compare-tabs.ts",
            "description": "This file defines constants and a utility function for generating navigation tabs used when comparing different runs of a dataset. It provides tab values, labels, hrefs, and query selectors for 'Compare' and 'Charts' views.",
            "spof": true
          },
          {
            "path": "packages/shared/src/tableDefinitions/datasetRunsTable.ts",
            "description": "This file defines column definitions for displaying dataset runs, including handling numeric and categorical scores. It also provides utility functions to identify columns requiring ClickHouse data and to dynamically format column options.",
            "spof": true
          },
          {
            "path": "packages/shared/src/tableDefinitions/mapDatasetRunsTable.ts",
            "description": "This file defines the UI column mappings for a dataset runs table, specifying how UI column names and IDs correspond to their respective fields in a ClickHouse database.",
            "spof": true
          },
          {
            "path": "packages/shared/src/tableDefinitions/datasetRunItemsTable.ts",
            "description": "This file defines the column structure for a dataset run items table. It includes functions to dynamically configure and update these columns with options, particularly for displaying aggregated score data.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/prepare-clickhouse.ts",
            "description": "This file provides a function to prepare ClickHouse data by seeding it with test data. It utilizes a seeder orchestrator to populate ClickHouse for specified projects and a given number of days.",
            "spof": true
          },
          {
            "path": "packages/shared/scripts/seeder/utils/clickhouse-seed-constants.ts",
            "description": "This file provides constant arrays of realistic example names and data for various components of AI/LLM applications, intended for seeding databases or generating test data, particularly for ClickHouse.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "marliessophie",
            "percent": 96
          },
          {
            "name": "Max Deichmann",
            "percent": 3
          },
          {
            "name": "Nimar",
            "percent": 1
          }
        ]
      },
      "Experiment Creation & Execution": {
        "files": [
          {
            "path": "web/src/features/experiments/types.ts",
            "description": "This file defines Zod schemas and TypeScript types for creating experiments, including data validation for experiment name, run name, prompt, dataset, model configuration, and optional structured output schema. It primarily outlines the structure of data used when initiating a new experiment in the `langfuse` web application.",
            "spof": false
          },
          {
            "path": "web/src/features/experiments/util.ts",
            "description": "This file provides utility functions for generating default names and descriptions for experiments and dataset runs within the application.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/components/MultiStepExperimentForm.tsx",
            "description": "This component renders a multi-step form for creating and configuring new experiments. It guides users through selecting prompts, datasets, evaluators, and defining experiment details before submission.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/components/RemoteExperimentUpsertForm.tsx",
            "description": "This component provides a form for setting up, editing, or deleting a remote dataset run trigger. It allows users to configure a webhook URL and a default JSON payload that will be sent to the service to initiate custom dataset runs.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/components/CreateExperimentsForm.tsx",
            "description": "This component provides a form for creating and managing experiments within a project, allowing users to choose between UI-driven prompt comparisons or SDK/API-driven custom experiment runs.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/components/RemoteExperimentTriggerModal.tsx",
            "description": "This React component renders a modal that allows users to trigger a 'remote experiment' or 'dataset run'. It prompts the user to input a JSON payload, which is then sent to a predefined URL along with project and dataset identifiers, and provides feedback on the operation's success or failure.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/components/shared/StepHeader.tsx",
            "description": "This file defines a reusable React component `StepHeader` that displays a title and description, typically used for labeling steps within experiment-related features.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/components/steps/DatasetStep.tsx",
            "description": "This React component, `DatasetStep`, allows users to select a dataset and its version for an experiment. It also validates the selected dataset's structure against the expected variables of a chosen prompt.",
            "spof": false
          },
          {
            "path": "web/src/features/experiments/components/steps/ExperimentDetailsStep.tsx",
            "description": "This file defines a React component, `ExperimentDetailsStep`, which serves as a form step for collecting basic details (name and optional description) when creating or configuring an experiment.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/components/steps/ReviewStep.tsx",
            "description": "This file defines the `ReviewStep` React component, which serves as the final step in an experiment configuration flow. It presents a summary of the selected prompt, model, dataset, evaluators, and experiment details, allowing users to review all settings before running the experiment.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/components/steps/PromptModelStep.tsx",
            "description": "This React component provides a user interface for selecting a prompt, its version, and configuring model parameters within a multi-step experiment setup, including options for structured output using LLM schemas.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/hooks/useEvaluatorDefaults.ts",
            "description": "This file provides a React hook `useEvaluatorDefaults` that returns a function to create default evaluation configurations for experiments, including variable mappings and dataset filters.",
            "spof": false
          },
          {
            "path": "web/src/features/experiments/hooks/useExperimentNameValidation.ts",
            "description": "This file defines a React hook, `useExperimentNameValidation`, that validates the uniqueness of an experiment name within a specific dataset and project. It fetches existing experiment names and integrates with a form to provide an error message if the name is not unique.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/hooks/useExperimentPromptData.ts",
            "description": "This React hook fetches prompt metadata for a given project, extracts expected input variables/placeholders from a selected prompt, and organizes all prompts by name. It provides prompt-related data for experiment configuration.",
            "spof": false
          },
          {
            "path": "web/src/features/experiments/types/stepProps.ts",
            "description": "This file defines TypeScript types and interfaces for managing state and props across different steps of an experiment creation or configuration flow within the application. It consolidates types related to forms, navigation, permissions, prompt models, datasets, evaluators, and specific step properties.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/utils/format.ts",
            "description": "This utility file provides a function to format various JSON-like payload inputs into a consistently pretty-printed JSON string. It intelligently handles undefined, already-parsed objects, and single or double-stringified JSON inputs.",
            "spof": true
          },
          {
            "path": "web/src/features/experiments/server",
            "description": "This directory is intended to house server-side logic and API routes specifically for the 'experiments' feature within the web application. It would handle data fetching and processing necessary to support the client-side components of this feature.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/experimentsService.test.ts",
            "description": "This file contains unit and integration tests for the experiment service, specifically testing the `createExperimentJobClickhouse` function. It verifies its functionality under various scenarios, including valid experiment creation, handling validation errors, and managing prompt variables.",
            "spof": true
          },
          {
            "path": "worker/src/queues/experimentQueue.ts",
            "description": "This file defines the processor for the 'ExperimentCreate' queue, responsible for creating experiment jobs in ClickHouse. It includes error handling and retry logic for LLM completion errors.",
            "spof": true
          },
          {
            "path": "worker/src/features/experiments/experimentServiceClickhouse.ts",
            "description": "This file handles the creation and execution of prompt experiments against datasets, leveraging ClickHouse for data storage and querying. It orchestrates processing dataset items, running LLM calls, and queuing evaluation tasks for experiments.",
            "spof": true
          },
          {
            "path": "worker/src/features/experiments/utils.ts",
            "description": "This file provides utility functions for processing prompts, dataset inputs, and configuring experiments within the Langfuse platform. It includes logic to fetch and validate experiment-related data, replace variables in prompts, and prepare experiment configurations.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/llm/types.ts",
            "description": "This file defines Zod schemas and TypeScript types for various LLM-related data structures, including chat messages, tool definitions, model configurations, and experiment metadata. It standardizes the data structures used for LLM interactions within the application.",
            "spof": false
          },
          {
            "path": "packages/shared/src/server/redis/experimentCreateQueue.ts",
            "description": "This file defines a singleton class that provides a BullMQ queue specifically for managing the creation of new experiments, handling Redis connection, queue configuration, and error logging.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/experiments/utils.ts",
            "description": "This file provides utility functions for validating and normalizing dataset item inputs, particularly for experiments involving prompt variables. It handles string inputs for single-variable prompts and ensures object compatibility for multi-variable scenarios.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "marliessophie",
            "percent": 64
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 31
          },
          {
            "name": "Nimar",
            "percent": 4
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 207,
      "spofCount": 159
    },
    "busFactor": 1,
    "authorCount": 9
  },
  "Data Annotation & Labeling": {
    "description": "A collaborative workflow tool for creating and managing annotation queues. Teams can distribute traces or other items for manual review and scoring to ensure data quality and improve model performance.",
    "functions": {
      "Annotation Queue Management": {
        "files": [
          {
            "path": "web/src/components/onboarding/AnnotationQueuesOnboarding.tsx",
            "description": "This file defines the onboarding component for Annotation Queues, guiding users through their purpose and features within the Langfuse application. It provides information on managing scoring workflows, collaboration, and tracking metrics, along with actions to create a new queue or learn more.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/annotation-queues-api.servertest.ts",
            "description": "This file contains server-side integration tests for the annotation queues API endpoints. It verifies the functionality of creating, retrieving, and managing annotation queues and their associated items, including pagination and error handling.",
            "spof": true
          },
          {
            "path": "web/src/__tests__/async/annotation-queue-assignments-api.servertest.ts",
            "description": "This file contains integration tests for the public API endpoints responsible for managing user assignments to annotation queues. It covers the creation, deletion, and error handling for these assignments.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/annotation-queues/index.ts",
            "description": "This file defines the API endpoints for managing annotation queues within a project. It handles requests to retrieve existing annotation queues and to create new ones, including data validation and entitlement checks.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/annotation-queues/[queueId].ts",
            "description": "This file defines a public API endpoint to retrieve a specific annotation queue by its ID for an authenticated project. It fetches the queue details from the database and returns them.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/annotation-queues/[queueId]/assignments.ts",
            "description": "This file defines API routes for managing assignments of users to annotation queues within a specific project. It allows creating/updating and deleting user assignments to annotation queues.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/annotation-queues.tsx",
            "description": "This file serves as the entry point for the Annotation Queues page within a specific project, re-exporting the core AnnotationQueues component.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/types/annotation-queues.ts",
            "description": "Defines Zod schemas for data validation related to annotation queues, their items, and assignments for a public API. It includes schemas for request bodies, responses, and core data structures for managing annotation queues.",
            "spof": false
          },
          {
            "path": "web/src/features/annotation-queues/components/AnnotationQueuesTable.tsx",
            "description": "This file defines the `AnnotationQueuesTable` component, which displays a paginated and sortable table of annotation queues. It includes features for managing queues, such as viewing details, processing items, and performing CRUD operations based on user access.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/components/UserAssignmentSection.tsx",
            "description": "This component manages user assignments for an annotation queue, allowing users to search, select, and remove users from the queue within a project. It displays current assignments and handles adding/removing users via API calls.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/components/DeleteAnnotationQueueButton.tsx",
            "description": "This component renders a button to delete an annotation queue, including access control checks, a confirmation dialog, and the associated API call.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/components/CreateNewAnnotationQueueItem.tsx",
            "description": "This component provides a dropdown menu button that allows users to view and manage (add/remove) a specific object's membership in various annotation queues within a project. It displays the queues the object is currently in and offers controls to toggle its inclusion, along with a link to manage all annotation queues.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/components/CreateOrEditAnnotationQueueButton.tsx",
            "description": "This file defines a React component that renders a button to open a dialog. The dialog allows users to create a new annotation queue or edit an existing one, including its name, description, score configurations, and user assignments.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/components/shared/hooks/useAnnotationQueueData.ts",
            "description": "This file provides a React hook, `useAnnotationQueueData`, to fetch and manage data for a specific annotation queue using an API query. It returns the queue's data and its associated score configurations.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/pages/AnnotationQueues.tsx",
            "description": "This file defines the main page for managing annotation queues within a project, displaying either an onboarding experience for new users or a table of existing annotation queues.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/hooks/useSelectedUsers.ts",
            "description": "This file defines a React hook `useSelectedUsers` that fetches and filters project members to retrieve details for a list of specified user IDs. It is used to display information about selected users within a project, typically for UI components like 'pills'.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/server",
            "description": "This directory is intended to contain server-side logic and API endpoints specifically for the 'annotation-queues' feature within the web application. It would manage data processing, persistence, and business logic related to managing annotation queues.",
            "spof": false
          },
          {
            "path": "worker/src/features/batchAction/processAddToQueue.ts",
            "description": "This file provides functions to add various types of objects (traces, sessions, observations) to an annotation queue, ensuring that duplicate entries are not created.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "marliessophie",
            "percent": 73
          },
          {
            "name": "Marc Klingen",
            "percent": 24
          },
          {
            "name": "Nimar",
            "percent": 2
          }
        ]
      },
      "Manual Scoring & Correction": {
        "files": [
          {
            "path": "web/src/components/trace2/components/IOPreview/components/CorrectedOutputField.tsx",
            "description": "This component provides an editable field for managing 'corrected outputs' within a trace or observation. It allows users to view, add, edit, and delete corrected output, supporting both plain text and strict JSON modes with diffing and access control capabilities.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/hooks/useCorrectionEditor.ts",
            "description": "A React hook for managing the state, input, validation, and debounced saving of a text editor used for corrections, supporting JSON and non-JSON modes.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/hooks/useCorrectionMutations.ts",
            "description": "A React hook for managing the creation, updating, and deletion of user corrections or scores with optimistic UI updates and cache invalidation. It provides functions to save and delete corrections, along with their loading states.",
            "spof": true
          },
          {
            "path": "web/src/components/trace2/components/IOPreview/components/hooks/index.ts",
            "description": "This file serves as an entry point for custom React hooks related to data, mutations, and editing functionalities for corrections within an I/O preview component.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/components/AnnotateDrawer.tsx",
            "description": "This file defines a reusable React component, `AnnotateDrawer`, which provides a button to open a drawer containing an annotation form for scores. It includes access control checks and analytics tracking for opening the form.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/components/AnnotationForm.tsx",
            "description": "This file implements a React component called `AnnotationForm` which provides a comprehensive form for users to add, update, and delete annotations (scores) for various targets within the Langfuse application, handling form state, mutations, and integration with score configurations.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/hooks/useScoreMutations.ts",
            "description": "This file defines a React hook `useScoreMutations` that encapsulates API mutations for creating, updating, and deleting annotation scores, including optimistic cache updates and error handling.",
            "spof": true
          },
          {
            "path": "web/src/features/scores/hooks/useScoreConfigs.ts",
            "description": "This file defines a React hook, `useAnnotationScoreConfigs`, which prepares and provides score configurations for an annotation form. It handles two modes: a 'fixed' mode using pre-selected configurations and a 'selectable' mode that fetches all available configurations from an API.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/components/shared/AnnotationDrawerSection.tsx",
            "description": "This component renders a section within a drawer for annotating items from an annotation queue. It displays an `AnnotationForm` to manage scores and provides UI feedback if the item is currently locked by another user.",
            "spof": false
          },
          {
            "path": "web/src/features/corrections/contexts/CorrectionCacheContext.tsx",
            "description": "This file defines a React Context and Provider for managing a client-side cache of 'corrections' (annotations for traces and observations), primarily for optimistic UI updates. It provides functions to add, retrieve, delete, and rollback these cached corrections.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/components/AnnotationPanel.tsx",
            "description": "This file defines the `AnnotationPanel` component, a resizable UI panel that allows users to view, add manual annotations (scores), and manage comments for a selected trace or observation within a dataset comparison interface.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/annotation/types.ts",
            "description": "This file defines Zod schemas and TypeScript types for managing annotation scores, their targets (traces/sessions), and annotation queues, primarily for UI-driven operations within the application.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "marliessophie",
            "percent": 95
          },
          {
            "name": "Michael Frhlich",
            "percent": 3
          },
          {
            "name": "Marc Klingen",
            "percent": 1
          }
        ]
      },
      "Collaborative Commenting & Feedback": {
        "files": [
          {
            "path": "web/src/__tests__/async/comments-api.servertest.ts",
            "description": "This file contains integration tests for the public comments API endpoints, covering the creation of comments, retrieval of single comments, and listing of comments with various filtering and error handling scenarios.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/feedback.ts",
            "description": "This file defines the API route handler for user feedback. It imports and exports a dedicated feedback handler, making it the entry point for feedback-related API requests.",
            "spof": false
          },
          {
            "path": "web/src/pages/api/public/comments/[commentId].ts",
            "description": "This file defines a public API endpoint for retrieving a specific comment by its ID, ensuring it belongs to the authenticated project and excluding internal positioning data.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/ReactionBar.tsx",
            "description": "This component displays a bar of reaction buttons for a specific comment, showing the emoji, count, and allowing users to toggle their reactions. It also includes hover cards to display the users who reacted with a particular emoji.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/ReactionPicker.tsx",
            "description": "This file defines a React component, `ReactionPicker`, that provides a button which, when clicked, opens a popover containing an emoji picker. It allows users to select an emoji, triggering a callback function with the chosen emoji.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/CommentList.tsx",
            "description": "This file implements the `CommentList` React component, which displays a list of comments for a specific object within a project. It provides functionality for users to view, add, search, and interact with comments, including features like user mentions, reactions, and dynamic UI adjustments.",
            "spof": false
          },
          {
            "path": "web/src/features/comments/components/CommentableJsonView.tsx",
            "description": "This file defines a React wrapper component, `CommentableJsonView`, that enables text selection within its child components, typically a JSON viewer, to support inline commenting functionality.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/components/InlineCommentBubble.tsx",
            "description": "This component renders a floating 'Comment' button that appears near selected text in a JSON view, allowing users to add inline comments.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/components/MentionBadge.tsx",
            "description": "This file defines the `MentionBadge` React component, which renders a styled badge displaying a user's display name (e.g., \"@username\") along with their user ID, typically used for mentions.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/hooks/useCommentedPaths.ts",
            "description": "This file defines a React hook `useCommentedPaths` that processes comment data to create maps of JSON paths to comment ranges, categorized by 'input', 'output', or 'metadata' fields. It is used to highlight commented text within a JSON viewer.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/hooks/useTextSelection.ts",
            "description": "This file defines a React hook `useTextSelection` that captures user text selections within a specified container, identifies their contextual data field (e.g., input, output), and debounces the updates to a global selection context, likely for features like inline commenting.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/lib/selectionToPath.ts",
            "description": "Converts a DOM text selection within an AdvancedJsonViewer component into a structured JSON path and character range, leveraging custom 'data-json-path' and 'data-json-key-value' attributes.",
            "spof": true
          },
          {
            "path": "web/src/features/comments/contexts/InlineCommentSelectionContext.tsx",
            "description": "This file defines a React context and provider for managing and sharing the state of a text selection, particularly for use with inline commenting features. It includes interfaces for selection data and hooks to access the selection state within components.",
            "spof": true
          },
          {
            "path": "web/src/features/public-api/types/comments.ts",
            "description": "Defines Zod schemas for comment-related data structures and API endpoints within the public API, including schemas for creating, retrieving, and listing comments.",
            "spof": false
          },
          {
            "path": "web/src/features/annotation-queues/components/shared/CommentsSection.tsx",
            "description": "This file defines the `CommentsSection` React component, which serves as a wrapper for the `CommentList` component. It is used to display and manage comments associated with specific annotation queue objects within the application.",
            "spof": false
          },
          {
            "path": "worker/src/features/database-read-stream/fetchCommentsForExport.ts",
            "description": "This file defines a utility function to fetch and group comments for specific objects by ID, intended for use in data export operations. It retrieves comment details, including author email, from the database and organizes them by their associated object ID.",
            "spof": true
          },
          {
            "path": "packages/shared/src/server/repositories/comments.ts",
            "description": "This file defines types and utility functions for querying and filtering comments based on their count or content, supporting operations like full-text search and specific content matching.",
            "spof": true
          },
          {
            "path": "packages/shared/src/features/comments/types.ts",
            "description": "This file defines Zod schemas and types for handling comments, including data validation for creating comments with optional inline positioning using JSON paths and text ranges, and for deleting comments.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Michael Frhlich",
            "percent": 43
          },
          {
            "name": "Nimar",
            "percent": 39
          },
          {
            "name": "Marc Klingen",
            "percent": 11
          }
        ]
      },
      "Queue Item Workflow & Processing": {
        "files": [
          {
            "path": "web/src/pages/api/public/annotation-queues/[queueId]/items/[itemId].ts",
            "description": "This file defines a public API endpoint for managing individual annotation queue items. It provides functionalities to retrieve, update, and delete a specific item within a designated annotation queue, ensuring proper authentication and authorization.",
            "spof": true
          },
          {
            "path": "web/src/pages/api/public/annotation-queues/[queueId]/items/index.ts",
            "description": "This file defines a public API endpoint for managing items within a specific annotation queue. It allows authenticated users to retrieve a paginated list of items from a queue and to create new items for that queue.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/annotation-queues/[queueId]/index.tsx",
            "description": "This file serves as the main page component for displaying the items within a specific annotation queue. It imports and re-exports the `QueueItems` component.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/annotation-queues/[queueId]/items/[itemId].tsx",
            "description": "This Next.js page displays a specific item from an annotation queue for a given project, extracting the project, queue, and item IDs from the URL.",
            "spof": true
          },
          {
            "path": "web/src/pages/project/[projectId]/annotation-queues/[queueId]/items/index.tsx",
            "description": "This Next.js page displays the items belonging to a specific annotation queue within a project. It extracts the `projectId` and `queueId` from the URL and passes them to the `AnnotationQueuesItem` component for rendering.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/components/AnnotationQueueItemPage.tsx",
            "description": "This React component displays and manages the annotation process for individual items within a specific annotation queue, allowing users to view, navigate through, and mark items as completed. It dynamically renders different processors (e.g., Trace, Session) based on the item type and handles queue progression.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/components/AnnotationQueuesItem.tsx",
            "description": "This component displays a specific item from an annotation queue, allowing users to switch between 'Focused' and 'Detailed' views, and integrates with access control and data fetching for queue and item details.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/components/AnnotationQueueItemsTable.tsx",
            "description": "This file implements a React component, `AnnotationQueueItemsTable`, which displays a paginated and interactive table of annotation queue items. It includes features for viewing item details, status, source links, and provides multi-select actions like deleting multiple items.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/components/shared/hooks/useAnnotationObjectData.ts",
            "description": "This hook fetches detailed data for an annotation queue item, dynamically retrieving trace, observation, or session data based on the item's type. It provides a unified interface for loading annotatable object data.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/components/processors/TraceAnnotationProcessor.tsx",
            "description": "This component processes and displays a single trace or observation from an annotation queue, rendering the trace/observation details alongside an annotation drawer for user interaction and scoring.",
            "spof": false
          },
          {
            "path": "web/src/features/annotation-queues/components/processors/SessionAnnotationProcessor.tsx",
            "description": "This component (`SessionAnnotationProcessor`) provides an interface for reviewing and annotating a specific session, displaying its details, a paginated list of associated traces, and an annotation drawer for scoring the session. It tracks the currently viewed trace within the session using an IntersectionObserver.",
            "spof": true
          },
          {
            "path": "web/src/features/annotation-queues/pages/AnnotationQueueItems.tsx",
            "description": "This file defines a React page component that displays items belonging to a specific annotation queue. It includes a table of annotation queue items, a side panel showing the queue's details and score configurations, and actions for processing the queue, all while handling user access permissions.",
            "spof": true
          },
          {
            "path": "web/src/features/datasets/contexts/ActiveCellContext.tsx",
            "description": "This file implements a React Context (`ActiveCellContext`) to manage the active cell within a dataset run item. It facilitates UI features like cell highlighting and side panel state for annotation purposes.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "marliessophie",
            "percent": 73
          },
          {
            "name": "Marc Klingen",
            "percent": 12
          },
          {
            "name": "Nimar",
            "percent": 7
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 61,
      "spofCount": 51
    },
    "busFactor": 1,
    "authorCount": 6
  },
  "LLM Playground": {
    "description": "An interactive environment for testing and comparing different LLM providers, models, and prompts in real-time. Facilitates rapid prototyping and debugging of LLM interactions in a multi-window interface.",
    "functions": {
      "LLM Tool & Schema Definition": {
        "files": [
          {
            "path": "web/src/components/ChatMessages/ToolCallCard.tsx",
            "description": "This file defines a React component, `ToolCallCard`, responsible for visually displaying the details of an LLM tool call, including its name, arguments, and ID, typically within a chat message interface.",
            "spof": true
          },
          {
            "path": "web/src/features/llm-tools/validation.ts",
            "description": "This file defines Zod schemas for validating data related to Large Language Model (LLM) tools, including their names, input parameters, and the data structures for creating, updating, and deleting these tools.",
            "spof": true
          },
          {
            "path": "web/src/features/llm-schemas/server",
            "description": "This directory is designated for server-side logic and components related to Large Language Model (LLM) schemas within the web application. It would typically contain API endpoints, data processing, or validation logic specific to LLM schema management on the backend.",
            "spof": false
          },
          {
            "path": "web/src/features/playground/page/components/CreateOrEditLLMToolDialog.tsx",
            "description": "This file defines a React component for a dialog that allows users to create, edit, or delete LLM (Large Language Model) tools. It includes a form for specifying the tool's name, description, and JSON Schema-based parameters.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/StructuredOutputSchemaSection.tsx",
            "description": "This file defines React components for managing and displaying structured output schemas within a playground environment, allowing users to select, create, and edit schemas.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/CreateOrEditLLMSchemaDialog.tsx",
            "description": "This file defines a React component, `CreateOrEditLLMSchemaDialog`, which provides a dialog interface for users to create, edit, or delete LLM (Large Language Model) schemas within a specific project. It includes form validation and integration with an API for managing these schemas.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/ConfigurationDropdowns.tsx",
            "description": "This React component provides responsive dropdown menus within a playground feature for configuring model tools, structured output schemas, and prompt variables/message placeholders.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/PlaygroundTools/index.tsx",
            "description": "This file provides React components (`PlaygroundToolsPopover` and `PlaygroundTools`) for managing LLM tools within a playground feature. It allows users to browse, select, add, edit, and remove tools, integrating with a global playground context and an API for tool persistence.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Thorsten Spieker",
            "percent": 68
          },
          {
            "name": "marliessophie",
            "percent": 22
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 7
          }
        ]
      },
      "Prompt & Message Composition": {
        "files": [
          {
            "path": "web/src/components/ChatMessages/index.tsx",
            "description": "This file defines the `ChatMessages` React component, which displays a list of chat messages, allows reordering them via drag-and-drop, and provides functionality to add new messages of different types (e.g., User, Assistant, System, Placeholder).",
            "spof": true
          },
          {
            "path": "web/src/components/ChatMessages/types.ts",
            "description": "This file defines the TypeScript types and interfaces for the `MessagesContext`, which manages the state and operations related to chat messages within a web application component. It includes types for chat message data and functions to manipulate them.",
            "spof": false
          },
          {
            "path": "web/src/components/ChatMessages/ChatMessageComponent.tsx",
            "description": "This file defines the `ChatMessageComponent` React component, which renders an individual chat message in a chat interface. It provides functionality for users to view, edit, reorder, delete, and change the role of chat messages, including specific handling for tool calls and placeholder messages.",
            "spof": false
          },
          {
            "path": "web/src/components/ChatMessages/utils/createEmptyMessage.ts",
            "description": "This file provides a utility function `createEmptyMessage` that generates a new chat message object with a unique ID and ensures its content property is a string, defaulting to empty if undefined.",
            "spof": false
          },
          {
            "path": "web/src/utils/chatml/playgroundConverter.ts",
            "description": "This file provides utility functions to convert ChatML formatted messages into a structured format suitable for display in a playground UI, handling various message types like tool calls, tool results, and placeholder messages.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/hooks/useNamingConflicts.ts",
            "description": "This hook detects naming conflicts between prompt variables and placeholder messages in the playground, returning information about conflicting names and utility functions to check for conflicts.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/MessagePlaceholders.tsx",
            "description": "This component renders and manages a list of message placeholders for the playground feature, displaying individual placeholder components and a message when none are defined.",
            "spof": false
          },
          {
            "path": "web/src/features/playground/page/components/PromptVariableComponent.tsx",
            "description": "This file defines a React component (`PromptVariableComponent`) responsible for displaying and managing an individual prompt variable within a playground feature, including its value, usage status, and conflict warnings.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/Variables.tsx",
            "description": "This component displays and manages a list of prompt variables within the playground feature. It renders individual `PromptVariableComponent` instances for each variable or a message indicating no variables are defined.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/Messages.tsx",
            "description": "This file defines the `Messages` React component, which serves as the main UI for a playground feature. It displays chat messages and generation output in resizable panels, and includes a `SubmitButton` that allows users to send messages and toggle response streaming.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/MessagePlaceholderComponent.tsx",
            "description": "This component provides an editable interface for defining and managing a single message placeholder within a playground feature. It allows users to input message data in JSON format, validates the input, and handles updates and deletions while checking for naming conflicts.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/GenerationOutput.tsx",
            "description": "This React component displays the output of a text generation or tool call process within a playground environment. It allows users to view, copy, and add the generated content as an assistant message.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Nimar",
            "percent": 67
          },
          {
            "name": "Hassieb Pakzad",
            "percent": 17
          },
          {
            "name": "marliessophie",
            "percent": 7
          }
        ]
      },
      "LLM Model Configuration": {
        "files": [
          {
            "path": "web/src/components/ModelParameters/LLMApiKeyComponent.tsx",
            "description": "A React component that displays the relevant LLM API key for a specific model provider within a project, enforcing access control and providing a link to manage LLM connections.",
            "spof": false
          },
          {
            "path": "web/src/components/ModelParameters/index.tsx",
            "description": "This file defines a React component (`ModelParameters`) that allows users to select and configure parameters for Large Language Models (LLMs), including the provider, model, and advanced settings like temperature, token limits, and API keys.",
            "spof": false
          },
          {
            "path": "web/src/utils/getFinalModelParams.tsx",
            "description": "This file defines a utility function `getFinalModelParams` that transforms UI-specific model parameters into their final, usable format. It filters out disabled parameters and extracts their values, excluding 'maxTemperature'.",
            "spof": false
          },
          {
            "path": "web/src/features/playground/page/hooks/useModelParams.ts",
            "description": "This React hook manages and persists language model parameters for a UI playground feature, including available providers, models, and their default settings based on the selected LLM adapter. It supports state isolation for multiple windows using local storage.",
            "spof": false
          },
          {
            "path": "web/src/features/playground/page/components/NoModelConfiguredAlert.tsx",
            "description": "This file defines a React component named `NoModelConfiguredAlert` that displays an alert message informing users that no LLM model is configured for their project in the playground. It provides a link to the LLM Connection Settings page to guide users on how to configure one.",
            "spof": true
          },
          {
            "path": "packages/shared/prisma/migrations/20240314090110_claude_model",
            "description": "This directory contains a specific Prisma database migration, identified by its timestamp '20240314090110'. It is responsible for applying schema changes related to the integration or modification of a 'claude_model' within the shared package's database.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Hassieb Pakzad",
            "percent": 46
          },
          {
            "name": "Thorsten Spieker",
            "percent": 29
          },
          {
            "name": "Michael Frhlich",
            "percent": 7
          }
        ]
      },
      "LLM Chat Completion & Connection API": {
        "files": [
          {
            "path": "web/src/__tests__/async/llm-connections-api.servertest.ts",
            "description": "This file contains server-side integration tests for the LLM connections public API endpoints. It covers scenarios like retrieving paginated connections, creating new connections, and handling authentication and pagination errors.",
            "spof": true
          },
          {
            "path": "web/src/features/llm-tools/server",
            "description": "This directory is intended to contain server-side logic and components for the 'llm-tools' feature within the Langfuse web application. It would typically house API endpoints, data processing, and business logic related to large language model functionalities.",
            "spof": false
          },
          {
            "path": "web/src/features/public-api/types/llm-connections.ts",
            "description": "This file defines Zod schemas and validation logic for managing LLM connections through public API endpoints, including requests, responses, and adapter-specific configuration validations. It also provides a utility function to transform database records into the API response format for LLM connections.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/server/validateChatCompletionBody.ts",
            "description": "This file defines the Zod schema for validating chat completion request bodies, including model parameters, messages, and optional tools or structured output schemas. It exports a function to validate incoming chat completion input against this schema.",
            "spof": false
          },
          {
            "path": "web/src/features/playground/server/chatCompletionHandler.ts",
            "description": "This file defines a Next.js API route handler for processing chat completion requests. It validates, authorizes, and orchestrates calls to an external LLM, managing streaming responses, structured output, and tool usage, while integrating with analytics and observability tools.",
            "spof": true
          },
          {
            "path": "web/src/app/api/chatCompletion",
            "description": "This directory is designated to contain the API route handlers for chat completion services within the web application. It would typically define endpoints responsible for processing user input and interacting with AI models to generate chat responses.",
            "spof": false
          },
          {
            "path": "worker/src/__tests__/llmConnections.test.ts",
            "description": "This file contains integration tests for various Large Language Model (LLM) adapters, verifying their functionality with live API calls. It tests different LLM providers like OpenAI, Anthropic, and Azure for simple completions, structured outputs, and tool calling.",
            "spof": true
          },
          {
            "path": "worker/src/features/tokenisation/async-usage.ts",
            "description": "This file manages a pool of worker threads for asynchronous token counting, distributing tokenization requests across workers and handling their lifecycle, errors, and timeouts to ensure robust and efficient operation.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Hassieb Pakzad",
            "percent": 81
          },
          {
            "name": "Max Deichmann",
            "percent": 9
          },
          {
            "name": "Steffen Schmitz",
            "percent": 5
          }
        ]
      },
      "Playground UI & State Management": {
        "files": [
          {
            "path": "web/src/pages/project/[projectId]/playground.tsx",
            "description": "This file acts as a page entry point for the playground feature within a specific project. It re-exports the main playground page component.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/index.tsx",
            "description": "This file defines the main Playground page component, enabling a multi-window environment for testing and comparing prompts with global controls and persistent state.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/types.ts",
            "description": "This file defines the TypeScript types and interfaces for the Langfuse web application's 'Playground' feature, including data structures for LLM interactions, tools, schemas, and specifically for managing and coordinating multiple instances of the playground in a multi-window setup.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/hooks/useCommandEnter.ts",
            "description": "This React hook executes a provided callback function when the Command (or Control) + Enter key combination is pressed, only if it is enabled.",
            "spof": false
          },
          {
            "path": "web/src/features/playground/page/hooks/usePersistedWindowIds.ts",
            "description": "Manages and persists a list of unique window IDs for a multi-window playground feature, allowing addition, removal, and copying of window states across page refreshes using local storage.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/hooks/useWindowCoordination.ts",
            "description": "This file provides a React hook (`useWindowCoordination`) and utility functions for coordinating actions and managing state across multiple independent 'playground' windows, enabling features like parallel execution and global stop functionality.",
            "spof": false
          },
          {
            "path": "web/src/features/playground/page/hooks/usePlaygroundWindowSize.ts",
            "description": "This file defines a custom React hook, `usePlaygroundWindowSize`, that tracks the width of a designated container using ResizeObserver. It provides responsive boolean flags based on the container's width, specifically for a 'playground window' component.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/hooks/usePlaygroundCache.ts",
            "description": "This file defines a React hook `usePlaygroundCache` that manages application-specific data in `sessionStorage`. It provides read and write access to a cache, optionally isolated by a `windowId`, ensuring data persistence for a 'playground' feature.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/ResetPlaygroundButton.tsx",
            "description": "This file defines a React component `ResetPlaygroundButton` that allows users to reset the playground's state. When clicked, it clears persisted window IDs and reloads the page.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/CollapsibleSection.tsx",
            "description": "This file defines a reusable React component named `CollapsibleSection` that provides a collapsible UI section. It includes a title, toggle functionality, optional badges/counts, an action button, and displays its children content when expanded, or a summary/empty message when collapsed.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/JumpToPlaygroundButton.tsx",
            "description": "This component provides a button that allows users to jump from a prompt or generation view to the LLM playground, pre-populating it with the selected data. It supports creating a fresh playground session or adding the data to an existing one.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/components/MultiWindowPlayground.tsx",
            "description": "This component renders and manages multiple side-by-side 'playground' windows, enabling users to compare and test different prompts or configurations. It handles the layout, individual window states, and actions like adding, removing, or copying a window for prompt comparison.",
            "spof": false
          },
          {
            "path": "web/src/features/playground/page/storage/keys.ts",
            "description": "This file defines utility functions for generating storage keys used in the Langfuse playground feature, including keys for caching, LLM model names, and providers. It supports differentiating keys based on a 'windowId' for multi-window configurations.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/storage/windowStorage.ts",
            "description": "This file provides utility functions for managing and persisting the state of a 'playground' feature's windows in the browser's session storage. It handles operations like retrieving, saving, cloning, and clearing window-specific data and IDs.",
            "spof": true
          },
          {
            "path": "web/src/features/playground/page/context/index.tsx",
            "description": "This file defines the React context and provider for the Langfuse playground feature. It manages the state and logic for chat messages, model parameters, prompt variables, tools, and handles the submission and processing of LLM requests within the playground environment.",
            "spof": false
          }
        ],
        "contributors": [
          {
            "name": "Nimar",
            "percent": 45
          },
          {
            "name": "Thorsten Spieker",
            "percent": 34
          },
          {
            "name": "Leo Weigand",
            "percent": 5
          }
        ]
      },
      "ChatML Data Normalization & Ingestion": {
        "files": [
          {
            "path": "web/src/utils/chatml/README.md",
            "description": "This file describes the ChatML Normalization System, which normalizes LLM provider data (traces, observations) into the ChatML format. It outlines its usage for display and playground functionalities, and provides instructions for adding new providers.",
            "spof": true
          },
          {
            "path": "web/src/utils/chatml/helpers.ts",
            "description": "This file re-exports a set of utility helper functions from the '@langfuse/shared' library, primarily for tasks related to ChatML processing, data manipulation (e.g., handling nulls, stringifying tool arguments and results), and metadata parsing within the web application.",
            "spof": true
          },
          {
            "path": "web/src/utils/chatml/extractTools.ts",
            "description": "This file provides a utility function to extract tool definitions from various Large Language Model (LLM) input formats, including OpenAI, LangChain, and Microsoft Agent Framework, and maps them to a consistent `PlaygroundTool` format.",
            "spof": true
          },
          {
            "path": "web/src/utils/chatml/jumptoplayground.clienttest.ts",
            "description": "This file contains client-side unit tests for the full pipeline that converts ChatML-like trace data, including tool calls and messages, into a format suitable for a 'playground' interface. It verifies the correct handling of various message and tool definition structures.",
            "spof": true
          },
          {
            "path": "web/src/utils/chatml/adapters/openai.ts",
            "description": "This file re-exports the OpenAI adapter for ChatML from a shared utility package, making it available for the web application.",
            "spof": true
          },
          {
            "path": "web/src/utils/chatml/adapters/index.ts",
            "description": "This file acts as a central re-export point for various ChatML adapters and utility functions (like `normalizeInput`, `normalizeOutput`) from the `@langfuse/shared` library. It consolidates access to adapters for different AI frameworks (e.g., OpenAI, Gemini, Langgraph) within the web application.",
            "spof": true
          },
          {
            "path": "packages/shared/src/utils/chatml/core.ts",
            "description": "This file provides core utility functions for normalizing various input and output data formats into a standardized ChatML message array structure. It includes functions for mapping, cleaning, and combining messages to ensure consistent processing across different components.",
            "spof": false
          },
          {
            "path": "packages/shared/src/utils/chatml/adapters/aisdk.ts",
            "description": "This file implements an adapter to convert messages and tool definitions from the Vercel AI SDK v5 format into a standardized ChatML format. It normalizes various AI SDK message structures, including tool calls and results, for consistent processing.",
            "spof": true
          }
        ],
        "contributors": [
          {
            "name": "Nimar",
            "percent": 98
          },
          {
            "name": "marliessophie",
            "percent": 1
          },
          {
            "name": "Michael Frhlich",
            "percent": 0
          }
        ]
      }
    },
    "stats": {
      "totalFiles": 57,
      "spofCount": 39
    },
    "busFactor": 2,
    "authorCount": 8
  }
}